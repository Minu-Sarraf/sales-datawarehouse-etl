[2022-01-24 04:16:01,365] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoice_staging scheduled__2022-01-03T00:00:00+00:00 [queued]>
[2022-01-24 04:16:01,374] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoice_staging scheduled__2022-01-03T00:00:00+00:00 [queued]>
[2022-01-24 04:16:01,375] {taskinstance.py:1238} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 04:16:01,375] {taskinstance.py:1239} INFO - Starting attempt 1 of 1
[2022-01-24 04:16:01,375] {taskinstance.py:1240} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 04:16:01,385] {taskinstance.py:1259} INFO - Executing <Task(PythonOperator): load_invoice_staging> on 2022-01-03 00:00:00+00:00
[2022-01-24 04:16:01,389] {standard_task_runner.py:52} INFO - Started process 7137 to run task
[2022-01-24 04:16:01,393] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'datawarehouse_etl', 'load_invoice_staging', 'scheduled__2022-01-03T00:00:00+00:00', '--job-id', '75', '--raw', '--subdir', 'DAGS_FOLDER/datawarehouse_***.py', '--cfg-path', '/tmp/tmpxw6b8n9t', '--error-file', '/tmp/tmp6vi1y_ee']
[2022-01-24 04:16:01,394] {standard_task_runner.py:77} INFO - Job 75: Subtask load_invoice_staging
[2022-01-24 04:16:01,440] {logging_mixin.py:109} INFO - Running <TaskInstance: datawarehouse_etl.load_invoice_staging scheduled__2022-01-03T00:00:00+00:00 [running]> on host cd9bb47288d1
[2022-01-24 04:16:01,490] {taskinstance.py:1426} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=datawarehouse_etl
AIRFLOW_CTX_TASK_ID=load_invoice_staging
AIRFLOW_CTX_EXECUTION_DATE=2022-01-03T00:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-01-03T00:00:00+00:00
[2022-01-24 04:16:01,491] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 04:16:01,491] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 04:16:01,492] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds_nodash' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds_nodash }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 04:16:01,492] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_end' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 04:16:01,492] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 04:16:01,492] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 04:16:01,492] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 04:16:01,492] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date_success' from the template is deprecated and will be removed in a future version. Please use 'prev_data_interval_start_success' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 04:16:01,492] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 04:16:01,493] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 04:16:01,493] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 04:16:01,493] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 04:16:01,493] {logging_mixin.py:109} INFO - {'conf': <***.configuration.AirflowConfigParser object at 0x7f1e4dfc6a10>, 'dag': <DAG: datawarehouse_etl>, 'dag_run': <DagRun datawarehouse_etl @ 2022-01-03 00:00:00+00:00: scheduled__2022-01-03T00:00:00+00:00, externally triggered: False>, 'data_interval_end': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'data_interval_start': DateTime(2022, 1, 3, 0, 0, 0, tzinfo=Timezone('UTC')), 'ds': '2022-01-03', 'ds_nodash': '20220103', 'execution_date': DateTime(2022, 1, 3, 0, 0, 0, tzinfo=Timezone('UTC')), 'inlets': [], 'logical_date': DateTime(2022, 1, 3, 0, 0, 0, tzinfo=Timezone('UTC')), 'macros': <module '***.macros' from '/home/***/.local/lib/python3.7/site-packages/***/macros/__init__.py'>, 'next_ds': '2022-01-04', 'next_ds_nodash': '20220104', 'next_execution_date': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'outlets': [], 'params': {}, 'prev_data_interval_start_success': None, 'prev_data_interval_end_success': None, 'prev_ds': '2022-01-02', 'prev_ds_nodash': '20220102', 'prev_execution_date': datetime.datetime(2022, 1, 2, 0, 0, tzinfo=Timezone('UTC')), 'prev_execution_date_success': None, 'prev_start_date_success': None, 'run_id': 'scheduled__2022-01-03T00:00:00+00:00', 'task': <Task(PythonOperator): load_invoice_staging>, 'task_instance': <TaskInstance: datawarehouse_etl.load_invoice_staging scheduled__2022-01-03T00:00:00+00:00 [running]>, 'task_instance_key_str': 'datawarehouse_etl__load_invoice_staging__20220103', 'test_mode': False, 'ti': <TaskInstance: datawarehouse_etl.load_invoice_staging scheduled__2022-01-03T00:00:00+00:00 [running]>, 'tomorrow_ds': '2022-01-04', 'tomorrow_ds_nodash': '20220104', 'ts': '2022-01-03T00:00:00+00:00', 'ts_nodash': '20220103T000000', 'ts_nodash_with_tz': '20220103T000000+0000', 'var': {'json': None, 'value': None}, 'conn': None, 'yesterday_ds': '2022-01-02', 'yesterday_ds_nodash': '20220102', 'key': 'value', 'ts_var': '2022-01-03T00:00:00+00:00', 'tsnodash_var': '20220103T000000', 'templates_dict': None}
[2022-01-24 04:16:01,494] {logging_mixin.py:109} INFO - ts:  2022-01-03 00:00:00+00:00
[2022-01-24 04:16:01,494] {logging_mixin.py:109} INFO - <class 'pandas._libs.tslibs.timestamps.Timestamp'>
[2022-01-24 04:16:01,494] {logging_mixin.py:109} INFO - Object created.
[2022-01-24 04:16:01,494] {logging_mixin.py:109} INFO - 2022 1 3
[2022-01-24 04:16:01,495] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-3.json
[2022-01-24 04:16:01,496] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-19.json
[2022-01-24 04:16:01,496] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-49.json
[2022-01-24 04:16:01,496] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-45.json
[2022-01-24 04:16:01,496] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-7.json
[2022-01-24 04:16:01,497] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-54.json
[2022-01-24 04:16:01,497] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-75.json
[2022-01-24 04:16:01,497] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-60.json
[2022-01-24 04:16:01,497] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-83.json
[2022-01-24 04:16:01,498] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-13.json
[2022-01-24 04:16:01,498] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-2.json
[2022-01-24 04:16:01,498] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-59.json
[2022-01-24 04:16:01,498] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-71.json
[2022-01-24 04:16:01,498] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-8.json
[2022-01-24 04:16:01,499] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-40.json
[2022-01-24 04:16:01,499] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-39.json
[2022-01-24 04:16:01,499] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-65.json
[2022-01-24 04:16:01,500] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-18.json
[2022-01-24 04:16:01,500] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-27.json
[2022-01-24 04:16:01,500] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-51.json
[2022-01-24 04:16:01,501] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-16.json
[2022-01-24 04:16:01,501] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-4.json
[2022-01-24 04:16:01,501] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-62.json
[2022-01-24 04:16:01,501] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-68.json
[2022-01-24 04:16:01,502] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-78.json
[2022-01-24 04:16:01,502] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-33.json
[2022-01-24 04:16:01,502] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-41.json
[2022-01-24 04:16:01,502] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-69.json
[2022-01-24 04:16:01,502] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-0.json
[2022-01-24 04:16:01,503] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-21.json
[2022-01-24 04:16:01,503] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-47.json
[2022-01-24 04:16:01,503] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-9.json
[2022-01-24 04:16:01,504] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-80.json
[2022-01-24 04:16:01,504] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-70.json
[2022-01-24 04:16:01,505] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-6.json
[2022-01-24 04:16:01,505] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-66.json
[2022-01-24 04:16:01,505] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-43.json
[2022-01-24 04:16:01,505] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-46.json
[2022-01-24 04:16:01,506] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-25.json
[2022-01-24 04:16:01,506] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-17.json
[2022-01-24 04:16:01,506] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-35.json
[2022-01-24 04:16:01,506] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-22.json
[2022-01-24 04:16:01,507] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-15.json
[2022-01-24 04:16:01,507] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-53.json
[2022-01-24 04:16:01,507] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-14.json
[2022-01-24 04:16:01,507] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-1.json
[2022-01-24 04:16:01,508] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-72.json
[2022-01-24 04:16:01,508] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-64.json
[2022-01-24 04:16:01,508] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-28.json
[2022-01-24 04:16:01,508] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-12.json
[2022-01-24 04:16:01,508] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-20.json
[2022-01-24 04:16:01,509] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-61.json
[2022-01-24 04:16:01,509] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-56.json
[2022-01-24 04:16:01,509] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-42.json
[2022-01-24 04:16:01,509] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-50.json
[2022-01-24 04:16:01,510] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-58.json
[2022-01-24 04:16:01,510] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-77.json
[2022-01-24 04:16:01,510] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-52.json
[2022-01-24 04:16:01,510] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-79.json
[2022-01-24 04:16:01,510] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-36.json
[2022-01-24 04:16:01,511] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-24.json
[2022-01-24 04:16:01,511] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-23.json
[2022-01-24 04:16:01,511] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-81.json
[2022-01-24 04:16:01,511] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-37.json
[2022-01-24 04:16:01,511] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-74.json
[2022-01-24 04:16:01,512] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-48.json
[2022-01-24 04:16:01,512] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-57.json
[2022-01-24 04:16:01,512] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-34.json
[2022-01-24 04:16:01,512] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-32.json
[2022-01-24 04:16:01,513] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-63.json
[2022-01-24 04:16:01,513] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-5.json
[2022-01-24 04:16:01,513] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-84.json
[2022-01-24 04:16:01,514] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-73.json
[2022-01-24 04:16:01,514] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-30.json
[2022-01-24 04:16:01,514] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-10.json
[2022-01-24 04:16:01,514] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-29.json
[2022-01-24 04:16:01,515] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-38.json
[2022-01-24 04:16:01,515] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-44.json
[2022-01-24 04:16:01,515] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-31.json
[2022-01-24 04:16:01,515] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-11.json
[2022-01-24 04:16:01,515] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-67.json
[2022-01-24 04:16:01,516] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-26.json
[2022-01-24 04:16:01,516] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-82.json
[2022-01-24 04:16:01,516] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-76.json
[2022-01-24 04:16:01,516] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-55.json
[2022-01-24 04:16:01,518] {logging_mixin.py:109} INFO - 85
[2022-01-24 04:16:01,537] {logging_mixin.py:109} INFO -      invoice_id    invoice_timestamp  customer_id  ...  qty is_discount       price
0   20220103-11  2022-01-03T19:59:51  yyymlnv2864  ...  256           0   8988.1600
1   20220103-26  2022-01-03T03:36:28  yadoags1019  ...  131           1   6461.0510
2   20220103-53  2022-01-03T15:35:24  tikvtot4348  ...  297           0   2981.8800
3    20220103-5  2022-01-03T14:07:09  mjbhujn4102  ...   41           1    275.7988
4   20220103-15  2022-01-03T09:55:41  aecqtdi3986  ...   40           1   2338.8400
..          ...                  ...          ...  ...  ...         ...         ...
80   20220103-7  2022-01-03T22:54:32  codpbua4340  ...  234           1  11880.0864
81  20220103-32  2022-01-03T14:27:34  sexnidd1428  ...  249           1   1405.0821
82  20220103-83  2022-01-03T09:31:32  yyymlnv2864  ...   55           1   1197.2510
83  20220103-78  2022-01-03T19:54:44  sexnidd1428  ...  208           0   7302.8800
84  20220103-59  2022-01-03T13:13:44  dludxgk4225  ...  209           0  18837.1700

[85 rows x 8 columns]
[2022-01-24 04:16:01,538] {taskinstance.py:1700} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1329, in _run_raw_task
    self._execute_task_with_callbacks(context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1455, in _execute_task_with_callbacks
    result = self._execute_task(context, self.task)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1511, in _execute_task
    result = execute_callable(context=context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 174, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 185, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/datawarehouse_airflow.py", line 59, in load_invoice_staging
    invoice_df.to_sql('invoice_stagging_{}_{}_{}'.format(ts.year, ts.month, ts.day), redshift_hook.get_sqlalcemy_engine(), if_exists='replace', index=False)
AttributeError: 'PostgresHook' object has no attribute 'get_sqlalcemy_engine'
[2022-01-24 04:16:01,548] {taskinstance.py:1277} INFO - Marking task as FAILED. dag_id=datawarehouse_etl, task_id=load_invoice_staging, execution_date=20220103T000000, start_date=20220124T041601, end_date=20220124T041601
[2022-01-24 04:16:01,559] {standard_task_runner.py:92} ERROR - Failed to execute job 75 for task load_invoice_staging
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/task/task_runner/standard_task_runner.py", line 85, in _start_by_fork
    args.func(args, dag=self.dag)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/cli_parser.py", line 48, in command
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/cli.py", line 92, in wrapper
    return f(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/commands/task_command.py", line 298, in task_run
    _run_task_by_selected_method(args, dag, ti)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/commands/task_command.py", line 107, in _run_task_by_selected_method
    _run_raw_task(args, ti)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/commands/task_command.py", line 184, in _run_raw_task
    error_file=args.error_file,
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/session.py", line 70, in wrapper
    return func(*args, session=session, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1329, in _run_raw_task
    self._execute_task_with_callbacks(context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1455, in _execute_task_with_callbacks
    result = self._execute_task(context, self.task)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1511, in _execute_task
    result = execute_callable(context=context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 174, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 185, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/datawarehouse_airflow.py", line 59, in load_invoice_staging
    invoice_df.to_sql('invoice_stagging_{}_{}_{}'.format(ts.year, ts.month, ts.day), redshift_hook.get_sqlalcemy_engine(), if_exists='replace', index=False)
AttributeError: 'PostgresHook' object has no attribute 'get_sqlalcemy_engine'
[2022-01-24 04:16:01,604] {local_task_job.py:154} INFO - Task exited with return code 1
[2022-01-24 04:16:01,635] {local_task_job.py:264} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-01-24 04:20:51,683] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoice_staging scheduled__2022-01-03T00:00:00+00:00 [queued]>
[2022-01-24 04:20:51,692] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoice_staging scheduled__2022-01-03T00:00:00+00:00 [queued]>
[2022-01-24 04:20:51,692] {taskinstance.py:1238} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 04:20:51,692] {taskinstance.py:1239} INFO - Starting attempt 1 of 1
[2022-01-24 04:20:51,692] {taskinstance.py:1240} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 04:20:51,703] {taskinstance.py:1259} INFO - Executing <Task(PythonOperator): load_invoice_staging> on 2022-01-03 00:00:00+00:00
[2022-01-24 04:20:51,707] {standard_task_runner.py:52} INFO - Started process 7355 to run task
[2022-01-24 04:20:51,710] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'datawarehouse_etl', 'load_invoice_staging', 'scheduled__2022-01-03T00:00:00+00:00', '--job-id', '78', '--raw', '--subdir', 'DAGS_FOLDER/datawarehouse_***.py', '--cfg-path', '/tmp/tmpdmblptnh', '--error-file', '/tmp/tmppxkzgs24']
[2022-01-24 04:20:51,711] {standard_task_runner.py:77} INFO - Job 78: Subtask load_invoice_staging
[2022-01-24 04:20:51,753] {logging_mixin.py:109} INFO - Running <TaskInstance: datawarehouse_etl.load_invoice_staging scheduled__2022-01-03T00:00:00+00:00 [running]> on host cd9bb47288d1
[2022-01-24 04:20:51,795] {taskinstance.py:1426} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=datawarehouse_etl
AIRFLOW_CTX_TASK_ID=load_invoice_staging
AIRFLOW_CTX_EXECUTION_DATE=2022-01-03T00:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-01-03T00:00:00+00:00
[2022-01-24 04:20:51,796] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 04:20:51,796] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 04:20:51,796] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds_nodash' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds_nodash }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 04:20:51,796] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_end' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 04:20:51,796] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 04:20:51,796] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 04:20:51,796] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 04:20:51,796] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date_success' from the template is deprecated and will be removed in a future version. Please use 'prev_data_interval_start_success' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 04:20:51,797] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 04:20:51,797] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 04:20:51,797] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 04:20:51,797] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 04:20:51,797] {logging_mixin.py:109} INFO - {'conf': <***.configuration.AirflowConfigParser object at 0x7f1e4dfc6a10>, 'dag': <DAG: datawarehouse_etl>, 'dag_run': <DagRun datawarehouse_etl @ 2022-01-03 00:00:00+00:00: scheduled__2022-01-03T00:00:00+00:00, externally triggered: False>, 'data_interval_end': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'data_interval_start': DateTime(2022, 1, 3, 0, 0, 0, tzinfo=Timezone('UTC')), 'ds': '2022-01-03', 'ds_nodash': '20220103', 'execution_date': DateTime(2022, 1, 3, 0, 0, 0, tzinfo=Timezone('UTC')), 'inlets': [], 'logical_date': DateTime(2022, 1, 3, 0, 0, 0, tzinfo=Timezone('UTC')), 'macros': <module '***.macros' from '/home/***/.local/lib/python3.7/site-packages/***/macros/__init__.py'>, 'next_ds': '2022-01-04', 'next_ds_nodash': '20220104', 'next_execution_date': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'outlets': [], 'params': {}, 'prev_data_interval_start_success': None, 'prev_data_interval_end_success': None, 'prev_ds': '2022-01-02', 'prev_ds_nodash': '20220102', 'prev_execution_date': datetime.datetime(2022, 1, 2, 0, 0, tzinfo=Timezone('UTC')), 'prev_execution_date_success': None, 'prev_start_date_success': None, 'run_id': 'scheduled__2022-01-03T00:00:00+00:00', 'task': <Task(PythonOperator): load_invoice_staging>, 'task_instance': <TaskInstance: datawarehouse_etl.load_invoice_staging scheduled__2022-01-03T00:00:00+00:00 [running]>, 'task_instance_key_str': 'datawarehouse_etl__load_invoice_staging__20220103', 'test_mode': False, 'ti': <TaskInstance: datawarehouse_etl.load_invoice_staging scheduled__2022-01-03T00:00:00+00:00 [running]>, 'tomorrow_ds': '2022-01-04', 'tomorrow_ds_nodash': '20220104', 'ts': '2022-01-03T00:00:00+00:00', 'ts_nodash': '20220103T000000', 'ts_nodash_with_tz': '20220103T000000+0000', 'var': {'json': None, 'value': None}, 'conn': None, 'yesterday_ds': '2022-01-02', 'yesterday_ds_nodash': '20220102', 'key': 'value', 'ts_var': '2022-01-03T00:00:00+00:00', 'tsnodash_var': '20220103T000000', 'templates_dict': None}
[2022-01-24 04:20:51,798] {logging_mixin.py:109} INFO - ts:  2022-01-03 00:00:00+00:00
[2022-01-24 04:20:51,798] {logging_mixin.py:109} INFO - <class 'pandas._libs.tslibs.timestamps.Timestamp'>
[2022-01-24 04:20:51,799] {logging_mixin.py:109} INFO - Object created.
[2022-01-24 04:20:51,799] {logging_mixin.py:109} INFO - 2022 1 3
[2022-01-24 04:20:51,799] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-3.json
[2022-01-24 04:20:51,800] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-19.json
[2022-01-24 04:20:51,800] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-49.json
[2022-01-24 04:20:51,800] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-45.json
[2022-01-24 04:20:51,800] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-7.json
[2022-01-24 04:20:51,801] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-54.json
[2022-01-24 04:20:51,801] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-75.json
[2022-01-24 04:20:51,801] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-60.json
[2022-01-24 04:20:51,801] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-83.json
[2022-01-24 04:20:51,802] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-13.json
[2022-01-24 04:20:51,802] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-2.json
[2022-01-24 04:20:51,802] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-59.json
[2022-01-24 04:20:51,802] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-71.json
[2022-01-24 04:20:51,803] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-8.json
[2022-01-24 04:20:51,803] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-40.json
[2022-01-24 04:20:51,803] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-39.json
[2022-01-24 04:20:51,803] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-65.json
[2022-01-24 04:20:51,804] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-18.json
[2022-01-24 04:20:51,804] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-27.json
[2022-01-24 04:20:51,804] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-51.json
[2022-01-24 04:20:51,804] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-16.json
[2022-01-24 04:20:51,804] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-4.json
[2022-01-24 04:20:51,805] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-62.json
[2022-01-24 04:20:51,805] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-68.json
[2022-01-24 04:20:51,805] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-78.json
[2022-01-24 04:20:51,805] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-33.json
[2022-01-24 04:20:51,806] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-41.json
[2022-01-24 04:20:51,806] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-69.json
[2022-01-24 04:20:51,806] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-0.json
[2022-01-24 04:20:51,806] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-21.json
[2022-01-24 04:20:51,806] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-47.json
[2022-01-24 04:20:51,807] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-9.json
[2022-01-24 04:20:51,807] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-80.json
[2022-01-24 04:20:51,807] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-70.json
[2022-01-24 04:20:51,807] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-6.json
[2022-01-24 04:20:51,807] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-66.json
[2022-01-24 04:20:51,808] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-43.json
[2022-01-24 04:20:51,808] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-46.json
[2022-01-24 04:20:51,808] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-25.json
[2022-01-24 04:20:51,808] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-17.json
[2022-01-24 04:20:51,808] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-35.json
[2022-01-24 04:20:51,809] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-22.json
[2022-01-24 04:20:51,809] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-15.json
[2022-01-24 04:20:51,809] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-53.json
[2022-01-24 04:20:51,809] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-14.json
[2022-01-24 04:20:51,809] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-1.json
[2022-01-24 04:20:51,810] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-72.json
[2022-01-24 04:20:51,810] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-64.json
[2022-01-24 04:20:51,810] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-28.json
[2022-01-24 04:20:51,810] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-12.json
[2022-01-24 04:20:51,810] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-20.json
[2022-01-24 04:20:51,810] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-61.json
[2022-01-24 04:20:51,811] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-56.json
[2022-01-24 04:20:51,811] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-42.json
[2022-01-24 04:20:51,811] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-50.json
[2022-01-24 04:20:51,811] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-58.json
[2022-01-24 04:20:51,812] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-77.json
[2022-01-24 04:20:51,812] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-52.json
[2022-01-24 04:20:51,812] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-79.json
[2022-01-24 04:20:51,812] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-36.json
[2022-01-24 04:20:51,812] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-24.json
[2022-01-24 04:20:51,813] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-23.json
[2022-01-24 04:20:51,813] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-81.json
[2022-01-24 04:20:51,813] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-37.json
[2022-01-24 04:20:51,813] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-74.json
[2022-01-24 04:20:51,813] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-48.json
[2022-01-24 04:20:51,814] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-57.json
[2022-01-24 04:20:51,814] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-34.json
[2022-01-24 04:20:51,814] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-32.json
[2022-01-24 04:20:51,814] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-63.json
[2022-01-24 04:20:51,814] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-5.json
[2022-01-24 04:20:51,815] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-84.json
[2022-01-24 04:20:51,815] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-73.json
[2022-01-24 04:20:51,815] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-30.json
[2022-01-24 04:20:51,815] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-10.json
[2022-01-24 04:20:51,815] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-29.json
[2022-01-24 04:20:51,815] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-38.json
[2022-01-24 04:20:51,816] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-44.json
[2022-01-24 04:20:51,816] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-31.json
[2022-01-24 04:20:51,816] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-11.json
[2022-01-24 04:20:51,816] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-67.json
[2022-01-24 04:20:51,816] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-26.json
[2022-01-24 04:20:51,817] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-82.json
[2022-01-24 04:20:51,817] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-76.json
[2022-01-24 04:20:51,817] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-55.json
[2022-01-24 04:20:51,819] {logging_mixin.py:109} INFO - 85
[2022-01-24 04:20:51,834] {logging_mixin.py:109} INFO -      invoice_id    invoice_timestamp  customer_id  ...  qty is_discount       price
0   20220103-11  2022-01-03T19:59:51  yyymlnv2864  ...  256           0   8988.1600
1   20220103-26  2022-01-03T03:36:28  yadoags1019  ...  131           1   6461.0510
2   20220103-53  2022-01-03T15:35:24  tikvtot4348  ...  297           0   2981.8800
3    20220103-5  2022-01-03T14:07:09  mjbhujn4102  ...   41           1    275.7988
4   20220103-15  2022-01-03T09:55:41  aecqtdi3986  ...   40           1   2338.8400
..          ...                  ...          ...  ...  ...         ...         ...
80   20220103-7  2022-01-03T22:54:32  codpbua4340  ...  234           1  11880.0864
81  20220103-32  2022-01-03T14:27:34  sexnidd1428  ...  249           1   1405.0821
82  20220103-83  2022-01-03T09:31:32  yyymlnv2864  ...   55           1   1197.2510
83  20220103-78  2022-01-03T19:54:44  sexnidd1428  ...  208           0   7302.8800
84  20220103-59  2022-01-03T13:13:44  dludxgk4225  ...  209           0  18837.1700

[85 rows x 8 columns]
[2022-01-24 04:20:51,835] {taskinstance.py:1700} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1329, in _run_raw_task
    self._execute_task_with_callbacks(context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1455, in _execute_task_with_callbacks
    result = self._execute_task(context, self.task)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1511, in _execute_task
    result = execute_callable(context=context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 174, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 185, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/datawarehouse_airflow.py", line 59, in load_invoice_staging
    invoice_df.to_sql('invoice_stagging_{}_{}_{}'.format(ts.year, ts.month, ts.day), redshift_hook.get_sqlalcemy_engine(), if_exists='replace', index=False)
AttributeError: 'PostgresHook' object has no attribute 'get_sqlalcemy_engine'
[2022-01-24 04:20:51,844] {taskinstance.py:1277} INFO - Marking task as FAILED. dag_id=datawarehouse_etl, task_id=load_invoice_staging, execution_date=20220103T000000, start_date=20220124T042051, end_date=20220124T042051
[2022-01-24 04:20:51,854] {standard_task_runner.py:92} ERROR - Failed to execute job 78 for task load_invoice_staging
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/task/task_runner/standard_task_runner.py", line 85, in _start_by_fork
    args.func(args, dag=self.dag)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/cli_parser.py", line 48, in command
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/cli.py", line 92, in wrapper
    return f(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/commands/task_command.py", line 298, in task_run
    _run_task_by_selected_method(args, dag, ti)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/commands/task_command.py", line 107, in _run_task_by_selected_method
    _run_raw_task(args, ti)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/commands/task_command.py", line 184, in _run_raw_task
    error_file=args.error_file,
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/session.py", line 70, in wrapper
    return func(*args, session=session, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1329, in _run_raw_task
    self._execute_task_with_callbacks(context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1455, in _execute_task_with_callbacks
    result = self._execute_task(context, self.task)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1511, in _execute_task
    result = execute_callable(context=context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 174, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 185, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/datawarehouse_airflow.py", line 59, in load_invoice_staging
    invoice_df.to_sql('invoice_stagging_{}_{}_{}'.format(ts.year, ts.month, ts.day), redshift_hook.get_sqlalcemy_engine(), if_exists='replace', index=False)
AttributeError: 'PostgresHook' object has no attribute 'get_sqlalcemy_engine'
[2022-01-24 04:20:51,882] {local_task_job.py:154} INFO - Task exited with return code 1
[2022-01-24 04:20:51,988] {local_task_job.py:264} INFO - 0 downstream tasks scheduled from follow-on schedule check
