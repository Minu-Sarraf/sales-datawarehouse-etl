[2022-01-24 02:21:06,757] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [queued]>
[2022-01-24 02:21:06,778] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [queued]>
[2022-01-24 02:21:06,778] {taskinstance.py:1238} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 02:21:06,779] {taskinstance.py:1239} INFO - Starting attempt 1 of 1
[2022-01-24 02:21:06,779] {taskinstance.py:1240} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 02:21:06,810] {taskinstance.py:1259} INFO - Executing <Task(PythonOperator): load_invoices> on 2022-01-03 00:00:00+00:00
[2022-01-24 02:21:06,819] {standard_task_runner.py:52} INFO - Started process 1838 to run task
[2022-01-24 02:21:06,823] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'datawarehouse_etl', 'load_invoices', 'scheduled__2022-01-03T00:00:00+00:00', '--job-id', '18', '--raw', '--subdir', 'DAGS_FOLDER/datawarehouse_***.py', '--cfg-path', '/tmp/tmp3gx6bp5b', '--error-file', '/tmp/tmpcapzu0ol']
[2022-01-24 02:21:06,824] {standard_task_runner.py:77} INFO - Job 18: Subtask load_invoices
[2022-01-24 02:21:06,971] {logging_mixin.py:109} INFO - Running <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [running]> on host cd9bb47288d1
[2022-01-24 02:21:07,070] {taskinstance.py:1426} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=datawarehouse_etl
AIRFLOW_CTX_TASK_ID=load_invoices
AIRFLOW_CTX_EXECUTION_DATE=2022-01-03T00:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-01-03T00:00:00+00:00
[2022-01-24 02:21:07,071] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:21:07,072] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:21:07,072] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds_nodash' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds_nodash }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:21:07,072] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_end' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:21:07,072] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:21:07,072] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:21:07,072] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:21:07,072] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date_success' from the template is deprecated and will be removed in a future version. Please use 'prev_data_interval_start_success' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:21:07,073] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:21:07,073] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:21:07,073] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:21:07,073] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:21:07,074] {logging_mixin.py:109} INFO - {'conf': <***.configuration.AirflowConfigParser object at 0x7f1e4dfc6a10>, 'dag': <DAG: datawarehouse_etl>, 'dag_run': <DagRun datawarehouse_etl @ 2022-01-03 00:00:00+00:00: scheduled__2022-01-03T00:00:00+00:00, externally triggered: False>, 'data_interval_end': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'data_interval_start': DateTime(2022, 1, 3, 0, 0, 0, tzinfo=Timezone('UTC')), 'ds': '2022-01-03', 'ds_nodash': '20220103', 'execution_date': DateTime(2022, 1, 3, 0, 0, 0, tzinfo=Timezone('UTC')), 'inlets': [], 'logical_date': DateTime(2022, 1, 3, 0, 0, 0, tzinfo=Timezone('UTC')), 'macros': <module '***.macros' from '/home/***/.local/lib/python3.7/site-packages/***/macros/__init__.py'>, 'next_ds': '2022-01-04', 'next_ds_nodash': '20220104', 'next_execution_date': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'outlets': [], 'params': {}, 'prev_data_interval_start_success': DateTime(2022, 1, 1, 0, 0, 0, tzinfo=Timezone('UTC')), 'prev_data_interval_end_success': DateTime(2022, 1, 2, 0, 0, 0, tzinfo=Timezone('UTC')), 'prev_ds': '2022-01-02', 'prev_ds_nodash': '20220102', 'prev_execution_date': datetime.datetime(2022, 1, 2, 0, 0, tzinfo=Timezone('UTC')), 'prev_execution_date_success': DateTime(2022, 1, 1, 0, 0, 0, tzinfo=Timezone('UTC')), 'prev_start_date_success': DateTime(2022, 1, 24, 2, 21, 3, 847547, tzinfo=Timezone('UTC')), 'run_id': 'scheduled__2022-01-03T00:00:00+00:00', 'task': <Task(PythonOperator): load_invoices>, 'task_instance': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [running]>, 'task_instance_key_str': 'datawarehouse_etl__load_invoices__20220103', 'test_mode': False, 'ti': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [running]>, 'tomorrow_ds': '2022-01-04', 'tomorrow_ds_nodash': '20220104', 'ts': '2022-01-03T00:00:00+00:00', 'ts_nodash': '20220103T000000', 'ts_nodash_with_tz': '20220103T000000+0000', 'var': {'json': None, 'value': None}, 'conn': None, 'yesterday_ds': '2022-01-02', 'yesterday_ds_nodash': '20220102', 'key': 'value', 'ts_var': '2022-01-03T00:00:00+00:00', 'tsnodash_var': '20220103T000000', 'templates_dict': None}
[2022-01-24 02:21:07,074] {logging_mixin.py:109} INFO - 2022-01-03T00:00:00+00:00
[2022-01-24 02:21:07,074] {logging_mixin.py:109} INFO - Object created.
[2022-01-24 02:21:07,074] {python.py:175} INFO - Done. Returned value was: None
[2022-01-24 02:21:07,094] {taskinstance.py:1277} INFO - Marking task as SUCCESS. dag_id=datawarehouse_etl, task_id=load_invoices, execution_date=20220103T000000, start_date=20220124T022106, end_date=20220124T022107
[2022-01-24 02:21:07,164] {local_task_job.py:154} INFO - Task exited with return code 0
[2022-01-24 02:21:07,237] {local_task_job.py:264} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2022-01-24 02:24:53,932] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [queued]>
[2022-01-24 02:24:53,942] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [queued]>
[2022-01-24 02:24:53,942] {taskinstance.py:1238} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 02:24:53,942] {taskinstance.py:1239} INFO - Starting attempt 1 of 1
[2022-01-24 02:24:53,942] {taskinstance.py:1240} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 02:24:53,954] {taskinstance.py:1259} INFO - Executing <Task(PythonOperator): load_invoices> on 2022-01-03 00:00:00+00:00
[2022-01-24 02:24:53,960] {standard_task_runner.py:52} INFO - Started process 2018 to run task
[2022-01-24 02:24:53,964] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'datawarehouse_etl', 'load_invoices', 'scheduled__2022-01-03T00:00:00+00:00', '--job-id', '23', '--raw', '--subdir', 'DAGS_FOLDER/datawarehouse_***.py', '--cfg-path', '/tmp/tmpv6fqvfbz', '--error-file', '/tmp/tmpzoz79un9']
[2022-01-24 02:24:53,966] {standard_task_runner.py:77} INFO - Job 23: Subtask load_invoices
[2022-01-24 02:24:54,049] {logging_mixin.py:109} INFO - Running <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [running]> on host cd9bb47288d1
[2022-01-24 02:24:54,117] {taskinstance.py:1426} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=datawarehouse_etl
AIRFLOW_CTX_TASK_ID=load_invoices
AIRFLOW_CTX_EXECUTION_DATE=2022-01-03T00:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-01-03T00:00:00+00:00
[2022-01-24 02:24:54,118] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:24:54,119] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:24:54,119] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds_nodash' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds_nodash }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:24:54,119] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_end' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:24:54,119] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:24:54,119] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:24:54,119] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:24:54,119] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date_success' from the template is deprecated and will be removed in a future version. Please use 'prev_data_interval_start_success' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:24:54,119] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:24:54,119] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:24:54,120] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:24:54,120] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:24:54,120] {logging_mixin.py:109} INFO - {'conf': <***.configuration.AirflowConfigParser object at 0x7f1e4dfc6a10>, 'dag': <DAG: datawarehouse_etl>, 'dag_run': <DagRun datawarehouse_etl @ 2022-01-03 00:00:00+00:00: scheduled__2022-01-03T00:00:00+00:00, externally triggered: False>, 'data_interval_end': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'data_interval_start': DateTime(2022, 1, 3, 0, 0, 0, tzinfo=Timezone('UTC')), 'ds': '2022-01-03', 'ds_nodash': '20220103', 'execution_date': DateTime(2022, 1, 3, 0, 0, 0, tzinfo=Timezone('UTC')), 'inlets': [], 'logical_date': DateTime(2022, 1, 3, 0, 0, 0, tzinfo=Timezone('UTC')), 'macros': <module '***.macros' from '/home/***/.local/lib/python3.7/site-packages/***/macros/__init__.py'>, 'next_ds': '2022-01-04', 'next_ds_nodash': '20220104', 'next_execution_date': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'outlets': [], 'params': {}, 'prev_data_interval_start_success': DateTime(2022, 1, 1, 0, 0, 0, tzinfo=Timezone('UTC')), 'prev_data_interval_end_success': DateTime(2022, 1, 2, 0, 0, 0, tzinfo=Timezone('UTC')), 'prev_ds': '2022-01-02', 'prev_ds_nodash': '20220102', 'prev_execution_date': datetime.datetime(2022, 1, 2, 0, 0, tzinfo=Timezone('UTC')), 'prev_execution_date_success': DateTime(2022, 1, 1, 0, 0, 0, tzinfo=Timezone('UTC')), 'prev_start_date_success': DateTime(2022, 1, 24, 2, 24, 51, 640871, tzinfo=Timezone('UTC')), 'run_id': 'scheduled__2022-01-03T00:00:00+00:00', 'task': <Task(PythonOperator): load_invoices>, 'task_instance': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [running]>, 'task_instance_key_str': 'datawarehouse_etl__load_invoices__20220103', 'test_mode': False, 'ti': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [running]>, 'tomorrow_ds': '2022-01-04', 'tomorrow_ds_nodash': '20220104', 'ts': '2022-01-03T00:00:00+00:00', 'ts_nodash': '20220103T000000', 'ts_nodash_with_tz': '20220103T000000+0000', 'var': {'json': None, 'value': None}, 'conn': None, 'yesterday_ds': '2022-01-02', 'yesterday_ds_nodash': '20220102', 'key': 'value', 'ts_var': '2022-01-03T00:00:00+00:00', 'tsnodash_var': '20220103T000000', 'templates_dict': None}
[2022-01-24 02:24:54,120] {logging_mixin.py:109} INFO - 2022-01-03T00:00:00+00:00
[2022-01-24 02:24:54,121] {logging_mixin.py:109} INFO - 2022-01-03
[2022-01-24 02:24:54,121] {logging_mixin.py:109} INFO - Object created.
[2022-01-24 02:24:54,121] {python.py:175} INFO - Done. Returned value was: None
[2022-01-24 02:24:54,135] {taskinstance.py:1277} INFO - Marking task as SUCCESS. dag_id=datawarehouse_etl, task_id=load_invoices, execution_date=20220103T000000, start_date=20220124T022453, end_date=20220124T022454
[2022-01-24 02:24:54,176] {local_task_job.py:154} INFO - Task exited with return code 0
[2022-01-24 02:24:54,219] {local_task_job.py:264} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2022-01-24 02:30:03,576] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [queued]>
[2022-01-24 02:30:03,588] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [queued]>
[2022-01-24 02:30:03,588] {taskinstance.py:1238} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 02:30:03,588] {taskinstance.py:1239} INFO - Starting attempt 1 of 1
[2022-01-24 02:30:03,588] {taskinstance.py:1240} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 02:30:03,603] {taskinstance.py:1259} INFO - Executing <Task(PythonOperator): load_invoices> on 2022-01-03 00:00:00+00:00
[2022-01-24 02:30:03,608] {standard_task_runner.py:52} INFO - Started process 2265 to run task
[2022-01-24 02:30:03,611] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'datawarehouse_etl', 'load_invoices', 'scheduled__2022-01-03T00:00:00+00:00', '--job-id', '28', '--raw', '--subdir', 'DAGS_FOLDER/datawarehouse_***.py', '--cfg-path', '/tmp/tmp2beesu_m', '--error-file', '/tmp/tmpblfa81o4']
[2022-01-24 02:30:03,612] {standard_task_runner.py:77} INFO - Job 28: Subtask load_invoices
[2022-01-24 02:30:03,666] {logging_mixin.py:109} INFO - Running <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [running]> on host cd9bb47288d1
[2022-01-24 02:30:03,731] {taskinstance.py:1426} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=datawarehouse_etl
AIRFLOW_CTX_TASK_ID=load_invoices
AIRFLOW_CTX_EXECUTION_DATE=2022-01-03T00:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-01-03T00:00:00+00:00
[2022-01-24 02:30:03,733] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:30:03,733] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:30:03,733] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds_nodash' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds_nodash }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:30:03,734] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_end' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:30:03,734] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:30:03,734] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:30:03,734] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:30:03,734] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date_success' from the template is deprecated and will be removed in a future version. Please use 'prev_data_interval_start_success' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:30:03,734] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:30:03,734] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:30:03,735] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:30:03,735] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:30:03,735] {logging_mixin.py:109} INFO - {'conf': <***.configuration.AirflowConfigParser object at 0x7f1e4dfc6a10>, 'dag': <DAG: datawarehouse_etl>, 'dag_run': <DagRun datawarehouse_etl @ 2022-01-03 00:00:00+00:00: scheduled__2022-01-03T00:00:00+00:00, externally triggered: False>, 'data_interval_end': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'data_interval_start': DateTime(2022, 1, 3, 0, 0, 0, tzinfo=Timezone('UTC')), 'ds': '2022-01-03', 'ds_nodash': '20220103', 'execution_date': DateTime(2022, 1, 3, 0, 0, 0, tzinfo=Timezone('UTC')), 'inlets': [], 'logical_date': DateTime(2022, 1, 3, 0, 0, 0, tzinfo=Timezone('UTC')), 'macros': <module '***.macros' from '/home/***/.local/lib/python3.7/site-packages/***/macros/__init__.py'>, 'next_ds': '2022-01-04', 'next_ds_nodash': '20220104', 'next_execution_date': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'outlets': [], 'params': {}, 'prev_data_interval_start_success': DateTime(2022, 1, 1, 0, 0, 0, tzinfo=Timezone('UTC')), 'prev_data_interval_end_success': DateTime(2022, 1, 2, 0, 0, 0, tzinfo=Timezone('UTC')), 'prev_ds': '2022-01-02', 'prev_ds_nodash': '20220102', 'prev_execution_date': datetime.datetime(2022, 1, 2, 0, 0, tzinfo=Timezone('UTC')), 'prev_execution_date_success': DateTime(2022, 1, 1, 0, 0, 0, tzinfo=Timezone('UTC')), 'prev_start_date_success': DateTime(2022, 1, 24, 2, 30, 1, 333762, tzinfo=Timezone('UTC')), 'run_id': 'scheduled__2022-01-03T00:00:00+00:00', 'task': <Task(PythonOperator): load_invoices>, 'task_instance': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [running]>, 'task_instance_key_str': 'datawarehouse_etl__load_invoices__20220103', 'test_mode': False, 'ti': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [running]>, 'tomorrow_ds': '2022-01-04', 'tomorrow_ds_nodash': '20220104', 'ts': '2022-01-03T00:00:00+00:00', 'ts_nodash': '20220103T000000', 'ts_nodash_with_tz': '20220103T000000+0000', 'var': {'json': None, 'value': None}, 'conn': None, 'yesterday_ds': '2022-01-02', 'yesterday_ds_nodash': '20220102', 'key': 'value', 'ts_var': '2022-01-03T00:00:00+00:00', 'tsnodash_var': '20220103T000000', 'templates_dict': None}
[2022-01-24 02:30:03,735] {logging_mixin.py:109} INFO - 2022-01-03T00:00:00+00:00
[2022-01-24 02:30:03,737] {logging_mixin.py:109} INFO - 2022-01-03
[2022-01-24 02:30:03,737] {logging_mixin.py:109} INFO - Object created.
[2022-01-24 02:30:03,737] {python.py:175} INFO - Done. Returned value was: None
[2022-01-24 02:30:03,749] {taskinstance.py:1277} INFO - Marking task as SUCCESS. dag_id=datawarehouse_etl, task_id=load_invoices, execution_date=20220103T000000, start_date=20220124T023003, end_date=20220124T023003
[2022-01-24 02:30:03,783] {local_task_job.py:154} INFO - Task exited with return code 0
[2022-01-24 02:30:03,820] {local_task_job.py:264} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2022-01-24 02:31:43,924] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [queued]>
[2022-01-24 02:31:43,934] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [queued]>
[2022-01-24 02:31:43,935] {taskinstance.py:1238} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 02:31:43,935] {taskinstance.py:1239} INFO - Starting attempt 1 of 1
[2022-01-24 02:31:43,935] {taskinstance.py:1240} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 02:31:43,948] {taskinstance.py:1259} INFO - Executing <Task(PythonOperator): load_invoices> on 2022-01-03 00:00:00+00:00
[2022-01-24 02:31:43,953] {standard_task_runner.py:52} INFO - Started process 2353 to run task
[2022-01-24 02:31:43,956] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'datawarehouse_etl', 'load_invoices', 'scheduled__2022-01-03T00:00:00+00:00', '--job-id', '33', '--raw', '--subdir', 'DAGS_FOLDER/datawarehouse_***.py', '--cfg-path', '/tmp/tmpdhk0l332', '--error-file', '/tmp/tmppg1xh0r3']
[2022-01-24 02:31:43,957] {standard_task_runner.py:77} INFO - Job 33: Subtask load_invoices
[2022-01-24 02:31:44,026] {logging_mixin.py:109} INFO - Running <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [running]> on host cd9bb47288d1
[2022-01-24 02:31:44,085] {taskinstance.py:1426} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=datawarehouse_etl
AIRFLOW_CTX_TASK_ID=load_invoices
AIRFLOW_CTX_EXECUTION_DATE=2022-01-03T00:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-01-03T00:00:00+00:00
[2022-01-24 02:31:44,086] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:31:44,087] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:31:44,087] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds_nodash' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds_nodash }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:31:44,087] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_end' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:31:44,087] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:31:44,087] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:31:44,087] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:31:44,088] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date_success' from the template is deprecated and will be removed in a future version. Please use 'prev_data_interval_start_success' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:31:44,088] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:31:44,088] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:31:44,088] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:31:44,088] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:31:44,089] {logging_mixin.py:109} INFO - {'conf': <***.configuration.AirflowConfigParser object at 0x7f1e4dfc6a10>, 'dag': <DAG: datawarehouse_etl>, 'dag_run': <DagRun datawarehouse_etl @ 2022-01-03 00:00:00+00:00: scheduled__2022-01-03T00:00:00+00:00, externally triggered: False>, 'data_interval_end': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'data_interval_start': DateTime(2022, 1, 3, 0, 0, 0, tzinfo=Timezone('UTC')), 'ds': '2022-01-03', 'ds_nodash': '20220103', 'execution_date': DateTime(2022, 1, 3, 0, 0, 0, tzinfo=Timezone('UTC')), 'inlets': [], 'logical_date': DateTime(2022, 1, 3, 0, 0, 0, tzinfo=Timezone('UTC')), 'macros': <module '***.macros' from '/home/***/.local/lib/python3.7/site-packages/***/macros/__init__.py'>, 'next_ds': '2022-01-04', 'next_ds_nodash': '20220104', 'next_execution_date': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'outlets': [], 'params': {}, 'prev_data_interval_start_success': None, 'prev_data_interval_end_success': None, 'prev_ds': '2022-01-02', 'prev_ds_nodash': '20220102', 'prev_execution_date': datetime.datetime(2022, 1, 2, 0, 0, tzinfo=Timezone('UTC')), 'prev_execution_date_success': None, 'prev_start_date_success': None, 'run_id': 'scheduled__2022-01-03T00:00:00+00:00', 'task': <Task(PythonOperator): load_invoices>, 'task_instance': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [running]>, 'task_instance_key_str': 'datawarehouse_etl__load_invoices__20220103', 'test_mode': False, 'ti': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [running]>, 'tomorrow_ds': '2022-01-04', 'tomorrow_ds_nodash': '20220104', 'ts': '2022-01-03T00:00:00+00:00', 'ts_nodash': '20220103T000000', 'ts_nodash_with_tz': '20220103T000000+0000', 'var': {'json': None, 'value': None}, 'conn': None, 'yesterday_ds': '2022-01-02', 'yesterday_ds_nodash': '20220102', 'key': 'value', 'ts_var': '2022-01-03T00:00:00+00:00', 'tsnodash_var': '20220103T000000', 'templates_dict': None}
[2022-01-24 02:31:44,089] {logging_mixin.py:109} INFO - 2022-01-03T00:00:00+00:00
[2022-01-24 02:31:44,089] {taskinstance.py:1700} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1329, in _run_raw_task
    self._execute_task_with_callbacks(context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1455, in _execute_task_with_callbacks
    result = self._execute_task(context, self.task)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1511, in _execute_task
    result = execute_callable(context=context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 174, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 185, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/datawarehouse_airflow.py", line 45, in load_invoices
    print(ts.year())
AttributeError: 'str' object has no attribute 'year'
[2022-01-24 02:31:44,103] {taskinstance.py:1277} INFO - Marking task as FAILED. dag_id=datawarehouse_etl, task_id=load_invoices, execution_date=20220103T000000, start_date=20220124T023143, end_date=20220124T023144
[2022-01-24 02:31:44,118] {standard_task_runner.py:92} ERROR - Failed to execute job 33 for task load_invoices
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/task/task_runner/standard_task_runner.py", line 85, in _start_by_fork
    args.func(args, dag=self.dag)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/cli_parser.py", line 48, in command
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/cli.py", line 92, in wrapper
    return f(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/commands/task_command.py", line 298, in task_run
    _run_task_by_selected_method(args, dag, ti)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/commands/task_command.py", line 107, in _run_task_by_selected_method
    _run_raw_task(args, ti)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/commands/task_command.py", line 184, in _run_raw_task
    error_file=args.error_file,
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/session.py", line 70, in wrapper
    return func(*args, session=session, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1329, in _run_raw_task
    self._execute_task_with_callbacks(context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1455, in _execute_task_with_callbacks
    result = self._execute_task(context, self.task)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1511, in _execute_task
    result = execute_callable(context=context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 174, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 185, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/datawarehouse_airflow.py", line 45, in load_invoices
    print(ts.year())
AttributeError: 'str' object has no attribute 'year'
[2022-01-24 02:31:44,128] {local_task_job.py:154} INFO - Task exited with return code 1
[2022-01-24 02:31:44,167] {local_task_job.py:264} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-01-24 02:33:05,317] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [queued]>
[2022-01-24 02:33:05,329] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [queued]>
[2022-01-24 02:33:05,329] {taskinstance.py:1238} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 02:33:05,329] {taskinstance.py:1239} INFO - Starting attempt 1 of 1
[2022-01-24 02:33:05,329] {taskinstance.py:1240} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 02:33:05,343] {taskinstance.py:1259} INFO - Executing <Task(PythonOperator): load_invoices> on 2022-01-03 00:00:00+00:00
[2022-01-24 02:33:05,349] {standard_task_runner.py:52} INFO - Started process 2429 to run task
[2022-01-24 02:33:05,352] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'datawarehouse_etl', 'load_invoices', 'scheduled__2022-01-03T00:00:00+00:00', '--job-id', '38', '--raw', '--subdir', 'DAGS_FOLDER/datawarehouse_***.py', '--cfg-path', '/tmp/tmpkin8h_pg', '--error-file', '/tmp/tmpc1uydfw0']
[2022-01-24 02:33:05,354] {standard_task_runner.py:77} INFO - Job 38: Subtask load_invoices
[2022-01-24 02:33:05,403] {logging_mixin.py:109} INFO - Running <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [running]> on host cd9bb47288d1
[2022-01-24 02:33:05,457] {taskinstance.py:1426} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=datawarehouse_etl
AIRFLOW_CTX_TASK_ID=load_invoices
AIRFLOW_CTX_EXECUTION_DATE=2022-01-03T00:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-01-03T00:00:00+00:00
[2022-01-24 02:33:05,458] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:33:05,459] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:33:05,459] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds_nodash' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds_nodash }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:33:05,459] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_end' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:33:05,459] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:33:05,459] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:33:05,460] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:33:05,460] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date_success' from the template is deprecated and will be removed in a future version. Please use 'prev_data_interval_start_success' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:33:05,460] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:33:05,460] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:33:05,460] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:33:05,460] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:33:05,461] {logging_mixin.py:109} INFO - {'conf': <***.configuration.AirflowConfigParser object at 0x7f1e4dfc6a10>, 'dag': <DAG: datawarehouse_etl>, 'dag_run': <DagRun datawarehouse_etl @ 2022-01-03 00:00:00+00:00: scheduled__2022-01-03T00:00:00+00:00, externally triggered: False>, 'data_interval_end': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'data_interval_start': DateTime(2022, 1, 3, 0, 0, 0, tzinfo=Timezone('UTC')), 'ds': '2022-01-03', 'ds_nodash': '20220103', 'execution_date': DateTime(2022, 1, 3, 0, 0, 0, tzinfo=Timezone('UTC')), 'inlets': [], 'logical_date': DateTime(2022, 1, 3, 0, 0, 0, tzinfo=Timezone('UTC')), 'macros': <module '***.macros' from '/home/***/.local/lib/python3.7/site-packages/***/macros/__init__.py'>, 'next_ds': '2022-01-04', 'next_ds_nodash': '20220104', 'next_execution_date': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'outlets': [], 'params': {}, 'prev_data_interval_start_success': None, 'prev_data_interval_end_success': None, 'prev_ds': '2022-01-02', 'prev_ds_nodash': '20220102', 'prev_execution_date': datetime.datetime(2022, 1, 2, 0, 0, tzinfo=Timezone('UTC')), 'prev_execution_date_success': None, 'prev_start_date_success': None, 'run_id': 'scheduled__2022-01-03T00:00:00+00:00', 'task': <Task(PythonOperator): load_invoices>, 'task_instance': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [running]>, 'task_instance_key_str': 'datawarehouse_etl__load_invoices__20220103', 'test_mode': False, 'ti': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [running]>, 'tomorrow_ds': '2022-01-04', 'tomorrow_ds_nodash': '20220104', 'ts': '2022-01-03T00:00:00+00:00', 'ts_nodash': '20220103T000000', 'ts_nodash_with_tz': '20220103T000000+0000', 'var': {'json': None, 'value': None}, 'conn': None, 'yesterday_ds': '2022-01-02', 'yesterday_ds_nodash': '20220102', 'key': 'value', 'ts_var': '2022-01-03T00:00:00+00:00', 'tsnodash_var': '20220103T000000', 'templates_dict': None}
[2022-01-24 02:33:05,465] {logging_mixin.py:109} INFO - 2022-01-03 00:00:00+00:00
[2022-01-24 02:33:05,465] {taskinstance.py:1700} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1329, in _run_raw_task
    self._execute_task_with_callbacks(context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1455, in _execute_task_with_callbacks
    result = self._execute_task(context, self.task)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1511, in _execute_task
    result = execute_callable(context=context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 174, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 185, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/datawarehouse_airflow.py", line 45, in load_invoices
    print(ts.year())
TypeError: 'int' object is not callable
[2022-01-24 02:33:05,486] {taskinstance.py:1277} INFO - Marking task as FAILED. dag_id=datawarehouse_etl, task_id=load_invoices, execution_date=20220103T000000, start_date=20220124T023305, end_date=20220124T023305
[2022-01-24 02:33:05,505] {standard_task_runner.py:92} ERROR - Failed to execute job 38 for task load_invoices
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/task/task_runner/standard_task_runner.py", line 85, in _start_by_fork
    args.func(args, dag=self.dag)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/cli_parser.py", line 48, in command
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/cli.py", line 92, in wrapper
    return f(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/commands/task_command.py", line 298, in task_run
    _run_task_by_selected_method(args, dag, ti)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/commands/task_command.py", line 107, in _run_task_by_selected_method
    _run_raw_task(args, ti)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/commands/task_command.py", line 184, in _run_raw_task
    error_file=args.error_file,
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/session.py", line 70, in wrapper
    return func(*args, session=session, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1329, in _run_raw_task
    self._execute_task_with_callbacks(context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1455, in _execute_task_with_callbacks
    result = self._execute_task(context, self.task)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1511, in _execute_task
    result = execute_callable(context=context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 174, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 185, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/datawarehouse_airflow.py", line 45, in load_invoices
    print(ts.year())
TypeError: 'int' object is not callable
[2022-01-24 02:33:05,564] {local_task_job.py:154} INFO - Task exited with return code 1
[2022-01-24 02:33:05,617] {local_task_job.py:264} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-01-24 02:34:34,946] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [queued]>
[2022-01-24 02:34:34,965] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [queued]>
[2022-01-24 02:34:34,966] {taskinstance.py:1238} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 02:34:34,966] {taskinstance.py:1239} INFO - Starting attempt 1 of 1
[2022-01-24 02:34:34,966] {taskinstance.py:1240} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 02:34:34,982] {taskinstance.py:1259} INFO - Executing <Task(PythonOperator): load_invoices> on 2022-01-03 00:00:00+00:00
[2022-01-24 02:34:34,988] {standard_task_runner.py:52} INFO - Started process 2513 to run task
[2022-01-24 02:34:34,992] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'datawarehouse_etl', 'load_invoices', 'scheduled__2022-01-03T00:00:00+00:00', '--job-id', '43', '--raw', '--subdir', 'DAGS_FOLDER/datawarehouse_***.py', '--cfg-path', '/tmp/tmpcnjnoyol', '--error-file', '/tmp/tmploik8e9q']
[2022-01-24 02:34:34,993] {standard_task_runner.py:77} INFO - Job 43: Subtask load_invoices
[2022-01-24 02:34:35,054] {logging_mixin.py:109} INFO - Running <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [running]> on host cd9bb47288d1
[2022-01-24 02:34:35,105] {taskinstance.py:1426} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=datawarehouse_etl
AIRFLOW_CTX_TASK_ID=load_invoices
AIRFLOW_CTX_EXECUTION_DATE=2022-01-03T00:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-01-03T00:00:00+00:00
[2022-01-24 02:34:35,107] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:34:35,107] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:34:35,107] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds_nodash' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds_nodash }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:34:35,108] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_end' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:34:35,108] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:34:35,108] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:34:35,108] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:34:35,108] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date_success' from the template is deprecated and will be removed in a future version. Please use 'prev_data_interval_start_success' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:34:35,108] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:34:35,108] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:34:35,109] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:34:35,109] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:34:35,109] {logging_mixin.py:109} INFO - {'conf': <***.configuration.AirflowConfigParser object at 0x7f1e4dfc6a10>, 'dag': <DAG: datawarehouse_etl>, 'dag_run': <DagRun datawarehouse_etl @ 2022-01-03 00:00:00+00:00: scheduled__2022-01-03T00:00:00+00:00, externally triggered: False>, 'data_interval_end': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'data_interval_start': DateTime(2022, 1, 3, 0, 0, 0, tzinfo=Timezone('UTC')), 'ds': '2022-01-03', 'ds_nodash': '20220103', 'execution_date': DateTime(2022, 1, 3, 0, 0, 0, tzinfo=Timezone('UTC')), 'inlets': [], 'logical_date': DateTime(2022, 1, 3, 0, 0, 0, tzinfo=Timezone('UTC')), 'macros': <module '***.macros' from '/home/***/.local/lib/python3.7/site-packages/***/macros/__init__.py'>, 'next_ds': '2022-01-04', 'next_ds_nodash': '20220104', 'next_execution_date': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'outlets': [], 'params': {}, 'prev_data_interval_start_success': None, 'prev_data_interval_end_success': None, 'prev_ds': '2022-01-02', 'prev_ds_nodash': '20220102', 'prev_execution_date': datetime.datetime(2022, 1, 2, 0, 0, tzinfo=Timezone('UTC')), 'prev_execution_date_success': None, 'prev_start_date_success': None, 'run_id': 'scheduled__2022-01-03T00:00:00+00:00', 'task': <Task(PythonOperator): load_invoices>, 'task_instance': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [running]>, 'task_instance_key_str': 'datawarehouse_etl__load_invoices__20220103', 'test_mode': False, 'ti': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [running]>, 'tomorrow_ds': '2022-01-04', 'tomorrow_ds_nodash': '20220104', 'ts': '2022-01-03T00:00:00+00:00', 'ts_nodash': '20220103T000000', 'ts_nodash_with_tz': '20220103T000000+0000', 'var': {'json': None, 'value': None}, 'conn': None, 'yesterday_ds': '2022-01-02', 'yesterday_ds_nodash': '20220102', 'key': 'value', 'ts_var': '2022-01-03T00:00:00+00:00', 'tsnodash_var': '20220103T000000', 'templates_dict': None}
[2022-01-24 02:34:35,111] {logging_mixin.py:109} INFO - ts:  2022-01-03 00:00:00+00:00
[2022-01-24 02:34:35,111] {taskinstance.py:1700} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1329, in _run_raw_task
    self._execute_task_with_callbacks(context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1455, in _execute_task_with_callbacks
    result = self._execute_task(context, self.task)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1511, in _execute_task
    result = execute_callable(context=context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 174, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 185, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/datawarehouse_airflow.py", line 45, in load_invoices
    print(ts.year())
TypeError: 'int' object is not callable
[2022-01-24 02:34:35,127] {taskinstance.py:1277} INFO - Marking task as FAILED. dag_id=datawarehouse_etl, task_id=load_invoices, execution_date=20220103T000000, start_date=20220124T023434, end_date=20220124T023435
[2022-01-24 02:34:35,140] {standard_task_runner.py:92} ERROR - Failed to execute job 43 for task load_invoices
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/task/task_runner/standard_task_runner.py", line 85, in _start_by_fork
    args.func(args, dag=self.dag)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/cli_parser.py", line 48, in command
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/cli.py", line 92, in wrapper
    return f(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/commands/task_command.py", line 298, in task_run
    _run_task_by_selected_method(args, dag, ti)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/commands/task_command.py", line 107, in _run_task_by_selected_method
    _run_raw_task(args, ti)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/commands/task_command.py", line 184, in _run_raw_task
    error_file=args.error_file,
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/session.py", line 70, in wrapper
    return func(*args, session=session, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1329, in _run_raw_task
    self._execute_task_with_callbacks(context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1455, in _execute_task_with_callbacks
    result = self._execute_task(context, self.task)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1511, in _execute_task
    result = execute_callable(context=context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 174, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 185, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/datawarehouse_airflow.py", line 45, in load_invoices
    print(ts.year())
TypeError: 'int' object is not callable
[2022-01-24 02:34:35,163] {local_task_job.py:154} INFO - Task exited with return code 1
[2022-01-24 02:34:35,209] {local_task_job.py:264} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-01-24 02:39:35,855] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [queued]>
[2022-01-24 02:39:35,870] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [queued]>
[2022-01-24 02:39:35,870] {taskinstance.py:1238} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 02:39:35,870] {taskinstance.py:1239} INFO - Starting attempt 1 of 1
[2022-01-24 02:39:35,870] {taskinstance.py:1240} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 02:39:35,889] {taskinstance.py:1259} INFO - Executing <Task(PythonOperator): load_invoices> on 2022-01-03 00:00:00+00:00
[2022-01-24 02:39:35,894] {standard_task_runner.py:52} INFO - Started process 2762 to run task
[2022-01-24 02:39:35,898] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'datawarehouse_etl', 'load_invoices', 'scheduled__2022-01-03T00:00:00+00:00', '--job-id', '53', '--raw', '--subdir', 'DAGS_FOLDER/datawarehouse_***.py', '--cfg-path', '/tmp/tmpt7eyz0mf', '--error-file', '/tmp/tmp1423rje6']
[2022-01-24 02:39:35,898] {standard_task_runner.py:77} INFO - Job 53: Subtask load_invoices
[2022-01-24 02:39:35,966] {logging_mixin.py:109} INFO - Running <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [running]> on host cd9bb47288d1
[2022-01-24 02:39:36,032] {taskinstance.py:1426} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=datawarehouse_etl
AIRFLOW_CTX_TASK_ID=load_invoices
AIRFLOW_CTX_EXECUTION_DATE=2022-01-03T00:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-01-03T00:00:00+00:00
[2022-01-24 02:39:36,034] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:39:36,034] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:39:36,034] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds_nodash' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds_nodash }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:39:36,034] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_end' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:39:36,034] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:39:36,035] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:39:36,035] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:39:36,035] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date_success' from the template is deprecated and will be removed in a future version. Please use 'prev_data_interval_start_success' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:39:36,035] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:39:36,035] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:39:36,035] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:39:36,035] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:39:36,036] {logging_mixin.py:109} INFO - {'conf': <***.configuration.AirflowConfigParser object at 0x7f1e4dfc6a10>, 'dag': <DAG: datawarehouse_etl>, 'dag_run': <DagRun datawarehouse_etl @ 2022-01-03 00:00:00+00:00: scheduled__2022-01-03T00:00:00+00:00, externally triggered: False>, 'data_interval_end': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'data_interval_start': DateTime(2022, 1, 3, 0, 0, 0, tzinfo=Timezone('UTC')), 'ds': '2022-01-03', 'ds_nodash': '20220103', 'execution_date': DateTime(2022, 1, 3, 0, 0, 0, tzinfo=Timezone('UTC')), 'inlets': [], 'logical_date': DateTime(2022, 1, 3, 0, 0, 0, tzinfo=Timezone('UTC')), 'macros': <module '***.macros' from '/home/***/.local/lib/python3.7/site-packages/***/macros/__init__.py'>, 'next_ds': '2022-01-04', 'next_ds_nodash': '20220104', 'next_execution_date': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'outlets': [], 'params': {}, 'prev_data_interval_start_success': DateTime(2022, 1, 1, 0, 0, 0, tzinfo=Timezone('UTC')), 'prev_data_interval_end_success': DateTime(2022, 1, 2, 0, 0, 0, tzinfo=Timezone('UTC')), 'prev_ds': '2022-01-02', 'prev_ds_nodash': '20220102', 'prev_execution_date': datetime.datetime(2022, 1, 2, 0, 0, tzinfo=Timezone('UTC')), 'prev_execution_date_success': DateTime(2022, 1, 1, 0, 0, 0, tzinfo=Timezone('UTC')), 'prev_start_date_success': DateTime(2022, 1, 24, 2, 39, 33, 705019, tzinfo=Timezone('UTC')), 'run_id': 'scheduled__2022-01-03T00:00:00+00:00', 'task': <Task(PythonOperator): load_invoices>, 'task_instance': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [running]>, 'task_instance_key_str': 'datawarehouse_etl__load_invoices__20220103', 'test_mode': False, 'ti': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [running]>, 'tomorrow_ds': '2022-01-04', 'tomorrow_ds_nodash': '20220104', 'ts': '2022-01-03T00:00:00+00:00', 'ts_nodash': '20220103T000000', 'ts_nodash_with_tz': '20220103T000000+0000', 'var': {'json': None, 'value': None}, 'conn': None, 'yesterday_ds': '2022-01-02', 'yesterday_ds_nodash': '20220102', 'key': 'value', 'ts_var': '2022-01-03T00:00:00+00:00', 'tsnodash_var': '20220103T000000', 'templates_dict': None}
[2022-01-24 02:39:36,037] {logging_mixin.py:109} INFO - ts:  2022-01-03 00:00:00+00:00
[2022-01-24 02:39:36,037] {logging_mixin.py:109} INFO - <class 'pandas._libs.tslibs.timestamps.Timestamp'>
[2022-01-24 02:39:36,037] {logging_mixin.py:109} INFO - Object created.
[2022-01-24 02:39:36,038] {logging_mixin.py:109} INFO - 2022 1 3
[2022-01-24 02:39:36,039] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-3.json
[2022-01-24 02:39:36,039] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-19.json
[2022-01-24 02:39:36,039] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-49.json
[2022-01-24 02:39:36,040] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-45.json
[2022-01-24 02:39:36,040] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-7.json
[2022-01-24 02:39:36,040] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-54.json
[2022-01-24 02:39:36,041] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-75.json
[2022-01-24 02:39:36,041] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-60.json
[2022-01-24 02:39:36,041] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-83.json
[2022-01-24 02:39:36,041] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-13.json
[2022-01-24 02:39:36,042] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-2.json
[2022-01-24 02:39:36,042] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-59.json
[2022-01-24 02:39:36,042] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-71.json
[2022-01-24 02:39:36,042] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-8.json
[2022-01-24 02:39:36,043] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-40.json
[2022-01-24 02:39:36,043] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-39.json
[2022-01-24 02:39:36,043] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-65.json
[2022-01-24 02:39:36,044] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-18.json
[2022-01-24 02:39:36,044] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-27.json
[2022-01-24 02:39:36,044] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-51.json
[2022-01-24 02:39:36,044] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-16.json
[2022-01-24 02:39:36,045] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-4.json
[2022-01-24 02:39:36,045] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-62.json
[2022-01-24 02:39:36,045] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-68.json
[2022-01-24 02:39:36,046] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-78.json
[2022-01-24 02:39:36,046] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-33.json
[2022-01-24 02:39:36,046] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-41.json
[2022-01-24 02:39:36,046] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-69.json
[2022-01-24 02:39:36,047] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-0.json
[2022-01-24 02:39:36,047] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-21.json
[2022-01-24 02:39:36,047] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-47.json
[2022-01-24 02:39:36,048] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-9.json
[2022-01-24 02:39:36,048] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-80.json
[2022-01-24 02:39:36,048] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-70.json
[2022-01-24 02:39:36,049] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-6.json
[2022-01-24 02:39:36,049] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-66.json
[2022-01-24 02:39:36,049] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-43.json
[2022-01-24 02:39:36,049] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-46.json
[2022-01-24 02:39:36,050] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-25.json
[2022-01-24 02:39:36,050] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-17.json
[2022-01-24 02:39:36,050] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-35.json
[2022-01-24 02:39:36,050] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-22.json
[2022-01-24 02:39:36,051] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-15.json
[2022-01-24 02:39:36,051] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-53.json
[2022-01-24 02:39:36,051] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-14.json
[2022-01-24 02:39:36,051] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-1.json
[2022-01-24 02:39:36,052] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-72.json
[2022-01-24 02:39:36,052] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-64.json
[2022-01-24 02:39:36,052] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-28.json
[2022-01-24 02:39:36,053] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-12.json
[2022-01-24 02:39:36,053] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-20.json
[2022-01-24 02:39:36,053] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-61.json
[2022-01-24 02:39:36,053] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-56.json
[2022-01-24 02:39:36,054] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-42.json
[2022-01-24 02:39:36,054] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-50.json
[2022-01-24 02:39:36,054] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-58.json
[2022-01-24 02:39:36,054] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-77.json
[2022-01-24 02:39:36,055] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-52.json
[2022-01-24 02:39:36,055] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-79.json
[2022-01-24 02:39:36,055] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-36.json
[2022-01-24 02:39:36,056] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-24.json
[2022-01-24 02:39:36,056] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-23.json
[2022-01-24 02:39:36,056] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-81.json
[2022-01-24 02:39:36,056] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-37.json
[2022-01-24 02:39:36,057] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-74.json
[2022-01-24 02:39:36,057] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-48.json
[2022-01-24 02:39:36,057] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-57.json
[2022-01-24 02:39:36,058] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-34.json
[2022-01-24 02:39:36,058] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-32.json
[2022-01-24 02:39:36,058] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-63.json
[2022-01-24 02:39:36,058] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-5.json
[2022-01-24 02:39:36,059] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-84.json
[2022-01-24 02:39:36,059] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-73.json
[2022-01-24 02:39:36,059] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-30.json
[2022-01-24 02:39:36,059] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-10.json
[2022-01-24 02:39:36,060] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-29.json
[2022-01-24 02:39:36,060] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-38.json
[2022-01-24 02:39:36,060] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-44.json
[2022-01-24 02:39:36,060] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-31.json
[2022-01-24 02:39:36,061] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-11.json
[2022-01-24 02:39:36,061] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-67.json
[2022-01-24 02:39:36,061] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-26.json
[2022-01-24 02:39:36,062] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-82.json
[2022-01-24 02:39:36,062] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-76.json
[2022-01-24 02:39:36,062] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-55.json
[2022-01-24 02:39:36,065] {logging_mixin.py:109} INFO - 85
[2022-01-24 02:39:36,095] {logging_mixin.py:109} INFO -      invoice_id    invoice_timestamp  customer_id  ...  qty is_discount       price
0   20220103-11  2022-01-03T19:59:51  yyymlnv2864  ...  256           0   8988.1600
1   20220103-26  2022-01-03T03:36:28  yadoags1019  ...  131           1   6461.0510
2   20220103-53  2022-01-03T15:35:24  tikvtot4348  ...  297           0   2981.8800
3    20220103-5  2022-01-03T14:07:09  mjbhujn4102  ...   41           1    275.7988
4   20220103-15  2022-01-03T09:55:41  aecqtdi3986  ...   40           1   2338.8400
..          ...                  ...          ...  ...  ...         ...         ...
80   20220103-7  2022-01-03T22:54:32  codpbua4340  ...  234           1  11880.0864
81  20220103-32  2022-01-03T14:27:34  sexnidd1428  ...  249           1   1405.0821
82  20220103-83  2022-01-03T09:31:32  yyymlnv2864  ...   55           1   1197.2510
83  20220103-78  2022-01-03T19:54:44  sexnidd1428  ...  208           0   7302.8800
84  20220103-59  2022-01-03T13:13:44  dludxgk4225  ...  209           0  18837.1700

[85 rows x 8 columns]
[2022-01-24 02:39:36,096] {python.py:175} INFO - Done. Returned value was: None
[2022-01-24 02:39:36,112] {taskinstance.py:1277} INFO - Marking task as SUCCESS. dag_id=datawarehouse_etl, task_id=load_invoices, execution_date=20220103T000000, start_date=20220124T023935, end_date=20220124T023936
[2022-01-24 02:39:36,150] {local_task_job.py:154} INFO - Task exited with return code 0
[2022-01-24 02:39:36,188] {local_task_job.py:264} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2022-01-24 03:41:41,787] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [queued]>
[2022-01-24 03:41:41,795] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [queued]>
[2022-01-24 03:41:41,795] {taskinstance.py:1238} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 03:41:41,795] {taskinstance.py:1239} INFO - Starting attempt 1 of 1
[2022-01-24 03:41:41,795] {taskinstance.py:1240} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 03:41:41,804] {taskinstance.py:1259} INFO - Executing <Task(PythonOperator): load_invoices> on 2022-01-03 00:00:00+00:00
[2022-01-24 03:41:41,808] {standard_task_runner.py:52} INFO - Started process 5555 to run task
[2022-01-24 03:41:41,810] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'datawarehouse_etl', 'load_invoices', 'scheduled__2022-01-03T00:00:00+00:00', '--job-id', '60', '--raw', '--subdir', 'DAGS_FOLDER/datawarehouse_***.py', '--cfg-path', '/tmp/tmpodh4485j', '--error-file', '/tmp/tmpatf482kr']
[2022-01-24 03:41:41,811] {standard_task_runner.py:77} INFO - Job 60: Subtask load_invoices
[2022-01-24 03:41:41,847] {logging_mixin.py:109} INFO - Running <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [running]> on host cd9bb47288d1
[2022-01-24 03:41:41,893] {taskinstance.py:1426} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=datawarehouse_etl
AIRFLOW_CTX_TASK_ID=load_invoices
AIRFLOW_CTX_EXECUTION_DATE=2022-01-03T00:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-01-03T00:00:00+00:00
[2022-01-24 03:41:41,894] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:41:41,895] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:41:41,895] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds_nodash' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds_nodash }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:41:41,895] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_end' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:41:41,895] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:41:41,895] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:41:41,895] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:41:41,895] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date_success' from the template is deprecated and will be removed in a future version. Please use 'prev_data_interval_start_success' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:41:41,895] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:41:41,895] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:41:41,895] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:41:41,896] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:41:41,896] {logging_mixin.py:109} INFO - {'conf': <***.configuration.AirflowConfigParser object at 0x7f1e4dfc6a10>, 'dag': <DAG: datawarehouse_etl>, 'dag_run': <DagRun datawarehouse_etl @ 2022-01-03 00:00:00+00:00: scheduled__2022-01-03T00:00:00+00:00, externally triggered: False>, 'data_interval_end': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'data_interval_start': DateTime(2022, 1, 3, 0, 0, 0, tzinfo=Timezone('UTC')), 'ds': '2022-01-03', 'ds_nodash': '20220103', 'execution_date': DateTime(2022, 1, 3, 0, 0, 0, tzinfo=Timezone('UTC')), 'inlets': [], 'logical_date': DateTime(2022, 1, 3, 0, 0, 0, tzinfo=Timezone('UTC')), 'macros': <module '***.macros' from '/home/***/.local/lib/python3.7/site-packages/***/macros/__init__.py'>, 'next_ds': '2022-01-04', 'next_ds_nodash': '20220104', 'next_execution_date': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'outlets': [], 'params': {}, 'prev_data_interval_start_success': None, 'prev_data_interval_end_success': None, 'prev_ds': '2022-01-02', 'prev_ds_nodash': '20220102', 'prev_execution_date': datetime.datetime(2022, 1, 2, 0, 0, tzinfo=Timezone('UTC')), 'prev_execution_date_success': None, 'prev_start_date_success': None, 'run_id': 'scheduled__2022-01-03T00:00:00+00:00', 'task': <Task(PythonOperator): load_invoices>, 'task_instance': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [running]>, 'task_instance_key_str': 'datawarehouse_etl__load_invoices__20220103', 'test_mode': False, 'ti': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [running]>, 'tomorrow_ds': '2022-01-04', 'tomorrow_ds_nodash': '20220104', 'ts': '2022-01-03T00:00:00+00:00', 'ts_nodash': '20220103T000000', 'ts_nodash_with_tz': '20220103T000000+0000', 'var': {'json': None, 'value': None}, 'conn': None, 'yesterday_ds': '2022-01-02', 'yesterday_ds_nodash': '20220102', 'key': 'value', 'ts_var': '2022-01-03T00:00:00+00:00', 'tsnodash_var': '20220103T000000', 'templates_dict': None}
[2022-01-24 03:41:41,897] {logging_mixin.py:109} INFO - ts:  2022-01-03 00:00:00+00:00
[2022-01-24 03:41:41,897] {logging_mixin.py:109} INFO - <class 'pandas._libs.tslibs.timestamps.Timestamp'>
[2022-01-24 03:41:41,898] {logging_mixin.py:109} INFO - Object created.
[2022-01-24 03:41:41,898] {logging_mixin.py:109} INFO - 2022 1 3
[2022-01-24 03:41:41,899] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-3.json
[2022-01-24 03:41:41,899] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-19.json
[2022-01-24 03:41:41,900] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-49.json
[2022-01-24 03:41:41,900] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-45.json
[2022-01-24 03:41:41,900] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-7.json
[2022-01-24 03:41:41,901] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-54.json
[2022-01-24 03:41:41,901] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-75.json
[2022-01-24 03:41:41,901] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-60.json
[2022-01-24 03:41:41,902] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-83.json
[2022-01-24 03:41:41,902] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-13.json
[2022-01-24 03:41:41,902] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-2.json
[2022-01-24 03:41:41,903] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-59.json
[2022-01-24 03:41:41,903] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-71.json
[2022-01-24 03:41:41,903] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-8.json
[2022-01-24 03:41:41,903] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-40.json
[2022-01-24 03:41:41,904] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-39.json
[2022-01-24 03:41:41,904] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-65.json
[2022-01-24 03:41:41,904] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-18.json
[2022-01-24 03:41:41,904] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-27.json
[2022-01-24 03:41:41,905] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-51.json
[2022-01-24 03:41:41,905] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-16.json
[2022-01-24 03:41:41,905] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-4.json
[2022-01-24 03:41:41,905] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-62.json
[2022-01-24 03:41:41,905] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-68.json
[2022-01-24 03:41:41,905] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-78.json
[2022-01-24 03:41:41,906] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-33.json
[2022-01-24 03:41:41,906] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-41.json
[2022-01-24 03:41:41,906] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-69.json
[2022-01-24 03:41:41,906] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-0.json
[2022-01-24 03:41:41,906] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-21.json
[2022-01-24 03:41:41,907] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-47.json
[2022-01-24 03:41:41,907] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-9.json
[2022-01-24 03:41:41,907] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-80.json
[2022-01-24 03:41:41,907] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-70.json
[2022-01-24 03:41:41,907] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-6.json
[2022-01-24 03:41:41,908] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-66.json
[2022-01-24 03:41:41,908] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-43.json
[2022-01-24 03:41:41,908] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-46.json
[2022-01-24 03:41:41,908] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-25.json
[2022-01-24 03:41:41,909] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-17.json
[2022-01-24 03:41:41,909] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-35.json
[2022-01-24 03:41:41,909] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-22.json
[2022-01-24 03:41:41,909] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-15.json
[2022-01-24 03:41:41,910] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-53.json
[2022-01-24 03:41:41,910] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-14.json
[2022-01-24 03:41:41,910] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-1.json
[2022-01-24 03:41:41,910] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-72.json
[2022-01-24 03:41:41,911] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-64.json
[2022-01-24 03:41:41,911] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-28.json
[2022-01-24 03:41:41,911] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-12.json
[2022-01-24 03:41:41,911] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-20.json
[2022-01-24 03:41:41,911] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-61.json
[2022-01-24 03:41:41,912] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-56.json
[2022-01-24 03:41:41,912] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-42.json
[2022-01-24 03:41:41,912] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-50.json
[2022-01-24 03:41:41,913] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-58.json
[2022-01-24 03:41:41,913] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-77.json
[2022-01-24 03:41:41,913] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-52.json
[2022-01-24 03:41:41,913] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-79.json
[2022-01-24 03:41:41,914] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-36.json
[2022-01-24 03:41:41,914] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-24.json
[2022-01-24 03:41:41,914] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-23.json
[2022-01-24 03:41:41,914] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-81.json
[2022-01-24 03:41:41,915] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-37.json
[2022-01-24 03:41:41,915] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-74.json
[2022-01-24 03:41:41,915] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-48.json
[2022-01-24 03:41:41,915] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-57.json
[2022-01-24 03:41:41,916] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-34.json
[2022-01-24 03:41:41,916] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-32.json
[2022-01-24 03:41:41,916] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-63.json
[2022-01-24 03:41:41,917] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-5.json
[2022-01-24 03:41:41,917] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-84.json
[2022-01-24 03:41:41,917] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-73.json
[2022-01-24 03:41:41,917] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-30.json
[2022-01-24 03:41:41,918] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-10.json
[2022-01-24 03:41:41,918] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-29.json
[2022-01-24 03:41:41,918] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-38.json
[2022-01-24 03:41:41,919] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-44.json
[2022-01-24 03:41:41,919] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-31.json
[2022-01-24 03:41:41,919] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-11.json
[2022-01-24 03:41:41,919] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-67.json
[2022-01-24 03:41:41,920] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-26.json
[2022-01-24 03:41:41,920] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-82.json
[2022-01-24 03:41:41,920] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-76.json
[2022-01-24 03:41:41,920] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-55.json
[2022-01-24 03:41:41,922] {logging_mixin.py:109} INFO - 85
[2022-01-24 03:41:41,935] {logging_mixin.py:109} INFO -      invoice_id    invoice_timestamp  customer_id  ...  qty is_discount       price
0   20220103-11  2022-01-03T19:59:51  yyymlnv2864  ...  256           0   8988.1600
1   20220103-26  2022-01-03T03:36:28  yadoags1019  ...  131           1   6461.0510
2   20220103-53  2022-01-03T15:35:24  tikvtot4348  ...  297           0   2981.8800
3    20220103-5  2022-01-03T14:07:09  mjbhujn4102  ...   41           1    275.7988
4   20220103-15  2022-01-03T09:55:41  aecqtdi3986  ...   40           1   2338.8400
..          ...                  ...          ...  ...  ...         ...         ...
80   20220103-7  2022-01-03T22:54:32  codpbua4340  ...  234           1  11880.0864
81  20220103-32  2022-01-03T14:27:34  sexnidd1428  ...  249           1   1405.0821
82  20220103-83  2022-01-03T09:31:32  yyymlnv2864  ...   55           1   1197.2510
83  20220103-78  2022-01-03T19:54:44  sexnidd1428  ...  208           0   7302.8800
84  20220103-59  2022-01-03T13:13:44  dludxgk4225  ...  209           0  18837.1700

[85 rows x 8 columns]
[2022-01-24 03:41:41,935] {taskinstance.py:1700} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1329, in _run_raw_task
    self._execute_task_with_callbacks(context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1455, in _execute_task_with_callbacks
    result = self._execute_task(context, self.task)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1511, in _execute_task
    result = execute_callable(context=context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 174, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 185, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/datawarehouse_airflow.py", line 52, in load_invoices
    invoice_df['invoice_date'] = datetime.datetime(year, month, day)
NameError: name 'year' is not defined
[2022-01-24 03:41:41,947] {taskinstance.py:1277} INFO - Marking task as FAILED. dag_id=datawarehouse_etl, task_id=load_invoices, execution_date=20220103T000000, start_date=20220124T034141, end_date=20220124T034141
[2022-01-24 03:41:41,956] {standard_task_runner.py:92} ERROR - Failed to execute job 60 for task load_invoices
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/task/task_runner/standard_task_runner.py", line 85, in _start_by_fork
    args.func(args, dag=self.dag)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/cli_parser.py", line 48, in command
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/cli.py", line 92, in wrapper
    return f(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/commands/task_command.py", line 298, in task_run
    _run_task_by_selected_method(args, dag, ti)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/commands/task_command.py", line 107, in _run_task_by_selected_method
    _run_raw_task(args, ti)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/commands/task_command.py", line 184, in _run_raw_task
    error_file=args.error_file,
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/session.py", line 70, in wrapper
    return func(*args, session=session, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1329, in _run_raw_task
    self._execute_task_with_callbacks(context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1455, in _execute_task_with_callbacks
    result = self._execute_task(context, self.task)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1511, in _execute_task
    result = execute_callable(context=context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 174, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 185, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/datawarehouse_airflow.py", line 52, in load_invoices
    invoice_df['invoice_date'] = datetime.datetime(year, month, day)
NameError: name 'year' is not defined
[2022-01-24 03:41:41,982] {local_task_job.py:154} INFO - Task exited with return code 1
[2022-01-24 03:41:42,009] {local_task_job.py:264} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-01-24 03:43:20,229] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [queued]>
[2022-01-24 03:43:20,236] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [queued]>
[2022-01-24 03:43:20,236] {taskinstance.py:1238} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 03:43:20,236] {taskinstance.py:1239} INFO - Starting attempt 1 of 1
[2022-01-24 03:43:20,236] {taskinstance.py:1240} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 03:43:20,245] {taskinstance.py:1259} INFO - Executing <Task(PythonOperator): load_invoices> on 2022-01-03 00:00:00+00:00
[2022-01-24 03:43:20,249] {standard_task_runner.py:52} INFO - Started process 5636 to run task
[2022-01-24 03:43:20,251] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'datawarehouse_etl', 'load_invoices', 'scheduled__2022-01-03T00:00:00+00:00', '--job-id', '62', '--raw', '--subdir', 'DAGS_FOLDER/datawarehouse_***.py', '--cfg-path', '/tmp/tmpbc4we0a1', '--error-file', '/tmp/tmp3l6q80do']
[2022-01-24 03:43:20,252] {standard_task_runner.py:77} INFO - Job 62: Subtask load_invoices
[2022-01-24 03:43:20,296] {logging_mixin.py:109} INFO - Running <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [running]> on host cd9bb47288d1
[2022-01-24 03:43:20,334] {taskinstance.py:1426} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=datawarehouse_etl
AIRFLOW_CTX_TASK_ID=load_invoices
AIRFLOW_CTX_EXECUTION_DATE=2022-01-03T00:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-01-03T00:00:00+00:00
[2022-01-24 03:43:20,335] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:43:20,335] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:43:20,335] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds_nodash' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds_nodash }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:43:20,335] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_end' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:43:20,336] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:43:20,336] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:43:20,336] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:43:20,336] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date_success' from the template is deprecated and will be removed in a future version. Please use 'prev_data_interval_start_success' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:43:20,336] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:43:20,336] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:43:20,336] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:43:20,336] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:43:20,336] {logging_mixin.py:109} INFO - {'conf': <***.configuration.AirflowConfigParser object at 0x7f1e4dfc6a10>, 'dag': <DAG: datawarehouse_etl>, 'dag_run': <DagRun datawarehouse_etl @ 2022-01-03 00:00:00+00:00: scheduled__2022-01-03T00:00:00+00:00, externally triggered: False>, 'data_interval_end': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'data_interval_start': DateTime(2022, 1, 3, 0, 0, 0, tzinfo=Timezone('UTC')), 'ds': '2022-01-03', 'ds_nodash': '20220103', 'execution_date': DateTime(2022, 1, 3, 0, 0, 0, tzinfo=Timezone('UTC')), 'inlets': [], 'logical_date': DateTime(2022, 1, 3, 0, 0, 0, tzinfo=Timezone('UTC')), 'macros': <module '***.macros' from '/home/***/.local/lib/python3.7/site-packages/***/macros/__init__.py'>, 'next_ds': '2022-01-04', 'next_ds_nodash': '20220104', 'next_execution_date': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'outlets': [], 'params': {}, 'prev_data_interval_start_success': None, 'prev_data_interval_end_success': None, 'prev_ds': '2022-01-02', 'prev_ds_nodash': '20220102', 'prev_execution_date': datetime.datetime(2022, 1, 2, 0, 0, tzinfo=Timezone('UTC')), 'prev_execution_date_success': None, 'prev_start_date_success': None, 'run_id': 'scheduled__2022-01-03T00:00:00+00:00', 'task': <Task(PythonOperator): load_invoices>, 'task_instance': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [running]>, 'task_instance_key_str': 'datawarehouse_etl__load_invoices__20220103', 'test_mode': False, 'ti': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [running]>, 'tomorrow_ds': '2022-01-04', 'tomorrow_ds_nodash': '20220104', 'ts': '2022-01-03T00:00:00+00:00', 'ts_nodash': '20220103T000000', 'ts_nodash_with_tz': '20220103T000000+0000', 'var': {'json': None, 'value': None}, 'conn': None, 'yesterday_ds': '2022-01-02', 'yesterday_ds_nodash': '20220102', 'key': 'value', 'ts_var': '2022-01-03T00:00:00+00:00', 'tsnodash_var': '20220103T000000', 'templates_dict': None}
[2022-01-24 03:43:20,337] {logging_mixin.py:109} INFO - ts:  2022-01-03 00:00:00+00:00
[2022-01-24 03:43:20,337] {logging_mixin.py:109} INFO - <class 'pandas._libs.tslibs.timestamps.Timestamp'>
[2022-01-24 03:43:20,337] {logging_mixin.py:109} INFO - Object created.
[2022-01-24 03:43:20,337] {logging_mixin.py:109} INFO - 2022 1 3
[2022-01-24 03:43:20,338] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-3.json
[2022-01-24 03:43:20,338] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-19.json
[2022-01-24 03:43:20,338] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-49.json
[2022-01-24 03:43:20,338] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-45.json
[2022-01-24 03:43:20,338] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-7.json
[2022-01-24 03:43:20,339] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-54.json
[2022-01-24 03:43:20,339] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-75.json
[2022-01-24 03:43:20,339] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-60.json
[2022-01-24 03:43:20,339] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-83.json
[2022-01-24 03:43:20,339] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-13.json
[2022-01-24 03:43:20,339] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-2.json
[2022-01-24 03:43:20,339] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-59.json
[2022-01-24 03:43:20,339] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-71.json
[2022-01-24 03:43:20,339] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-8.json
[2022-01-24 03:43:20,339] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-40.json
[2022-01-24 03:43:20,339] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-39.json
[2022-01-24 03:43:20,339] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-65.json
[2022-01-24 03:43:20,340] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-18.json
[2022-01-24 03:43:20,340] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-27.json
[2022-01-24 03:43:20,340] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-51.json
[2022-01-24 03:43:20,340] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-16.json
[2022-01-24 03:43:20,340] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-4.json
[2022-01-24 03:43:20,340] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-62.json
[2022-01-24 03:43:20,340] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-68.json
[2022-01-24 03:43:20,340] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-78.json
[2022-01-24 03:43:20,340] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-33.json
[2022-01-24 03:43:20,340] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-41.json
[2022-01-24 03:43:20,340] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-69.json
[2022-01-24 03:43:20,340] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-0.json
[2022-01-24 03:43:20,341] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-21.json
[2022-01-24 03:43:20,341] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-47.json
[2022-01-24 03:43:20,341] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-9.json
[2022-01-24 03:43:20,341] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-80.json
[2022-01-24 03:43:20,341] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-70.json
[2022-01-24 03:43:20,341] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-6.json
[2022-01-24 03:43:20,341] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-66.json
[2022-01-24 03:43:20,341] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-43.json
[2022-01-24 03:43:20,341] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-46.json
[2022-01-24 03:43:20,341] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-25.json
[2022-01-24 03:43:20,341] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-17.json
[2022-01-24 03:43:20,341] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-35.json
[2022-01-24 03:43:20,341] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-22.json
[2022-01-24 03:43:20,342] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-15.json
[2022-01-24 03:43:20,342] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-53.json
[2022-01-24 03:43:20,342] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-14.json
[2022-01-24 03:43:20,342] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-1.json
[2022-01-24 03:43:20,342] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-72.json
[2022-01-24 03:43:20,342] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-64.json
[2022-01-24 03:43:20,342] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-28.json
[2022-01-24 03:43:20,342] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-12.json
[2022-01-24 03:43:20,342] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-20.json
[2022-01-24 03:43:20,342] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-61.json
[2022-01-24 03:43:20,342] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-56.json
[2022-01-24 03:43:20,342] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-42.json
[2022-01-24 03:43:20,342] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-50.json
[2022-01-24 03:43:20,343] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-58.json
[2022-01-24 03:43:20,343] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-77.json
[2022-01-24 03:43:20,343] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-52.json
[2022-01-24 03:43:20,343] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-79.json
[2022-01-24 03:43:20,343] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-36.json
[2022-01-24 03:43:20,343] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-24.json
[2022-01-24 03:43:20,343] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-23.json
[2022-01-24 03:43:20,343] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-81.json
[2022-01-24 03:43:20,343] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-37.json
[2022-01-24 03:43:20,343] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-74.json
[2022-01-24 03:43:20,343] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-48.json
[2022-01-24 03:43:20,343] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-57.json
[2022-01-24 03:43:20,343] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-34.json
[2022-01-24 03:43:20,344] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-32.json
[2022-01-24 03:43:20,344] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-63.json
[2022-01-24 03:43:20,344] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-5.json
[2022-01-24 03:43:20,344] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-84.json
[2022-01-24 03:43:20,344] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-73.json
[2022-01-24 03:43:20,344] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-30.json
[2022-01-24 03:43:20,344] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-10.json
[2022-01-24 03:43:20,344] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-29.json
[2022-01-24 03:43:20,344] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-38.json
[2022-01-24 03:43:20,344] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-44.json
[2022-01-24 03:43:20,344] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-31.json
[2022-01-24 03:43:20,344] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-11.json
[2022-01-24 03:43:20,344] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-67.json
[2022-01-24 03:43:20,345] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-26.json
[2022-01-24 03:43:20,345] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-82.json
[2022-01-24 03:43:20,345] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-76.json
[2022-01-24 03:43:20,345] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-55.json
[2022-01-24 03:43:20,346] {logging_mixin.py:109} INFO - 85
[2022-01-24 03:43:20,360] {logging_mixin.py:109} INFO -      invoice_id    invoice_timestamp  customer_id  ...  qty is_discount       price
0   20220103-11  2022-01-03T19:59:51  yyymlnv2864  ...  256           0   8988.1600
1   20220103-26  2022-01-03T03:36:28  yadoags1019  ...  131           1   6461.0510
2   20220103-53  2022-01-03T15:35:24  tikvtot4348  ...  297           0   2981.8800
3    20220103-5  2022-01-03T14:07:09  mjbhujn4102  ...   41           1    275.7988
4   20220103-15  2022-01-03T09:55:41  aecqtdi3986  ...   40           1   2338.8400
..          ...                  ...          ...  ...  ...         ...         ...
80   20220103-7  2022-01-03T22:54:32  codpbua4340  ...  234           1  11880.0864
81  20220103-32  2022-01-03T14:27:34  sexnidd1428  ...  249           1   1405.0821
82  20220103-83  2022-01-03T09:31:32  yyymlnv2864  ...   55           1   1197.2510
83  20220103-78  2022-01-03T19:54:44  sexnidd1428  ...  208           0   7302.8800
84  20220103-59  2022-01-03T13:13:44  dludxgk4225  ...  209           0  18837.1700

[85 rows x 8 columns]
[2022-01-24 03:43:20,375] {taskinstance.py:1700} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1329, in _run_raw_task
    self._execute_task_with_callbacks(context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1455, in _execute_task_with_callbacks
    result = self._execute_task(context, self.task)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1511, in _execute_task
    result = execute_callable(context=context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 174, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 185, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/datawarehouse_airflow.py", line 57, in load_invoices
    invoice_df.to_sql('invoice_stagging', redshift_hook.get_sqlalchemy_engine(), if_exists='replace', index=False)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/hooks/dbapi.py", line 118, in get_sqlalchemy_engine
    return create_engine(self.get_uri(), **engine_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/providers/postgres/hooks/postgres.py", line 142, in get_uri
    conn = self.get_connection(getattr(self, self.conn_name_attr))
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/hooks/base.py", line 68, in get_connection
    conn = Connection.get_connection_from_secrets(conn_id)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/connection.py", line 410, in get_connection_from_secrets
    raise AirflowNotFoundException(f"The conn_id `{conn_id}` isn't defined")
airflow.exceptions.AirflowNotFoundException: The conn_id `redshift` isn't defined
[2022-01-24 03:43:20,380] {taskinstance.py:1277} INFO - Marking task as FAILED. dag_id=datawarehouse_etl, task_id=load_invoices, execution_date=20220103T000000, start_date=20220124T034320, end_date=20220124T034320
[2022-01-24 03:43:20,390] {standard_task_runner.py:92} ERROR - Failed to execute job 62 for task load_invoices
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/task/task_runner/standard_task_runner.py", line 85, in _start_by_fork
    args.func(args, dag=self.dag)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/cli_parser.py", line 48, in command
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/cli.py", line 92, in wrapper
    return f(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/commands/task_command.py", line 298, in task_run
    _run_task_by_selected_method(args, dag, ti)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/commands/task_command.py", line 107, in _run_task_by_selected_method
    _run_raw_task(args, ti)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/commands/task_command.py", line 184, in _run_raw_task
    error_file=args.error_file,
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/session.py", line 70, in wrapper
    return func(*args, session=session, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1329, in _run_raw_task
    self._execute_task_with_callbacks(context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1455, in _execute_task_with_callbacks
    result = self._execute_task(context, self.task)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1511, in _execute_task
    result = execute_callable(context=context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 174, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 185, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/datawarehouse_airflow.py", line 57, in load_invoices
    invoice_df.to_sql('invoice_stagging', redshift_hook.get_sqlalchemy_engine(), if_exists='replace', index=False)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/hooks/dbapi.py", line 118, in get_sqlalchemy_engine
    return create_engine(self.get_uri(), **engine_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/providers/postgres/hooks/postgres.py", line 142, in get_uri
    conn = self.get_connection(getattr(self, self.conn_name_attr))
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/hooks/base.py", line 68, in get_connection
    conn = Connection.get_connection_from_secrets(conn_id)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/connection.py", line 410, in get_connection_from_secrets
    raise AirflowNotFoundException(f"The conn_id `{conn_id}` isn't defined")
airflow.exceptions.AirflowNotFoundException: The conn_id `redshift` isn't defined
[2022-01-24 03:43:20,423] {local_task_job.py:154} INFO - Task exited with return code 1
[2022-01-24 03:43:20,455] {local_task_job.py:264} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-01-24 03:45:55,116] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [queued]>
[2022-01-24 03:45:55,126] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [queued]>
[2022-01-24 03:45:55,126] {taskinstance.py:1238} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 03:45:55,126] {taskinstance.py:1239} INFO - Starting attempt 1 of 1
[2022-01-24 03:45:55,126] {taskinstance.py:1240} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 03:45:55,136] {taskinstance.py:1259} INFO - Executing <Task(PythonOperator): load_invoices> on 2022-01-03 00:00:00+00:00
[2022-01-24 03:45:55,140] {standard_task_runner.py:52} INFO - Started process 5758 to run task
[2022-01-24 03:45:55,142] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'datawarehouse_etl', 'load_invoices', 'scheduled__2022-01-03T00:00:00+00:00', '--job-id', '64', '--raw', '--subdir', 'DAGS_FOLDER/datawarehouse_***.py', '--cfg-path', '/tmp/tmpwkvgw_up', '--error-file', '/tmp/tmpybfh0hjb']
[2022-01-24 03:45:55,143] {standard_task_runner.py:77} INFO - Job 64: Subtask load_invoices
[2022-01-24 03:45:55,181] {logging_mixin.py:109} INFO - Running <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [running]> on host cd9bb47288d1
[2022-01-24 03:45:55,220] {taskinstance.py:1426} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=datawarehouse_etl
AIRFLOW_CTX_TASK_ID=load_invoices
AIRFLOW_CTX_EXECUTION_DATE=2022-01-03T00:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-01-03T00:00:00+00:00
[2022-01-24 03:45:55,221] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:45:55,221] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:45:55,221] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds_nodash' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds_nodash }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:45:55,222] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_end' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:45:55,222] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:45:55,222] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:45:55,222] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:45:55,222] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date_success' from the template is deprecated and will be removed in a future version. Please use 'prev_data_interval_start_success' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:45:55,222] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:45:55,222] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:45:55,222] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:45:55,222] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:45:55,223] {logging_mixin.py:109} INFO - {'conf': <***.configuration.AirflowConfigParser object at 0x7f1e4dfc6a10>, 'dag': <DAG: datawarehouse_etl>, 'dag_run': <DagRun datawarehouse_etl @ 2022-01-03 00:00:00+00:00: scheduled__2022-01-03T00:00:00+00:00, externally triggered: False>, 'data_interval_end': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'data_interval_start': DateTime(2022, 1, 3, 0, 0, 0, tzinfo=Timezone('UTC')), 'ds': '2022-01-03', 'ds_nodash': '20220103', 'execution_date': DateTime(2022, 1, 3, 0, 0, 0, tzinfo=Timezone('UTC')), 'inlets': [], 'logical_date': DateTime(2022, 1, 3, 0, 0, 0, tzinfo=Timezone('UTC')), 'macros': <module '***.macros' from '/home/***/.local/lib/python3.7/site-packages/***/macros/__init__.py'>, 'next_ds': '2022-01-04', 'next_ds_nodash': '20220104', 'next_execution_date': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'outlets': [], 'params': {}, 'prev_data_interval_start_success': None, 'prev_data_interval_end_success': None, 'prev_ds': '2022-01-02', 'prev_ds_nodash': '20220102', 'prev_execution_date': datetime.datetime(2022, 1, 2, 0, 0, tzinfo=Timezone('UTC')), 'prev_execution_date_success': None, 'prev_start_date_success': None, 'run_id': 'scheduled__2022-01-03T00:00:00+00:00', 'task': <Task(PythonOperator): load_invoices>, 'task_instance': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [running]>, 'task_instance_key_str': 'datawarehouse_etl__load_invoices__20220103', 'test_mode': False, 'ti': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [running]>, 'tomorrow_ds': '2022-01-04', 'tomorrow_ds_nodash': '20220104', 'ts': '2022-01-03T00:00:00+00:00', 'ts_nodash': '20220103T000000', 'ts_nodash_with_tz': '20220103T000000+0000', 'var': {'json': None, 'value': None}, 'conn': None, 'yesterday_ds': '2022-01-02', 'yesterday_ds_nodash': '20220102', 'key': 'value', 'ts_var': '2022-01-03T00:00:00+00:00', 'tsnodash_var': '20220103T000000', 'templates_dict': None}
[2022-01-24 03:45:55,224] {logging_mixin.py:109} INFO - ts:  2022-01-03 00:00:00+00:00
[2022-01-24 03:45:55,224] {logging_mixin.py:109} INFO - <class 'pandas._libs.tslibs.timestamps.Timestamp'>
[2022-01-24 03:45:55,224] {logging_mixin.py:109} INFO - Object created.
[2022-01-24 03:45:55,224] {logging_mixin.py:109} INFO - 2022 1 3
[2022-01-24 03:45:55,225] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-3.json
[2022-01-24 03:45:55,225] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-19.json
[2022-01-24 03:45:55,225] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-49.json
[2022-01-24 03:45:55,225] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-45.json
[2022-01-24 03:45:55,225] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-7.json
[2022-01-24 03:45:55,225] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-54.json
[2022-01-24 03:45:55,225] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-75.json
[2022-01-24 03:45:55,225] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-60.json
[2022-01-24 03:45:55,225] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-83.json
[2022-01-24 03:45:55,226] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-13.json
[2022-01-24 03:45:55,226] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-2.json
[2022-01-24 03:45:55,226] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-59.json
[2022-01-24 03:45:55,226] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-71.json
[2022-01-24 03:45:55,226] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-8.json
[2022-01-24 03:45:55,226] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-40.json
[2022-01-24 03:45:55,226] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-39.json
[2022-01-24 03:45:55,226] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-65.json
[2022-01-24 03:45:55,226] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-18.json
[2022-01-24 03:45:55,226] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-27.json
[2022-01-24 03:45:55,226] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-51.json
[2022-01-24 03:45:55,226] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-16.json
[2022-01-24 03:45:55,226] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-4.json
[2022-01-24 03:45:55,227] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-62.json
[2022-01-24 03:45:55,227] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-68.json
[2022-01-24 03:45:55,227] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-78.json
[2022-01-24 03:45:55,227] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-33.json
[2022-01-24 03:45:55,227] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-41.json
[2022-01-24 03:45:55,227] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-69.json
[2022-01-24 03:45:55,227] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-0.json
[2022-01-24 03:45:55,227] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-21.json
[2022-01-24 03:45:55,227] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-47.json
[2022-01-24 03:45:55,227] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-9.json
[2022-01-24 03:45:55,227] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-80.json
[2022-01-24 03:45:55,227] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-70.json
[2022-01-24 03:45:55,227] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-6.json
[2022-01-24 03:45:55,228] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-66.json
[2022-01-24 03:45:55,228] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-43.json
[2022-01-24 03:45:55,228] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-46.json
[2022-01-24 03:45:55,228] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-25.json
[2022-01-24 03:45:55,228] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-17.json
[2022-01-24 03:45:55,228] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-35.json
[2022-01-24 03:45:55,228] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-22.json
[2022-01-24 03:45:55,228] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-15.json
[2022-01-24 03:45:55,228] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-53.json
[2022-01-24 03:45:55,228] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-14.json
[2022-01-24 03:45:55,228] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-1.json
[2022-01-24 03:45:55,228] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-72.json
[2022-01-24 03:45:55,228] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-64.json
[2022-01-24 03:45:55,229] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-28.json
[2022-01-24 03:45:55,229] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-12.json
[2022-01-24 03:45:55,229] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-20.json
[2022-01-24 03:45:55,229] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-61.json
[2022-01-24 03:45:55,229] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-56.json
[2022-01-24 03:45:55,229] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-42.json
[2022-01-24 03:45:55,229] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-50.json
[2022-01-24 03:45:55,229] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-58.json
[2022-01-24 03:45:55,229] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-77.json
[2022-01-24 03:45:55,229] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-52.json
[2022-01-24 03:45:55,230] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-79.json
[2022-01-24 03:45:55,230] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-36.json
[2022-01-24 03:45:55,230] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-24.json
[2022-01-24 03:45:55,230] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-23.json
[2022-01-24 03:45:55,230] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-81.json
[2022-01-24 03:45:55,230] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-37.json
[2022-01-24 03:45:55,230] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-74.json
[2022-01-24 03:45:55,230] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-48.json
[2022-01-24 03:45:55,230] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-57.json
[2022-01-24 03:45:55,230] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-34.json
[2022-01-24 03:45:55,231] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-32.json
[2022-01-24 03:45:55,231] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-63.json
[2022-01-24 03:45:55,231] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-5.json
[2022-01-24 03:45:55,231] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-84.json
[2022-01-24 03:45:55,231] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-73.json
[2022-01-24 03:45:55,231] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-30.json
[2022-01-24 03:45:55,231] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-10.json
[2022-01-24 03:45:55,231] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-29.json
[2022-01-24 03:45:55,231] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-38.json
[2022-01-24 03:45:55,232] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-44.json
[2022-01-24 03:45:55,232] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-31.json
[2022-01-24 03:45:55,232] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-11.json
[2022-01-24 03:45:55,232] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-67.json
[2022-01-24 03:45:55,232] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-26.json
[2022-01-24 03:45:55,232] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-82.json
[2022-01-24 03:45:55,232] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-76.json
[2022-01-24 03:45:55,232] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-55.json
[2022-01-24 03:45:55,234] {logging_mixin.py:109} INFO - 85
[2022-01-24 03:45:55,249] {logging_mixin.py:109} INFO -      invoice_id    invoice_timestamp  customer_id  ...  qty is_discount       price
0   20220103-11  2022-01-03T19:59:51  yyymlnv2864  ...  256           0   8988.1600
1   20220103-26  2022-01-03T03:36:28  yadoags1019  ...  131           1   6461.0510
2   20220103-53  2022-01-03T15:35:24  tikvtot4348  ...  297           0   2981.8800
3    20220103-5  2022-01-03T14:07:09  mjbhujn4102  ...   41           1    275.7988
4   20220103-15  2022-01-03T09:55:41  aecqtdi3986  ...   40           1   2338.8400
..          ...                  ...          ...  ...  ...         ...         ...
80   20220103-7  2022-01-03T22:54:32  codpbua4340  ...  234           1  11880.0864
81  20220103-32  2022-01-03T14:27:34  sexnidd1428  ...  249           1   1405.0821
82  20220103-83  2022-01-03T09:31:32  yyymlnv2864  ...   55           1   1197.2510
83  20220103-78  2022-01-03T19:54:44  sexnidd1428  ...  208           0   7302.8800
84  20220103-59  2022-01-03T13:13:44  dludxgk4225  ...  209           0  18837.1700

[85 rows x 8 columns]
[2022-01-24 03:45:55,256] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: sales_dw, Login: ***, Password: ***, extra: {}
[2022-01-24 03:45:55,261] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: sales_dw, Login: ***, Password: ***, extra: {}
[2022-01-24 03:45:55,861] {taskinstance.py:1700} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 2336, in _wrap_pool_connect
    return fn()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 364, in connect
    return _ConnectionFairy._checkout(self)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 778, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 495, in checkout
    rec = pool._do_get()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/impl.py", line 140, in _do_get
    self._dec_overflow()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    with_traceback=exc_tb,
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 182, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/impl.py", line 137, in _do_get
    return self._create_connection()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 309, in _create_connection
    return _ConnectionRecord(self)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 440, in __init__
    self.__connect(first_connect_check=True)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 661, in __connect
    pool.logger.debug("Error on connect(): %s", e)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    with_traceback=exc_tb,
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 182, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 656, in __connect
    connection = pool._invoke_creator(self)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/strategies.py", line 114, in connect
    return dialect.connect(*cargs, **cparams)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/default.py", line 508, in connect
    return self.dbapi.connect(*cargs, **cparams)
  File "/home/airflow/.local/lib/python3.7/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
psycopg2.OperationalError: connection to server at "tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com" (3.132.179.48), port 5439 failed: FATAL:  password authentication failed for user "***"
connection to server at "tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com" (3.132.179.48), port 5439 failed: FATAL:  password authentication failed for user "***"


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1329, in _run_raw_task
    self._execute_task_with_callbacks(context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1455, in _execute_task_with_callbacks
    result = self._execute_task(context, self.task)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1511, in _execute_task
    result = execute_callable(context=context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 174, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 185, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/datawarehouse_airflow.py", line 57, in load_invoices
    invoice_df.to_sql('invoice_stagging', redshift_hook.get_sqlalchemy_engine(), if_exists='replace', index=False)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/core/generic.py", line 2882, in to_sql
    method=method,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 728, in to_sql
    **engine_kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1758, in to_sql
    dtype=dtype,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1650, in prep_table
    table.create()
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 856, in create
    if self.exists():
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 840, in exists
    return self.pd_sql.has_table(self.name, self.schema)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1787, in has_table
    self.connectable.dialect.has_table, name, schema or self.meta.schema
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 2211, in run_callable
    with self._contextual_connect() as conn:
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 2302, in _contextual_connect
    self._wrap_pool_connect(self.pool.connect, None),
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 2340, in _wrap_pool_connect
    e, dialect, self
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1584, in _handle_dbapi_exception_noconnection
    sqlalchemy_exception, with_traceback=exc_info[2], from_=e
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 182, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 2336, in _wrap_pool_connect
    return fn()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 364, in connect
    return _ConnectionFairy._checkout(self)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 778, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 495, in checkout
    rec = pool._do_get()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/impl.py", line 140, in _do_get
    self._dec_overflow()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    with_traceback=exc_tb,
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 182, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/impl.py", line 137, in _do_get
    return self._create_connection()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 309, in _create_connection
    return _ConnectionRecord(self)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 440, in __init__
    self.__connect(first_connect_check=True)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 661, in __connect
    pool.logger.debug("Error on connect(): %s", e)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    with_traceback=exc_tb,
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 182, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 656, in __connect
    connection = pool._invoke_creator(self)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/strategies.py", line 114, in connect
    return dialect.connect(*cargs, **cparams)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/default.py", line 508, in connect
    return self.dbapi.connect(*cargs, **cparams)
  File "/home/airflow/.local/lib/python3.7/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com" (3.132.179.48), port 5439 failed: FATAL:  password authentication failed for user "***"
connection to server at "tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com" (3.132.179.48), port 5439 failed: FATAL:  password authentication failed for user "***"

(Background on this error at: http://sqlalche.me/e/13/e3q8)
[2022-01-24 03:45:55,874] {taskinstance.py:1277} INFO - Marking task as FAILED. dag_id=datawarehouse_etl, task_id=load_invoices, execution_date=20220103T000000, start_date=20220124T034555, end_date=20220124T034555
[2022-01-24 03:45:55,886] {standard_task_runner.py:92} ERROR - Failed to execute job 64 for task load_invoices
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 2336, in _wrap_pool_connect
    return fn()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 364, in connect
    return _ConnectionFairy._checkout(self)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 778, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 495, in checkout
    rec = pool._do_get()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/impl.py", line 140, in _do_get
    self._dec_overflow()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    with_traceback=exc_tb,
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 182, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/impl.py", line 137, in _do_get
    return self._create_connection()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 309, in _create_connection
    return _ConnectionRecord(self)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 440, in __init__
    self.__connect(first_connect_check=True)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 661, in __connect
    pool.logger.debug("Error on connect(): %s", e)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    with_traceback=exc_tb,
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 182, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 656, in __connect
    connection = pool._invoke_creator(self)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/strategies.py", line 114, in connect
    return dialect.connect(*cargs, **cparams)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/default.py", line 508, in connect
    return self.dbapi.connect(*cargs, **cparams)
  File "/home/airflow/.local/lib/python3.7/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
psycopg2.OperationalError: connection to server at "tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com" (3.132.179.48), port 5439 failed: FATAL:  password authentication failed for user "***"
connection to server at "tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com" (3.132.179.48), port 5439 failed: FATAL:  password authentication failed for user "***"


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/task/task_runner/standard_task_runner.py", line 85, in _start_by_fork
    args.func(args, dag=self.dag)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/cli_parser.py", line 48, in command
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/cli.py", line 92, in wrapper
    return f(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/commands/task_command.py", line 298, in task_run
    _run_task_by_selected_method(args, dag, ti)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/commands/task_command.py", line 107, in _run_task_by_selected_method
    _run_raw_task(args, ti)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/commands/task_command.py", line 184, in _run_raw_task
    error_file=args.error_file,
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/session.py", line 70, in wrapper
    return func(*args, session=session, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1329, in _run_raw_task
    self._execute_task_with_callbacks(context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1455, in _execute_task_with_callbacks
    result = self._execute_task(context, self.task)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1511, in _execute_task
    result = execute_callable(context=context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 174, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 185, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/datawarehouse_airflow.py", line 57, in load_invoices
    invoice_df.to_sql('invoice_stagging', redshift_hook.get_sqlalchemy_engine(), if_exists='replace', index=False)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/core/generic.py", line 2882, in to_sql
    method=method,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 728, in to_sql
    **engine_kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1758, in to_sql
    dtype=dtype,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1650, in prep_table
    table.create()
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 856, in create
    if self.exists():
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 840, in exists
    return self.pd_sql.has_table(self.name, self.schema)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1787, in has_table
    self.connectable.dialect.has_table, name, schema or self.meta.schema
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 2211, in run_callable
    with self._contextual_connect() as conn:
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 2302, in _contextual_connect
    self._wrap_pool_connect(self.pool.connect, None),
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 2340, in _wrap_pool_connect
    e, dialect, self
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1584, in _handle_dbapi_exception_noconnection
    sqlalchemy_exception, with_traceback=exc_info[2], from_=e
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 182, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 2336, in _wrap_pool_connect
    return fn()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 364, in connect
    return _ConnectionFairy._checkout(self)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 778, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 495, in checkout
    rec = pool._do_get()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/impl.py", line 140, in _do_get
    self._dec_overflow()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    with_traceback=exc_tb,
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 182, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/impl.py", line 137, in _do_get
    return self._create_connection()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 309, in _create_connection
    return _ConnectionRecord(self)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 440, in __init__
    self.__connect(first_connect_check=True)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 661, in __connect
    pool.logger.debug("Error on connect(): %s", e)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    with_traceback=exc_tb,
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 182, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 656, in __connect
    connection = pool._invoke_creator(self)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/strategies.py", line 114, in connect
    return dialect.connect(*cargs, **cparams)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/default.py", line 508, in connect
    return self.dbapi.connect(*cargs, **cparams)
  File "/home/airflow/.local/lib/python3.7/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com" (3.132.179.48), port 5439 failed: FATAL:  password authentication failed for user "***"
connection to server at "tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com" (3.132.179.48), port 5439 failed: FATAL:  password authentication failed for user "***"

(Background on this error at: http://sqlalche.me/e/13/e3q8)
[2022-01-24 03:45:55,916] {local_task_job.py:154} INFO - Task exited with return code 1
[2022-01-24 03:45:55,947] {local_task_job.py:264} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-01-24 03:47:58,127] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [queued]>
[2022-01-24 03:47:58,137] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [queued]>
[2022-01-24 03:47:58,138] {taskinstance.py:1238} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 03:47:58,138] {taskinstance.py:1239} INFO - Starting attempt 1 of 1
[2022-01-24 03:47:58,138] {taskinstance.py:1240} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 03:47:58,148] {taskinstance.py:1259} INFO - Executing <Task(PythonOperator): load_invoices> on 2022-01-03 00:00:00+00:00
[2022-01-24 03:47:58,152] {standard_task_runner.py:52} INFO - Started process 5848 to run task
[2022-01-24 03:47:58,155] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'datawarehouse_etl', 'load_invoices', 'scheduled__2022-01-03T00:00:00+00:00', '--job-id', '66', '--raw', '--subdir', 'DAGS_FOLDER/datawarehouse_***.py', '--cfg-path', '/tmp/tmpuec7brph', '--error-file', '/tmp/tmprkhcwmnw']
[2022-01-24 03:47:58,156] {standard_task_runner.py:77} INFO - Job 66: Subtask load_invoices
[2022-01-24 03:47:58,202] {logging_mixin.py:109} INFO - Running <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [running]> on host cd9bb47288d1
[2022-01-24 03:47:58,253] {taskinstance.py:1426} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=datawarehouse_etl
AIRFLOW_CTX_TASK_ID=load_invoices
AIRFLOW_CTX_EXECUTION_DATE=2022-01-03T00:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-01-03T00:00:00+00:00
[2022-01-24 03:47:58,256] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:47:58,256] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:47:58,256] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds_nodash' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds_nodash }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:47:58,256] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_end' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:47:58,256] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:47:58,256] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:47:58,257] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:47:58,257] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date_success' from the template is deprecated and will be removed in a future version. Please use 'prev_data_interval_start_success' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:47:58,257] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:47:58,257] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:47:58,257] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:47:58,257] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:47:58,257] {logging_mixin.py:109} INFO - {'conf': <***.configuration.AirflowConfigParser object at 0x7f1e4dfc6a10>, 'dag': <DAG: datawarehouse_etl>, 'dag_run': <DagRun datawarehouse_etl @ 2022-01-03 00:00:00+00:00: scheduled__2022-01-03T00:00:00+00:00, externally triggered: False>, 'data_interval_end': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'data_interval_start': DateTime(2022, 1, 3, 0, 0, 0, tzinfo=Timezone('UTC')), 'ds': '2022-01-03', 'ds_nodash': '20220103', 'execution_date': DateTime(2022, 1, 3, 0, 0, 0, tzinfo=Timezone('UTC')), 'inlets': [], 'logical_date': DateTime(2022, 1, 3, 0, 0, 0, tzinfo=Timezone('UTC')), 'macros': <module '***.macros' from '/home/***/.local/lib/python3.7/site-packages/***/macros/__init__.py'>, 'next_ds': '2022-01-04', 'next_ds_nodash': '20220104', 'next_execution_date': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'outlets': [], 'params': {}, 'prev_data_interval_start_success': DateTime(2022, 1, 2, 0, 0, 0, tzinfo=Timezone('UTC')), 'prev_data_interval_end_success': DateTime(2022, 1, 3, 0, 0, 0, tzinfo=Timezone('UTC')), 'prev_ds': '2022-01-02', 'prev_ds_nodash': '20220102', 'prev_execution_date': datetime.datetime(2022, 1, 2, 0, 0, tzinfo=Timezone('UTC')), 'prev_execution_date_success': DateTime(2022, 1, 2, 0, 0, 0, tzinfo=Timezone('UTC')), 'prev_start_date_success': DateTime(2022, 1, 24, 3, 47, 26, 838497, tzinfo=Timezone('UTC')), 'run_id': 'scheduled__2022-01-03T00:00:00+00:00', 'task': <Task(PythonOperator): load_invoices>, 'task_instance': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [running]>, 'task_instance_key_str': 'datawarehouse_etl__load_invoices__20220103', 'test_mode': False, 'ti': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [running]>, 'tomorrow_ds': '2022-01-04', 'tomorrow_ds_nodash': '20220104', 'ts': '2022-01-03T00:00:00+00:00', 'ts_nodash': '20220103T000000', 'ts_nodash_with_tz': '20220103T000000+0000', 'var': {'json': None, 'value': None}, 'conn': None, 'yesterday_ds': '2022-01-02', 'yesterday_ds_nodash': '20220102', 'key': 'value', 'ts_var': '2022-01-03T00:00:00+00:00', 'tsnodash_var': '20220103T000000', 'templates_dict': None}
[2022-01-24 03:47:58,258] {logging_mixin.py:109} INFO - ts:  2022-01-03 00:00:00+00:00
[2022-01-24 03:47:58,258] {logging_mixin.py:109} INFO - <class 'pandas._libs.tslibs.timestamps.Timestamp'>
[2022-01-24 03:47:58,258] {logging_mixin.py:109} INFO - Object created.
[2022-01-24 03:47:58,258] {logging_mixin.py:109} INFO - 2022 1 3
[2022-01-24 03:47:58,259] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-3.json
[2022-01-24 03:47:58,259] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-19.json
[2022-01-24 03:47:58,259] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-49.json
[2022-01-24 03:47:58,259] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-45.json
[2022-01-24 03:47:58,259] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-7.json
[2022-01-24 03:47:58,259] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-54.json
[2022-01-24 03:47:58,260] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-75.json
[2022-01-24 03:47:58,260] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-60.json
[2022-01-24 03:47:58,260] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-83.json
[2022-01-24 03:47:58,260] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-13.json
[2022-01-24 03:47:58,260] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-2.json
[2022-01-24 03:47:58,260] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-59.json
[2022-01-24 03:47:58,260] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-71.json
[2022-01-24 03:47:58,260] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-8.json
[2022-01-24 03:47:58,260] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-40.json
[2022-01-24 03:47:58,260] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-39.json
[2022-01-24 03:47:58,260] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-65.json
[2022-01-24 03:47:58,260] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-18.json
[2022-01-24 03:47:58,261] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-27.json
[2022-01-24 03:47:58,261] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-51.json
[2022-01-24 03:47:58,261] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-16.json
[2022-01-24 03:47:58,261] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-4.json
[2022-01-24 03:47:58,261] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-62.json
[2022-01-24 03:47:58,261] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-68.json
[2022-01-24 03:47:58,261] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-78.json
[2022-01-24 03:47:58,261] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-33.json
[2022-01-24 03:47:58,261] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-41.json
[2022-01-24 03:47:58,261] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-69.json
[2022-01-24 03:47:58,261] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-0.json
[2022-01-24 03:47:58,262] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-21.json
[2022-01-24 03:47:58,262] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-47.json
[2022-01-24 03:47:58,262] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-9.json
[2022-01-24 03:47:58,262] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-80.json
[2022-01-24 03:47:58,262] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-70.json
[2022-01-24 03:47:58,262] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-6.json
[2022-01-24 03:47:58,262] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-66.json
[2022-01-24 03:47:58,262] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-43.json
[2022-01-24 03:47:58,262] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-46.json
[2022-01-24 03:47:58,263] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-25.json
[2022-01-24 03:47:58,263] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-17.json
[2022-01-24 03:47:58,263] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-35.json
[2022-01-24 03:47:58,263] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-22.json
[2022-01-24 03:47:58,263] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-15.json
[2022-01-24 03:47:58,264] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-53.json
[2022-01-24 03:47:58,264] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-14.json
[2022-01-24 03:47:58,264] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-1.json
[2022-01-24 03:47:58,264] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-72.json
[2022-01-24 03:47:58,264] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-64.json
[2022-01-24 03:47:58,264] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-28.json
[2022-01-24 03:47:58,264] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-12.json
[2022-01-24 03:47:58,264] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-20.json
[2022-01-24 03:47:58,264] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-61.json
[2022-01-24 03:47:58,264] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-56.json
[2022-01-24 03:47:58,264] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-42.json
[2022-01-24 03:47:58,265] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-50.json
[2022-01-24 03:47:58,265] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-58.json
[2022-01-24 03:47:58,265] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-77.json
[2022-01-24 03:47:58,265] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-52.json
[2022-01-24 03:47:58,265] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-79.json
[2022-01-24 03:47:58,265] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-36.json
[2022-01-24 03:47:58,265] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-24.json
[2022-01-24 03:47:58,265] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-23.json
[2022-01-24 03:47:58,266] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-81.json
[2022-01-24 03:47:58,266] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-37.json
[2022-01-24 03:47:58,266] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-74.json
[2022-01-24 03:47:58,266] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-48.json
[2022-01-24 03:47:58,267] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-57.json
[2022-01-24 03:47:58,267] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-34.json
[2022-01-24 03:47:58,267] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-32.json
[2022-01-24 03:47:58,267] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-63.json
[2022-01-24 03:47:58,267] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-5.json
[2022-01-24 03:47:58,267] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-84.json
[2022-01-24 03:47:58,267] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-73.json
[2022-01-24 03:47:58,267] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-30.json
[2022-01-24 03:47:58,267] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-10.json
[2022-01-24 03:47:58,267] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-29.json
[2022-01-24 03:47:58,267] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-38.json
[2022-01-24 03:47:58,268] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-44.json
[2022-01-24 03:47:58,268] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-31.json
[2022-01-24 03:47:58,268] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-11.json
[2022-01-24 03:47:58,268] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-67.json
[2022-01-24 03:47:58,268] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-26.json
[2022-01-24 03:47:58,268] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-82.json
[2022-01-24 03:47:58,268] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-76.json
[2022-01-24 03:47:58,268] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-55.json
[2022-01-24 03:47:58,270] {logging_mixin.py:109} INFO - 85
[2022-01-24 03:47:58,284] {logging_mixin.py:109} INFO -      invoice_id    invoice_timestamp  customer_id  ...  qty is_discount       price
0   20220103-11  2022-01-03T19:59:51  yyymlnv2864  ...  256           0   8988.1600
1   20220103-26  2022-01-03T03:36:28  yadoags1019  ...  131           1   6461.0510
2   20220103-53  2022-01-03T15:35:24  tikvtot4348  ...  297           0   2981.8800
3    20220103-5  2022-01-03T14:07:09  mjbhujn4102  ...   41           1    275.7988
4   20220103-15  2022-01-03T09:55:41  aecqtdi3986  ...   40           1   2338.8400
..          ...                  ...          ...  ...  ...         ...         ...
80   20220103-7  2022-01-03T22:54:32  codpbua4340  ...  234           1  11880.0864
81  20220103-32  2022-01-03T14:27:34  sexnidd1428  ...  249           1   1405.0821
82  20220103-83  2022-01-03T09:31:32  yyymlnv2864  ...   55           1   1197.2510
83  20220103-78  2022-01-03T19:54:44  sexnidd1428  ...  208           0   7302.8800
84  20220103-59  2022-01-03T13:13:44  dludxgk4225  ...  209           0  18837.1700

[85 rows x 8 columns]
[2022-01-24 03:47:58,292] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: sales_dw, Login: awsuser, Password: ***, extra: {}
[2022-01-24 03:47:58,297] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: sales_dw, Login: awsuser, Password: ***, extra: {}
[2022-01-24 03:48:08,871] {python.py:175} INFO - Done. Returned value was: None
[2022-01-24 03:48:08,880] {taskinstance.py:1277} INFO - Marking task as SUCCESS. dag_id=datawarehouse_etl, task_id=load_invoices, execution_date=20220103T000000, start_date=20220124T034758, end_date=20220124T034808
[2022-01-24 03:48:08,931] {local_task_job.py:154} INFO - Task exited with return code 0
[2022-01-24 03:48:08,955] {local_task_job.py:264} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2022-01-24 03:52:29,869] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [queued]>
[2022-01-24 03:52:29,876] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [queued]>
[2022-01-24 03:52:29,877] {taskinstance.py:1238} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 03:52:29,877] {taskinstance.py:1239} INFO - Starting attempt 1 of 1
[2022-01-24 03:52:29,877] {taskinstance.py:1240} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 03:52:29,886] {taskinstance.py:1259} INFO - Executing <Task(PythonOperator): load_invoices> on 2022-01-03 00:00:00+00:00
[2022-01-24 03:52:29,890] {standard_task_runner.py:52} INFO - Started process 6061 to run task
[2022-01-24 03:52:29,893] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'datawarehouse_etl', 'load_invoices', 'scheduled__2022-01-03T00:00:00+00:00', '--job-id', '69', '--raw', '--subdir', 'DAGS_FOLDER/datawarehouse_***.py', '--cfg-path', '/tmp/tmpg8pye3q6', '--error-file', '/tmp/tmpsa99cgz9']
[2022-01-24 03:52:29,893] {standard_task_runner.py:77} INFO - Job 69: Subtask load_invoices
[2022-01-24 03:52:29,938] {logging_mixin.py:109} INFO - Running <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [running]> on host cd9bb47288d1
[2022-01-24 03:52:29,995] {taskinstance.py:1426} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=datawarehouse_etl
AIRFLOW_CTX_TASK_ID=load_invoices
AIRFLOW_CTX_EXECUTION_DATE=2022-01-03T00:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-01-03T00:00:00+00:00
[2022-01-24 03:52:29,997] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:52:29,998] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:52:29,998] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds_nodash' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds_nodash }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:52:29,998] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_end' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:52:29,998] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:52:29,998] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:52:29,998] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:52:29,998] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date_success' from the template is deprecated and will be removed in a future version. Please use 'prev_data_interval_start_success' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:52:29,998] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:52:29,998] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:52:29,999] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:52:29,999] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:52:29,999] {logging_mixin.py:109} INFO - {'conf': <***.configuration.AirflowConfigParser object at 0x7f1e4dfc6a10>, 'dag': <DAG: datawarehouse_etl>, 'dag_run': <DagRun datawarehouse_etl @ 2022-01-03 00:00:00+00:00: scheduled__2022-01-03T00:00:00+00:00, externally triggered: False>, 'data_interval_end': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'data_interval_start': DateTime(2022, 1, 3, 0, 0, 0, tzinfo=Timezone('UTC')), 'ds': '2022-01-03', 'ds_nodash': '20220103', 'execution_date': DateTime(2022, 1, 3, 0, 0, 0, tzinfo=Timezone('UTC')), 'inlets': [], 'logical_date': DateTime(2022, 1, 3, 0, 0, 0, tzinfo=Timezone('UTC')), 'macros': <module '***.macros' from '/home/***/.local/lib/python3.7/site-packages/***/macros/__init__.py'>, 'next_ds': '2022-01-04', 'next_ds_nodash': '20220104', 'next_execution_date': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'outlets': [], 'params': {}, 'prev_data_interval_start_success': None, 'prev_data_interval_end_success': None, 'prev_ds': '2022-01-02', 'prev_ds_nodash': '20220102', 'prev_execution_date': datetime.datetime(2022, 1, 2, 0, 0, tzinfo=Timezone('UTC')), 'prev_execution_date_success': None, 'prev_start_date_success': None, 'run_id': 'scheduled__2022-01-03T00:00:00+00:00', 'task': <Task(PythonOperator): load_invoices>, 'task_instance': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [running]>, 'task_instance_key_str': 'datawarehouse_etl__load_invoices__20220103', 'test_mode': False, 'ti': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [running]>, 'tomorrow_ds': '2022-01-04', 'tomorrow_ds_nodash': '20220104', 'ts': '2022-01-03T00:00:00+00:00', 'ts_nodash': '20220103T000000', 'ts_nodash_with_tz': '20220103T000000+0000', 'var': {'json': None, 'value': None}, 'conn': None, 'yesterday_ds': '2022-01-02', 'yesterday_ds_nodash': '20220102', 'key': 'value', 'ts_var': '2022-01-03T00:00:00+00:00', 'tsnodash_var': '20220103T000000', 'templates_dict': None}
[2022-01-24 03:52:30,001] {logging_mixin.py:109} INFO - ts:  2022-01-03 00:00:00+00:00
[2022-01-24 03:52:30,002] {logging_mixin.py:109} INFO - <class 'pandas._libs.tslibs.timestamps.Timestamp'>
[2022-01-24 03:52:30,002] {logging_mixin.py:109} INFO - Object created.
[2022-01-24 03:52:30,002] {logging_mixin.py:109} INFO - 2022 1 3
[2022-01-24 03:52:30,003] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-3.json
[2022-01-24 03:52:30,003] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-19.json
[2022-01-24 03:52:30,003] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-49.json
[2022-01-24 03:52:30,003] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-45.json
[2022-01-24 03:52:30,004] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-7.json
[2022-01-24 03:52:30,004] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-54.json
[2022-01-24 03:52:30,004] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-75.json
[2022-01-24 03:52:30,004] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-60.json
[2022-01-24 03:52:30,004] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-83.json
[2022-01-24 03:52:30,004] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-13.json
[2022-01-24 03:52:30,004] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-2.json
[2022-01-24 03:52:30,004] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-59.json
[2022-01-24 03:52:30,005] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-71.json
[2022-01-24 03:52:30,005] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-8.json
[2022-01-24 03:52:30,005] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-40.json
[2022-01-24 03:52:30,005] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-39.json
[2022-01-24 03:52:30,005] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-65.json
[2022-01-24 03:52:30,005] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-18.json
[2022-01-24 03:52:30,006] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-27.json
[2022-01-24 03:52:30,006] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-51.json
[2022-01-24 03:52:30,006] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-16.json
[2022-01-24 03:52:30,006] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-4.json
[2022-01-24 03:52:30,006] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-62.json
[2022-01-24 03:52:30,006] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-68.json
[2022-01-24 03:52:30,006] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-78.json
[2022-01-24 03:52:30,006] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-33.json
[2022-01-24 03:52:30,007] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-41.json
[2022-01-24 03:52:30,007] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-69.json
[2022-01-24 03:52:30,007] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-0.json
[2022-01-24 03:52:30,007] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-21.json
[2022-01-24 03:52:30,007] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-47.json
[2022-01-24 03:52:30,007] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-9.json
[2022-01-24 03:52:30,007] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-80.json
[2022-01-24 03:52:30,007] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-70.json
[2022-01-24 03:52:30,007] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-6.json
[2022-01-24 03:52:30,007] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-66.json
[2022-01-24 03:52:30,007] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-43.json
[2022-01-24 03:52:30,008] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-46.json
[2022-01-24 03:52:30,008] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-25.json
[2022-01-24 03:52:30,008] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-17.json
[2022-01-24 03:52:30,008] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-35.json
[2022-01-24 03:52:30,008] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-22.json
[2022-01-24 03:52:30,008] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-15.json
[2022-01-24 03:52:30,008] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-53.json
[2022-01-24 03:52:30,008] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-14.json
[2022-01-24 03:52:30,008] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-1.json
[2022-01-24 03:52:30,008] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-72.json
[2022-01-24 03:52:30,008] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-64.json
[2022-01-24 03:52:30,008] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-28.json
[2022-01-24 03:52:30,009] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-12.json
[2022-01-24 03:52:30,009] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-20.json
[2022-01-24 03:52:30,009] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-61.json
[2022-01-24 03:52:30,009] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-56.json
[2022-01-24 03:52:30,009] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-42.json
[2022-01-24 03:52:30,009] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-50.json
[2022-01-24 03:52:30,009] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-58.json
[2022-01-24 03:52:30,009] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-77.json
[2022-01-24 03:52:30,009] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-52.json
[2022-01-24 03:52:30,009] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-79.json
[2022-01-24 03:52:30,009] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-36.json
[2022-01-24 03:52:30,009] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-24.json
[2022-01-24 03:52:30,009] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-23.json
[2022-01-24 03:52:30,010] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-81.json
[2022-01-24 03:52:30,010] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-37.json
[2022-01-24 03:52:30,010] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-74.json
[2022-01-24 03:52:30,010] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-48.json
[2022-01-24 03:52:30,010] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-57.json
[2022-01-24 03:52:30,010] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-34.json
[2022-01-24 03:52:30,010] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-32.json
[2022-01-24 03:52:30,010] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-63.json
[2022-01-24 03:52:30,010] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-5.json
[2022-01-24 03:52:30,010] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-84.json
[2022-01-24 03:52:30,010] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-73.json
[2022-01-24 03:52:30,010] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-30.json
[2022-01-24 03:52:30,010] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-10.json
[2022-01-24 03:52:30,011] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-29.json
[2022-01-24 03:52:30,011] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-38.json
[2022-01-24 03:52:30,011] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-44.json
[2022-01-24 03:52:30,011] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-31.json
[2022-01-24 03:52:30,011] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-11.json
[2022-01-24 03:52:30,011] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-67.json
[2022-01-24 03:52:30,011] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-26.json
[2022-01-24 03:52:30,011] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-82.json
[2022-01-24 03:52:30,011] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-76.json
[2022-01-24 03:52:30,011] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-55.json
[2022-01-24 03:52:30,013] {logging_mixin.py:109} INFO - 85
[2022-01-24 03:52:30,030] {logging_mixin.py:109} INFO -      invoice_id    invoice_timestamp  customer_id  ...  qty is_discount       price
0   20220103-11  2022-01-03T19:59:51  yyymlnv2864  ...  256           0   8988.1600
1   20220103-26  2022-01-03T03:36:28  yadoags1019  ...  131           1   6461.0510
2   20220103-53  2022-01-03T15:35:24  tikvtot4348  ...  297           0   2981.8800
3    20220103-5  2022-01-03T14:07:09  mjbhujn4102  ...   41           1    275.7988
4   20220103-15  2022-01-03T09:55:41  aecqtdi3986  ...   40           1   2338.8400
..          ...                  ...          ...  ...  ...         ...         ...
80   20220103-7  2022-01-03T22:54:32  codpbua4340  ...  234           1  11880.0864
81  20220103-32  2022-01-03T14:27:34  sexnidd1428  ...  249           1   1405.0821
82  20220103-83  2022-01-03T09:31:32  yyymlnv2864  ...   55           1   1197.2510
83  20220103-78  2022-01-03T19:54:44  sexnidd1428  ...  208           0   7302.8800
84  20220103-59  2022-01-03T13:13:44  dludxgk4225  ...  209           0  18837.1700

[85 rows x 8 columns]
[2022-01-24 03:52:30,043] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: sales_dw, Login: awsuser, Password: ***, extra: {}
[2022-01-24 03:52:30,049] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: sales_dw, Login: awsuser, Password: ***, extra: {}
[2022-01-24 03:52:42,925] {python.py:175} INFO - Done. Returned value was: None
[2022-01-24 03:52:42,943] {taskinstance.py:1277} INFO - Marking task as SUCCESS. dag_id=datawarehouse_etl, task_id=load_invoices, execution_date=20220103T000000, start_date=20220124T035229, end_date=20220124T035242
[2022-01-24 03:52:43,014] {local_task_job.py:154} INFO - Task exited with return code 0
[2022-01-24 03:52:43,041] {local_task_job.py:264} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2022-01-24 03:55:40,006] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [queued]>
[2022-01-24 03:55:40,026] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [queued]>
[2022-01-24 03:55:40,026] {taskinstance.py:1238} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 03:55:40,026] {taskinstance.py:1239} INFO - Starting attempt 1 of 1
[2022-01-24 03:55:40,026] {taskinstance.py:1240} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 03:55:40,047] {taskinstance.py:1259} INFO - Executing <Task(PythonOperator): load_invoices> on 2022-01-03 00:00:00+00:00
[2022-01-24 03:55:40,057] {standard_task_runner.py:52} INFO - Started process 6222 to run task
[2022-01-24 03:55:40,064] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'datawarehouse_etl', 'load_invoices', 'scheduled__2022-01-03T00:00:00+00:00', '--job-id', '72', '--raw', '--subdir', 'DAGS_FOLDER/datawarehouse_***.py', '--cfg-path', '/tmp/tmpr6xw0cxf', '--error-file', '/tmp/tmp_e_eov90']
[2022-01-24 03:55:40,066] {standard_task_runner.py:77} INFO - Job 72: Subtask load_invoices
[2022-01-24 03:55:40,150] {logging_mixin.py:109} INFO - Running <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [running]> on host cd9bb47288d1
[2022-01-24 03:55:40,211] {taskinstance.py:1426} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=datawarehouse_etl
AIRFLOW_CTX_TASK_ID=load_invoices
AIRFLOW_CTX_EXECUTION_DATE=2022-01-03T00:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-01-03T00:00:00+00:00
[2022-01-24 03:55:40,213] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:55:40,213] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:55:40,214] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds_nodash' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds_nodash }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:55:40,214] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_end' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:55:40,214] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:55:40,214] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:55:40,214] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:55:40,214] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date_success' from the template is deprecated and will be removed in a future version. Please use 'prev_data_interval_start_success' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:55:40,215] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:55:40,215] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:55:40,215] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:55:40,215] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:55:40,215] {logging_mixin.py:109} INFO - {'conf': <***.configuration.AirflowConfigParser object at 0x7f1e4dfc6a10>, 'dag': <DAG: datawarehouse_etl>, 'dag_run': <DagRun datawarehouse_etl @ 2022-01-03 00:00:00+00:00: scheduled__2022-01-03T00:00:00+00:00, externally triggered: False>, 'data_interval_end': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'data_interval_start': DateTime(2022, 1, 3, 0, 0, 0, tzinfo=Timezone('UTC')), 'ds': '2022-01-03', 'ds_nodash': '20220103', 'execution_date': DateTime(2022, 1, 3, 0, 0, 0, tzinfo=Timezone('UTC')), 'inlets': [], 'logical_date': DateTime(2022, 1, 3, 0, 0, 0, tzinfo=Timezone('UTC')), 'macros': <module '***.macros' from '/home/***/.local/lib/python3.7/site-packages/***/macros/__init__.py'>, 'next_ds': '2022-01-04', 'next_ds_nodash': '20220104', 'next_execution_date': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'outlets': [], 'params': {}, 'prev_data_interval_start_success': None, 'prev_data_interval_end_success': None, 'prev_ds': '2022-01-02', 'prev_ds_nodash': '20220102', 'prev_execution_date': datetime.datetime(2022, 1, 2, 0, 0, tzinfo=Timezone('UTC')), 'prev_execution_date_success': None, 'prev_start_date_success': None, 'run_id': 'scheduled__2022-01-03T00:00:00+00:00', 'task': <Task(PythonOperator): load_invoices>, 'task_instance': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [running]>, 'task_instance_key_str': 'datawarehouse_etl__load_invoices__20220103', 'test_mode': False, 'ti': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [running]>, 'tomorrow_ds': '2022-01-04', 'tomorrow_ds_nodash': '20220104', 'ts': '2022-01-03T00:00:00+00:00', 'ts_nodash': '20220103T000000', 'ts_nodash_with_tz': '20220103T000000+0000', 'var': {'json': None, 'value': None}, 'conn': None, 'yesterday_ds': '2022-01-02', 'yesterday_ds_nodash': '20220102', 'key': 'value', 'ts_var': '2022-01-03T00:00:00+00:00', 'tsnodash_var': '20220103T000000', 'templates_dict': None}
[2022-01-24 03:55:40,217] {logging_mixin.py:109} INFO - ts:  2022-01-03 00:00:00+00:00
[2022-01-24 03:55:40,217] {logging_mixin.py:109} INFO - <class 'pandas._libs.tslibs.timestamps.Timestamp'>
[2022-01-24 03:55:40,218] {logging_mixin.py:109} INFO - Object created.
[2022-01-24 03:55:40,218] {logging_mixin.py:109} INFO - 2022 1 3
[2022-01-24 03:55:40,219] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-3.json
[2022-01-24 03:55:40,220] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-19.json
[2022-01-24 03:55:40,222] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-49.json
[2022-01-24 03:55:40,222] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-45.json
[2022-01-24 03:55:40,223] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-7.json
[2022-01-24 03:55:40,223] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-54.json
[2022-01-24 03:55:40,223] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-75.json
[2022-01-24 03:55:40,223] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-60.json
[2022-01-24 03:55:40,223] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-83.json
[2022-01-24 03:55:40,224] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-13.json
[2022-01-24 03:55:40,224] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-2.json
[2022-01-24 03:55:40,224] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-59.json
[2022-01-24 03:55:40,225] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-71.json
[2022-01-24 03:55:40,225] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-8.json
[2022-01-24 03:55:40,225] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-40.json
[2022-01-24 03:55:40,225] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-39.json
[2022-01-24 03:55:40,226] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-65.json
[2022-01-24 03:55:40,226] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-18.json
[2022-01-24 03:55:40,226] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-27.json
[2022-01-24 03:55:40,226] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-51.json
[2022-01-24 03:55:40,226] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-16.json
[2022-01-24 03:55:40,226] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-4.json
[2022-01-24 03:55:40,226] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-62.json
[2022-01-24 03:55:40,227] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-68.json
[2022-01-24 03:55:40,227] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-78.json
[2022-01-24 03:55:40,227] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-33.json
[2022-01-24 03:55:40,227] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-41.json
[2022-01-24 03:55:40,227] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-69.json
[2022-01-24 03:55:40,227] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-0.json
[2022-01-24 03:55:40,227] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-21.json
[2022-01-24 03:55:40,227] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-47.json
[2022-01-24 03:55:40,228] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-9.json
[2022-01-24 03:55:40,228] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-80.json
[2022-01-24 03:55:40,228] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-70.json
[2022-01-24 03:55:40,228] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-6.json
[2022-01-24 03:55:40,228] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-66.json
[2022-01-24 03:55:40,228] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-43.json
[2022-01-24 03:55:40,228] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-46.json
[2022-01-24 03:55:40,229] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-25.json
[2022-01-24 03:55:40,229] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-17.json
[2022-01-24 03:55:40,229] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-35.json
[2022-01-24 03:55:40,229] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-22.json
[2022-01-24 03:55:40,229] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-15.json
[2022-01-24 03:55:40,229] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-53.json
[2022-01-24 03:55:40,229] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-14.json
[2022-01-24 03:55:40,229] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-1.json
[2022-01-24 03:55:40,230] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-72.json
[2022-01-24 03:55:40,230] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-64.json
[2022-01-24 03:55:40,230] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-28.json
[2022-01-24 03:55:40,230] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-12.json
[2022-01-24 03:55:40,230] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-20.json
[2022-01-24 03:55:40,230] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-61.json
[2022-01-24 03:55:40,230] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-56.json
[2022-01-24 03:55:40,230] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-42.json
[2022-01-24 03:55:40,231] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-50.json
[2022-01-24 03:55:40,231] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-58.json
[2022-01-24 03:55:40,231] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-77.json
[2022-01-24 03:55:40,231] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-52.json
[2022-01-24 03:55:40,231] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-79.json
[2022-01-24 03:55:40,231] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-36.json
[2022-01-24 03:55:40,231] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-24.json
[2022-01-24 03:55:40,231] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-23.json
[2022-01-24 03:55:40,232] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-81.json
[2022-01-24 03:55:40,232] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-37.json
[2022-01-24 03:55:40,232] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-74.json
[2022-01-24 03:55:40,232] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-48.json
[2022-01-24 03:55:40,232] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-57.json
[2022-01-24 03:55:40,232] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-34.json
[2022-01-24 03:55:40,232] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-32.json
[2022-01-24 03:55:40,232] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-63.json
[2022-01-24 03:55:40,232] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-5.json
[2022-01-24 03:55:40,233] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-84.json
[2022-01-24 03:55:40,233] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-73.json
[2022-01-24 03:55:40,233] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-30.json
[2022-01-24 03:55:40,233] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-10.json
[2022-01-24 03:55:40,233] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-29.json
[2022-01-24 03:55:40,233] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-38.json
[2022-01-24 03:55:40,233] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-44.json
[2022-01-24 03:55:40,233] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-31.json
[2022-01-24 03:55:40,234] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-11.json
[2022-01-24 03:55:40,234] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-67.json
[2022-01-24 03:55:40,234] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-26.json
[2022-01-24 03:55:40,234] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-82.json
[2022-01-24 03:55:40,234] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-76.json
[2022-01-24 03:55:40,234] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-55.json
[2022-01-24 03:55:40,237] {logging_mixin.py:109} INFO - 85
[2022-01-24 03:55:40,260] {logging_mixin.py:109} INFO -      invoice_id    invoice_timestamp  customer_id  ...  qty is_discount       price
0   20220103-11  2022-01-03T19:59:51  yyymlnv2864  ...  256           0   8988.1600
1   20220103-26  2022-01-03T03:36:28  yadoags1019  ...  131           1   6461.0510
2   20220103-53  2022-01-03T15:35:24  tikvtot4348  ...  297           0   2981.8800
3    20220103-5  2022-01-03T14:07:09  mjbhujn4102  ...   41           1    275.7988
4   20220103-15  2022-01-03T09:55:41  aecqtdi3986  ...   40           1   2338.8400
..          ...                  ...          ...  ...  ...         ...         ...
80   20220103-7  2022-01-03T22:54:32  codpbua4340  ...  234           1  11880.0864
81  20220103-32  2022-01-03T14:27:34  sexnidd1428  ...  249           1   1405.0821
82  20220103-83  2022-01-03T09:31:32  yyymlnv2864  ...   55           1   1197.2510
83  20220103-78  2022-01-03T19:54:44  sexnidd1428  ...  208           0   7302.8800
84  20220103-59  2022-01-03T13:13:44  dludxgk4225  ...  209           0  18837.1700

[85 rows x 8 columns]
[2022-01-24 03:55:40,272] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: sales_dw, Login: awsuser, Password: ***, extra: {}
[2022-01-24 03:55:40,281] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: sales_dw, Login: awsuser, Password: ***, extra: {}
[2022-01-24 03:55:53,728] {python.py:175} INFO - Done. Returned value was: None
[2022-01-24 03:55:53,737] {taskinstance.py:1277} INFO - Marking task as SUCCESS. dag_id=datawarehouse_etl, task_id=load_invoices, execution_date=20220103T000000, start_date=20220124T035540, end_date=20220124T035553
[2022-01-24 03:55:53,775] {local_task_job.py:154} INFO - Task exited with return code 0
[2022-01-24 03:55:53,804] {local_task_job.py:264} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-01-24 04:25:26,656] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [queued]>
[2022-01-24 04:25:26,681] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [queued]>
[2022-01-24 04:25:26,681] {taskinstance.py:1238} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 04:25:26,681] {taskinstance.py:1239} INFO - Starting attempt 1 of 1
[2022-01-24 04:25:26,682] {taskinstance.py:1240} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 04:25:26,710] {taskinstance.py:1259} INFO - Executing <Task(PythonOperator): load_invoices> on 2022-01-03 00:00:00+00:00
[2022-01-24 04:25:26,716] {standard_task_runner.py:52} INFO - Started process 7574 to run task
[2022-01-24 04:25:26,720] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'datawarehouse_etl', 'load_invoices', 'scheduled__2022-01-03T00:00:00+00:00', '--job-id', '81', '--raw', '--subdir', 'DAGS_FOLDER/datawarehouse_***.py', '--cfg-path', '/tmp/tmpmze0oh79', '--error-file', '/tmp/tmpk2s9z05c']
[2022-01-24 04:25:26,721] {standard_task_runner.py:77} INFO - Job 81: Subtask load_invoices
[2022-01-24 04:25:26,780] {logging_mixin.py:109} INFO - Running <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [running]> on host cd9bb47288d1
[2022-01-24 04:25:26,849] {taskinstance.py:1426} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=datawarehouse_etl
AIRFLOW_CTX_TASK_ID=load_invoices
AIRFLOW_CTX_EXECUTION_DATE=2022-01-03T00:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-01-03T00:00:00+00:00
[2022-01-24 04:25:26,852] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 04:25:26,852] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 04:25:26,853] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds_nodash' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds_nodash }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 04:25:26,853] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_end' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 04:25:26,853] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 04:25:26,853] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 04:25:26,853] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 04:25:26,853] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date_success' from the template is deprecated and will be removed in a future version. Please use 'prev_data_interval_start_success' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 04:25:26,854] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 04:25:26,854] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 04:25:26,854] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 04:25:26,854] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 04:25:26,854] {logging_mixin.py:109} INFO - {'conf': <***.configuration.AirflowConfigParser object at 0x7f1e4dfc6a10>, 'dag': <DAG: datawarehouse_etl>, 'dag_run': <DagRun datawarehouse_etl @ 2022-01-03 00:00:00+00:00: scheduled__2022-01-03T00:00:00+00:00, externally triggered: False>, 'data_interval_end': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'data_interval_start': DateTime(2022, 1, 3, 0, 0, 0, tzinfo=Timezone('UTC')), 'ds': '2022-01-03', 'ds_nodash': '20220103', 'execution_date': DateTime(2022, 1, 3, 0, 0, 0, tzinfo=Timezone('UTC')), 'inlets': [], 'logical_date': DateTime(2022, 1, 3, 0, 0, 0, tzinfo=Timezone('UTC')), 'macros': <module '***.macros' from '/home/***/.local/lib/python3.7/site-packages/***/macros/__init__.py'>, 'next_ds': '2022-01-04', 'next_ds_nodash': '20220104', 'next_execution_date': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'outlets': [], 'params': {}, 'prev_data_interval_start_success': None, 'prev_data_interval_end_success': None, 'prev_ds': '2022-01-02', 'prev_ds_nodash': '20220102', 'prev_execution_date': datetime.datetime(2022, 1, 2, 0, 0, tzinfo=Timezone('UTC')), 'prev_execution_date_success': None, 'prev_start_date_success': None, 'run_id': 'scheduled__2022-01-03T00:00:00+00:00', 'task': <Task(PythonOperator): load_invoices>, 'task_instance': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [running]>, 'task_instance_key_str': 'datawarehouse_etl__load_invoices__20220103', 'test_mode': False, 'ti': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [running]>, 'tomorrow_ds': '2022-01-04', 'tomorrow_ds_nodash': '20220104', 'ts': '2022-01-03T00:00:00+00:00', 'ts_nodash': '20220103T000000', 'ts_nodash_with_tz': '20220103T000000+0000', 'var': {'json': None, 'value': None}, 'conn': None, 'yesterday_ds': '2022-01-02', 'yesterday_ds_nodash': '20220102', 'key': 'value', 'ts_var': '2022-01-03T00:00:00+00:00', 'tsnodash_var': '20220103T000000', 'templates_dict': None}
[2022-01-24 04:25:26,856] {logging_mixin.py:109} INFO - ts:  2022-01-03 00:00:00+00:00
[2022-01-24 04:25:26,856] {logging_mixin.py:109} INFO - <class 'pandas._libs.tslibs.timestamps.Timestamp'>
[2022-01-24 04:25:26,856] {logging_mixin.py:109} INFO - Object created.
[2022-01-24 04:25:26,856] {logging_mixin.py:109} INFO - 2022 1 3
[2022-01-24 04:25:26,857] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-3.json
[2022-01-24 04:25:26,858] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-19.json
[2022-01-24 04:25:26,858] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-49.json
[2022-01-24 04:25:26,858] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-45.json
[2022-01-24 04:25:26,858] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-7.json
[2022-01-24 04:25:26,858] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-54.json
[2022-01-24 04:25:26,858] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-75.json
[2022-01-24 04:25:26,858] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-60.json
[2022-01-24 04:25:26,858] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-83.json
[2022-01-24 04:25:26,859] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-13.json
[2022-01-24 04:25:26,859] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-2.json
[2022-01-24 04:25:26,859] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-59.json
[2022-01-24 04:25:26,859] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-71.json
[2022-01-24 04:25:26,859] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-8.json
[2022-01-24 04:25:26,859] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-40.json
[2022-01-24 04:25:26,860] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-39.json
[2022-01-24 04:25:26,860] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-65.json
[2022-01-24 04:25:26,860] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-18.json
[2022-01-24 04:25:26,860] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-27.json
[2022-01-24 04:25:26,860] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-51.json
[2022-01-24 04:25:26,860] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-16.json
[2022-01-24 04:25:26,860] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-4.json
[2022-01-24 04:25:26,860] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-62.json
[2022-01-24 04:25:26,860] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-68.json
[2022-01-24 04:25:26,861] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-78.json
[2022-01-24 04:25:26,861] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-33.json
[2022-01-24 04:25:26,861] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-41.json
[2022-01-24 04:25:26,861] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-69.json
[2022-01-24 04:25:26,861] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-0.json
[2022-01-24 04:25:26,861] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-21.json
[2022-01-24 04:25:26,861] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-47.json
[2022-01-24 04:25:26,861] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-9.json
[2022-01-24 04:25:26,861] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-80.json
[2022-01-24 04:25:26,861] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-70.json
[2022-01-24 04:25:26,862] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-6.json
[2022-01-24 04:25:26,862] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-66.json
[2022-01-24 04:25:26,862] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-43.json
[2022-01-24 04:25:26,862] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-46.json
[2022-01-24 04:25:26,862] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-25.json
[2022-01-24 04:25:26,862] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-17.json
[2022-01-24 04:25:26,862] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-35.json
[2022-01-24 04:25:26,862] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-22.json
[2022-01-24 04:25:26,862] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-15.json
[2022-01-24 04:25:26,862] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-53.json
[2022-01-24 04:25:26,862] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-14.json
[2022-01-24 04:25:26,863] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-1.json
[2022-01-24 04:25:26,863] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-72.json
[2022-01-24 04:25:26,863] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-64.json
[2022-01-24 04:25:26,863] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-28.json
[2022-01-24 04:25:26,863] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-12.json
[2022-01-24 04:25:26,863] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-20.json
[2022-01-24 04:25:26,863] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-61.json
[2022-01-24 04:25:26,863] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-56.json
[2022-01-24 04:25:26,863] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-42.json
[2022-01-24 04:25:26,863] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-50.json
[2022-01-24 04:25:26,863] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-58.json
[2022-01-24 04:25:26,864] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-77.json
[2022-01-24 04:25:26,864] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-52.json
[2022-01-24 04:25:26,864] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-79.json
[2022-01-24 04:25:26,864] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-36.json
[2022-01-24 04:25:26,864] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-24.json
[2022-01-24 04:25:26,864] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-23.json
[2022-01-24 04:25:26,864] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-81.json
[2022-01-24 04:25:26,864] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-37.json
[2022-01-24 04:25:26,864] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-74.json
[2022-01-24 04:25:26,864] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-48.json
[2022-01-24 04:25:26,864] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-57.json
[2022-01-24 04:25:26,865] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-34.json
[2022-01-24 04:25:26,865] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-32.json
[2022-01-24 04:25:26,865] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-63.json
[2022-01-24 04:25:26,865] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-5.json
[2022-01-24 04:25:26,865] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-84.json
[2022-01-24 04:25:26,865] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-73.json
[2022-01-24 04:25:26,865] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-30.json
[2022-01-24 04:25:26,865] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-10.json
[2022-01-24 04:25:26,865] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-29.json
[2022-01-24 04:25:26,866] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-38.json
[2022-01-24 04:25:26,866] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-44.json
[2022-01-24 04:25:26,866] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-31.json
[2022-01-24 04:25:26,866] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-11.json
[2022-01-24 04:25:26,866] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-67.json
[2022-01-24 04:25:26,866] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-26.json
[2022-01-24 04:25:26,866] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-82.json
[2022-01-24 04:25:26,866] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-76.json
[2022-01-24 04:25:26,866] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-55.json
[2022-01-24 04:25:26,869] {logging_mixin.py:109} INFO - 85
[2022-01-24 04:25:26,894] {logging_mixin.py:109} INFO -      invoice_id    invoice_timestamp  customer_id  ...  qty is_discount       price
0   20220103-11  2022-01-03T19:59:51  yyymlnv2864  ...  256           0   8988.1600
1   20220103-26  2022-01-03T03:36:28  yadoags1019  ...  131           1   6461.0510
2   20220103-53  2022-01-03T15:35:24  tikvtot4348  ...  297           0   2981.8800
3    20220103-5  2022-01-03T14:07:09  mjbhujn4102  ...   41           1    275.7988
4   20220103-15  2022-01-03T09:55:41  aecqtdi3986  ...   40           1   2338.8400
..          ...                  ...          ...  ...  ...         ...         ...
80   20220103-7  2022-01-03T22:54:32  codpbua4340  ...  234           1  11880.0864
81  20220103-32  2022-01-03T14:27:34  sexnidd1428  ...  249           1   1405.0821
82  20220103-83  2022-01-03T09:31:32  yyymlnv2864  ...   55           1   1197.2510
83  20220103-78  2022-01-03T19:54:44  sexnidd1428  ...  208           0   7302.8800
84  20220103-59  2022-01-03T13:13:44  dludxgk4225  ...  209           0  18837.1700

[85 rows x 8 columns]
[2022-01-24 04:25:26,917] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: sales_dw, Login: awsuser, Password: ***, extra: {}
[2022-01-24 04:25:26,938] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: sales_dw, Login: awsuser, Password: ***, extra: {}
[2022-01-24 04:25:40,122] {python.py:175} INFO - Done. Returned value was: None
[2022-01-24 04:25:40,144] {taskinstance.py:1277} INFO - Marking task as SUCCESS. dag_id=datawarehouse_etl, task_id=load_invoices, execution_date=20220103T000000, start_date=20220124T042526, end_date=20220124T042540
[2022-01-24 04:25:40,204] {local_task_job.py:154} INFO - Task exited with return code 0
[2022-01-24 04:25:40,242] {local_task_job.py:264} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2022-01-24 05:19:48,309] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [queued]>
[2022-01-24 05:19:48,323] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [queued]>
[2022-01-24 05:19:48,323] {taskinstance.py:1238} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 05:19:48,323] {taskinstance.py:1239} INFO - Starting attempt 1 of 1
[2022-01-24 05:19:48,323] {taskinstance.py:1240} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 05:19:48,337] {taskinstance.py:1259} INFO - Executing <Task(PythonOperator): load_invoices> on 2022-01-03 00:00:00+00:00
[2022-01-24 05:19:48,342] {standard_task_runner.py:52} INFO - Started process 10076 to run task
[2022-01-24 05:19:48,345] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'datawarehouse_etl', 'load_invoices', 'scheduled__2022-01-03T00:00:00+00:00', '--job-id', '84', '--raw', '--subdir', 'DAGS_FOLDER/datawarehouse_***.py', '--cfg-path', '/tmp/tmpevyyv5pa', '--error-file', '/tmp/tmpo522drcd']
[2022-01-24 05:19:48,346] {standard_task_runner.py:77} INFO - Job 84: Subtask load_invoices
[2022-01-24 05:19:48,405] {logging_mixin.py:109} INFO - Running <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [running]> on host cd9bb47288d1
[2022-01-24 05:19:48,474] {taskinstance.py:1426} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=datawarehouse_etl
AIRFLOW_CTX_TASK_ID=load_invoices
AIRFLOW_CTX_EXECUTION_DATE=2022-01-03T00:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-01-03T00:00:00+00:00
[2022-01-24 05:19:48,476] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 05:19:48,476] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 05:19:48,476] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds_nodash' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds_nodash }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 05:19:48,476] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_end' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 05:19:48,477] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 05:19:48,477] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 05:19:48,477] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 05:19:48,477] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date_success' from the template is deprecated and will be removed in a future version. Please use 'prev_data_interval_start_success' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 05:19:48,477] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 05:19:48,477] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 05:19:48,477] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 05:19:48,477] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 05:19:48,478] {logging_mixin.py:109} INFO - {'conf': <***.configuration.AirflowConfigParser object at 0x7f1e4dfc6a10>, 'dag': <DAG: datawarehouse_etl>, 'dag_run': <DagRun datawarehouse_etl @ 2022-01-03 00:00:00+00:00: scheduled__2022-01-03T00:00:00+00:00, externally triggered: False>, 'data_interval_end': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'data_interval_start': DateTime(2022, 1, 3, 0, 0, 0, tzinfo=Timezone('UTC')), 'ds': '2022-01-03', 'ds_nodash': '20220103', 'execution_date': DateTime(2022, 1, 3, 0, 0, 0, tzinfo=Timezone('UTC')), 'inlets': [], 'logical_date': DateTime(2022, 1, 3, 0, 0, 0, tzinfo=Timezone('UTC')), 'macros': <module '***.macros' from '/home/***/.local/lib/python3.7/site-packages/***/macros/__init__.py'>, 'next_ds': '2022-01-04', 'next_ds_nodash': '20220104', 'next_execution_date': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'outlets': [], 'params': {}, 'prev_data_interval_start_success': None, 'prev_data_interval_end_success': None, 'prev_ds': '2022-01-02', 'prev_ds_nodash': '20220102', 'prev_execution_date': datetime.datetime(2022, 1, 2, 0, 0, tzinfo=Timezone('UTC')), 'prev_execution_date_success': None, 'prev_start_date_success': None, 'run_id': 'scheduled__2022-01-03T00:00:00+00:00', 'task': <Task(PythonOperator): load_invoices>, 'task_instance': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [running]>, 'task_instance_key_str': 'datawarehouse_etl__load_invoices__20220103', 'test_mode': False, 'ti': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [running]>, 'tomorrow_ds': '2022-01-04', 'tomorrow_ds_nodash': '20220104', 'ts': '2022-01-03T00:00:00+00:00', 'ts_nodash': '20220103T000000', 'ts_nodash_with_tz': '20220103T000000+0000', 'var': {'json': None, 'value': None}, 'conn': None, 'yesterday_ds': '2022-01-02', 'yesterday_ds_nodash': '20220102', 'key': 'value', 'ts_var': '2022-01-03T00:00:00+00:00', 'tsnodash_var': '20220103T000000', 'templates_dict': None}
[2022-01-24 05:19:48,479] {logging_mixin.py:109} INFO - ts:  2022-01-03 00:00:00+00:00
[2022-01-24 05:19:48,479] {logging_mixin.py:109} INFO - <class 'pandas._libs.tslibs.timestamps.Timestamp'>
[2022-01-24 05:19:48,479] {logging_mixin.py:109} INFO - Object created.
[2022-01-24 05:19:48,479] {logging_mixin.py:109} INFO - 2022 1 3
[2022-01-24 05:19:48,480] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-3.json
[2022-01-24 05:19:48,481] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-19.json
[2022-01-24 05:19:48,481] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-49.json
[2022-01-24 05:19:48,481] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-45.json
[2022-01-24 05:19:48,481] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-7.json
[2022-01-24 05:19:48,481] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-54.json
[2022-01-24 05:19:48,482] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-75.json
[2022-01-24 05:19:48,482] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-60.json
[2022-01-24 05:19:48,482] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-83.json
[2022-01-24 05:19:48,482] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-13.json
[2022-01-24 05:19:48,483] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-2.json
[2022-01-24 05:19:48,483] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-59.json
[2022-01-24 05:19:48,483] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-71.json
[2022-01-24 05:19:48,483] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-8.json
[2022-01-24 05:19:48,483] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-40.json
[2022-01-24 05:19:48,484] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-39.json
[2022-01-24 05:19:48,484] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-65.json
[2022-01-24 05:19:48,484] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-18.json
[2022-01-24 05:19:48,484] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-27.json
[2022-01-24 05:19:48,485] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-51.json
[2022-01-24 05:19:48,485] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-16.json
[2022-01-24 05:19:48,485] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-4.json
[2022-01-24 05:19:48,485] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-62.json
[2022-01-24 05:19:48,486] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-68.json
[2022-01-24 05:19:48,486] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-78.json
[2022-01-24 05:19:48,486] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-33.json
[2022-01-24 05:19:48,486] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-41.json
[2022-01-24 05:19:48,486] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-69.json
[2022-01-24 05:19:48,487] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-0.json
[2022-01-24 05:19:48,487] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-21.json
[2022-01-24 05:19:48,487] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-47.json
[2022-01-24 05:19:48,487] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-9.json
[2022-01-24 05:19:48,487] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-80.json
[2022-01-24 05:19:48,488] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-70.json
[2022-01-24 05:19:48,488] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-6.json
[2022-01-24 05:19:48,488] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-66.json
[2022-01-24 05:19:48,488] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-43.json
[2022-01-24 05:19:48,489] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-46.json
[2022-01-24 05:19:48,489] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-25.json
[2022-01-24 05:19:48,489] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-17.json
[2022-01-24 05:19:48,489] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-35.json
[2022-01-24 05:19:48,489] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-22.json
[2022-01-24 05:19:48,490] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-15.json
[2022-01-24 05:19:48,490] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-53.json
[2022-01-24 05:19:48,490] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-14.json
[2022-01-24 05:19:48,491] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-1.json
[2022-01-24 05:19:48,491] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-72.json
[2022-01-24 05:19:48,491] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-64.json
[2022-01-24 05:19:48,492] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-28.json
[2022-01-24 05:19:48,492] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-12.json
[2022-01-24 05:19:48,493] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-20.json
[2022-01-24 05:19:48,493] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-61.json
[2022-01-24 05:19:48,494] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-56.json
[2022-01-24 05:19:48,495] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-42.json
[2022-01-24 05:19:48,496] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-50.json
[2022-01-24 05:19:48,498] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-58.json
[2022-01-24 05:19:48,499] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-77.json
[2022-01-24 05:19:48,499] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-52.json
[2022-01-24 05:19:48,500] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-79.json
[2022-01-24 05:19:48,500] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-36.json
[2022-01-24 05:19:48,500] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-24.json
[2022-01-24 05:19:48,500] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-23.json
[2022-01-24 05:19:48,500] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-81.json
[2022-01-24 05:19:48,501] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-37.json
[2022-01-24 05:19:48,501] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-74.json
[2022-01-24 05:19:48,501] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-48.json
[2022-01-24 05:19:48,501] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-57.json
[2022-01-24 05:19:48,501] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-34.json
[2022-01-24 05:19:48,502] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-32.json
[2022-01-24 05:19:48,502] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-63.json
[2022-01-24 05:19:48,502] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-5.json
[2022-01-24 05:19:48,502] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-84.json
[2022-01-24 05:19:48,502] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-73.json
[2022-01-24 05:19:48,503] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-30.json
[2022-01-24 05:19:48,503] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-10.json
[2022-01-24 05:19:48,503] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-29.json
[2022-01-24 05:19:48,503] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-38.json
[2022-01-24 05:19:48,503] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-44.json
[2022-01-24 05:19:48,504] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-31.json
[2022-01-24 05:19:48,504] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-11.json
[2022-01-24 05:19:48,504] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-67.json
[2022-01-24 05:19:48,504] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-26.json
[2022-01-24 05:19:48,504] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-82.json
[2022-01-24 05:19:48,505] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-76.json
[2022-01-24 05:19:48,505] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-55.json
[2022-01-24 05:19:48,507] {logging_mixin.py:109} INFO - 85
[2022-01-24 05:19:48,534] {logging_mixin.py:109} INFO -      invoice_id    invoice_timestamp  customer_id  ...  qty is_discount       price
0   20220103-11  2022-01-03T19:59:51  yyymlnv2864  ...  256           0   8988.1600
1   20220103-26  2022-01-03T03:36:28  yadoags1019  ...  131           1   6461.0510
2   20220103-53  2022-01-03T15:35:24  tikvtot4348  ...  297           0   2981.8800
3    20220103-5  2022-01-03T14:07:09  mjbhujn4102  ...   41           1    275.7988
4   20220103-15  2022-01-03T09:55:41  aecqtdi3986  ...   40           1   2338.8400
..          ...                  ...          ...  ...  ...         ...         ...
80   20220103-7  2022-01-03T22:54:32  codpbua4340  ...  234           1  11880.0864
81  20220103-32  2022-01-03T14:27:34  sexnidd1428  ...  249           1   1405.0821
82  20220103-83  2022-01-03T09:31:32  yyymlnv2864  ...   55           1   1197.2510
83  20220103-78  2022-01-03T19:54:44  sexnidd1428  ...  208           0   7302.8800
84  20220103-59  2022-01-03T13:13:44  dludxgk4225  ...  209           0  18837.1700

[85 rows x 8 columns]
[2022-01-24 05:19:48,546] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: sales_dw, Login: awsuser, Password: ***, extra: {}
[2022-01-24 05:19:48,554] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: sales_dw, Login: awsuser, Password: ***, extra: {}
[2022-01-24 05:20:01,947] {python.py:175} INFO - Done. Returned value was: None
[2022-01-24 05:20:01,965] {taskinstance.py:1277} INFO - Marking task as SUCCESS. dag_id=datawarehouse_etl, task_id=load_invoices, execution_date=20220103T000000, start_date=20220124T051948, end_date=20220124T052001
[2022-01-24 05:20:01,994] {local_task_job.py:154} INFO - Task exited with return code 0
[2022-01-24 05:20:02,041] {local_task_job.py:264} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2022-01-24 05:22:42,254] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [queued]>
[2022-01-24 05:22:42,267] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [queued]>
[2022-01-24 05:22:42,267] {taskinstance.py:1238} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 05:22:42,267] {taskinstance.py:1239} INFO - Starting attempt 1 of 1
[2022-01-24 05:22:42,267] {taskinstance.py:1240} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 05:22:42,278] {taskinstance.py:1259} INFO - Executing <Task(PythonOperator): load_invoices> on 2022-01-03 00:00:00+00:00
[2022-01-24 05:22:42,283] {standard_task_runner.py:52} INFO - Started process 10222 to run task
[2022-01-24 05:22:42,286] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'datawarehouse_etl', 'load_invoices', 'scheduled__2022-01-03T00:00:00+00:00', '--job-id', '90', '--raw', '--subdir', 'DAGS_FOLDER/datawarehouse_***.py', '--cfg-path', '/tmp/tmpay5urwxs', '--error-file', '/tmp/tmpagu46f3n']
[2022-01-24 05:22:42,286] {standard_task_runner.py:77} INFO - Job 90: Subtask load_invoices
[2022-01-24 05:22:42,337] {logging_mixin.py:109} INFO - Running <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [running]> on host cd9bb47288d1
[2022-01-24 05:22:42,383] {taskinstance.py:1426} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=datawarehouse_etl
AIRFLOW_CTX_TASK_ID=load_invoices
AIRFLOW_CTX_EXECUTION_DATE=2022-01-03T00:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-01-03T00:00:00+00:00
[2022-01-24 05:22:42,385] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 05:22:42,385] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 05:22:42,385] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds_nodash' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds_nodash }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 05:22:42,386] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_end' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 05:22:42,386] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 05:22:42,386] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 05:22:42,386] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 05:22:42,386] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date_success' from the template is deprecated and will be removed in a future version. Please use 'prev_data_interval_start_success' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 05:22:42,386] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 05:22:42,386] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 05:22:42,387] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 05:22:42,387] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 05:22:42,387] {logging_mixin.py:109} INFO - {'conf': <***.configuration.AirflowConfigParser object at 0x7f1e4dfc6a10>, 'dag': <DAG: datawarehouse_etl>, 'dag_run': <DagRun datawarehouse_etl @ 2022-01-03 00:00:00+00:00: scheduled__2022-01-03T00:00:00+00:00, externally triggered: False>, 'data_interval_end': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'data_interval_start': DateTime(2022, 1, 3, 0, 0, 0, tzinfo=Timezone('UTC')), 'ds': '2022-01-03', 'ds_nodash': '20220103', 'execution_date': DateTime(2022, 1, 3, 0, 0, 0, tzinfo=Timezone('UTC')), 'inlets': [], 'logical_date': DateTime(2022, 1, 3, 0, 0, 0, tzinfo=Timezone('UTC')), 'macros': <module '***.macros' from '/home/***/.local/lib/python3.7/site-packages/***/macros/__init__.py'>, 'next_ds': '2022-01-04', 'next_ds_nodash': '20220104', 'next_execution_date': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'outlets': [], 'params': {}, 'prev_data_interval_start_success': None, 'prev_data_interval_end_success': None, 'prev_ds': '2022-01-02', 'prev_ds_nodash': '20220102', 'prev_execution_date': datetime.datetime(2022, 1, 2, 0, 0, tzinfo=Timezone('UTC')), 'prev_execution_date_success': None, 'prev_start_date_success': None, 'run_id': 'scheduled__2022-01-03T00:00:00+00:00', 'task': <Task(PythonOperator): load_invoices>, 'task_instance': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [running]>, 'task_instance_key_str': 'datawarehouse_etl__load_invoices__20220103', 'test_mode': False, 'ti': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [running]>, 'tomorrow_ds': '2022-01-04', 'tomorrow_ds_nodash': '20220104', 'ts': '2022-01-03T00:00:00+00:00', 'ts_nodash': '20220103T000000', 'ts_nodash_with_tz': '20220103T000000+0000', 'var': {'json': None, 'value': None}, 'conn': None, 'yesterday_ds': '2022-01-02', 'yesterday_ds_nodash': '20220102', 'key': 'value', 'ts_var': '2022-01-03T00:00:00+00:00', 'tsnodash_var': '20220103T000000', 'templates_dict': None}
[2022-01-24 05:22:42,388] {logging_mixin.py:109} INFO - ts:  2022-01-03 00:00:00+00:00
[2022-01-24 05:22:42,388] {logging_mixin.py:109} INFO - <class 'pandas._libs.tslibs.timestamps.Timestamp'>
[2022-01-24 05:22:42,389] {logging_mixin.py:109} INFO - Object created.
[2022-01-24 05:22:42,389] {logging_mixin.py:109} INFO - 2022 1 3
[2022-01-24 05:22:42,390] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-3.json
[2022-01-24 05:22:42,390] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-19.json
[2022-01-24 05:22:42,390] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-49.json
[2022-01-24 05:22:42,390] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-45.json
[2022-01-24 05:22:42,390] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-7.json
[2022-01-24 05:22:42,390] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-54.json
[2022-01-24 05:22:42,390] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-75.json
[2022-01-24 05:22:42,391] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-60.json
[2022-01-24 05:22:42,391] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-83.json
[2022-01-24 05:22:42,391] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-13.json
[2022-01-24 05:22:42,391] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-2.json
[2022-01-24 05:22:42,391] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-59.json
[2022-01-24 05:22:42,391] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-71.json
[2022-01-24 05:22:42,391] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-8.json
[2022-01-24 05:22:42,391] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-40.json
[2022-01-24 05:22:42,392] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-39.json
[2022-01-24 05:22:42,392] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-65.json
[2022-01-24 05:22:42,392] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-18.json
[2022-01-24 05:22:42,392] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-27.json
[2022-01-24 05:22:42,392] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-51.json
[2022-01-24 05:22:42,392] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-16.json
[2022-01-24 05:22:42,392] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-4.json
[2022-01-24 05:22:42,392] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-62.json
[2022-01-24 05:22:42,393] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-68.json
[2022-01-24 05:22:42,393] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-78.json
[2022-01-24 05:22:42,393] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-33.json
[2022-01-24 05:22:42,393] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-41.json
[2022-01-24 05:22:42,393] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-69.json
[2022-01-24 05:22:42,393] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-0.json
[2022-01-24 05:22:42,393] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-21.json
[2022-01-24 05:22:42,393] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-47.json
[2022-01-24 05:22:42,394] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-9.json
[2022-01-24 05:22:42,394] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-80.json
[2022-01-24 05:22:42,394] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-70.json
[2022-01-24 05:22:42,394] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-6.json
[2022-01-24 05:22:42,394] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-66.json
[2022-01-24 05:22:42,394] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-43.json
[2022-01-24 05:22:42,394] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-46.json
[2022-01-24 05:22:42,394] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-25.json
[2022-01-24 05:22:42,395] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-17.json
[2022-01-24 05:22:42,395] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-35.json
[2022-01-24 05:22:42,395] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-22.json
[2022-01-24 05:22:42,395] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-15.json
[2022-01-24 05:22:42,395] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-53.json
[2022-01-24 05:22:42,395] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-14.json
[2022-01-24 05:22:42,395] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-1.json
[2022-01-24 05:22:42,395] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-72.json
[2022-01-24 05:22:42,396] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-64.json
[2022-01-24 05:22:42,396] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-28.json
[2022-01-24 05:22:42,396] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-12.json
[2022-01-24 05:22:42,396] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-20.json
[2022-01-24 05:22:42,396] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-61.json
[2022-01-24 05:22:42,396] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-56.json
[2022-01-24 05:22:42,396] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-42.json
[2022-01-24 05:22:42,396] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-50.json
[2022-01-24 05:22:42,397] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-58.json
[2022-01-24 05:22:42,397] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-77.json
[2022-01-24 05:22:42,397] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-52.json
[2022-01-24 05:22:42,397] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-79.json
[2022-01-24 05:22:42,397] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-36.json
[2022-01-24 05:22:42,397] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-24.json
[2022-01-24 05:22:42,397] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-23.json
[2022-01-24 05:22:42,397] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-81.json
[2022-01-24 05:22:42,397] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-37.json
[2022-01-24 05:22:42,398] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-74.json
[2022-01-24 05:22:42,398] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-48.json
[2022-01-24 05:22:42,398] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-57.json
[2022-01-24 05:22:42,398] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-34.json
[2022-01-24 05:22:42,398] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-32.json
[2022-01-24 05:22:42,398] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-63.json
[2022-01-24 05:22:42,398] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-5.json
[2022-01-24 05:22:42,398] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-84.json
[2022-01-24 05:22:42,399] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-73.json
[2022-01-24 05:22:42,399] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-30.json
[2022-01-24 05:22:42,399] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-10.json
[2022-01-24 05:22:42,399] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-29.json
[2022-01-24 05:22:42,399] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-38.json
[2022-01-24 05:22:42,399] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-44.json
[2022-01-24 05:22:42,399] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-31.json
[2022-01-24 05:22:42,400] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-11.json
[2022-01-24 05:22:42,400] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-67.json
[2022-01-24 05:22:42,400] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-26.json
[2022-01-24 05:22:42,400] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-82.json
[2022-01-24 05:22:42,400] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-76.json
[2022-01-24 05:22:42,400] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-55.json
[2022-01-24 05:22:42,403] {logging_mixin.py:109} INFO - 85
[2022-01-24 05:22:42,423] {logging_mixin.py:109} INFO -      invoice_id    invoice_timestamp  customer_id  ...  qty is_discount       price
0   20220103-11  2022-01-03T19:59:51  yyymlnv2864  ...  256           0   8988.1600
1   20220103-26  2022-01-03T03:36:28  yadoags1019  ...  131           1   6461.0510
2   20220103-53  2022-01-03T15:35:24  tikvtot4348  ...  297           0   2981.8800
3    20220103-5  2022-01-03T14:07:09  mjbhujn4102  ...   41           1    275.7988
4   20220103-15  2022-01-03T09:55:41  aecqtdi3986  ...   40           1   2338.8400
..          ...                  ...          ...  ...  ...         ...         ...
80   20220103-7  2022-01-03T22:54:32  codpbua4340  ...  234           1  11880.0864
81  20220103-32  2022-01-03T14:27:34  sexnidd1428  ...  249           1   1405.0821
82  20220103-83  2022-01-03T09:31:32  yyymlnv2864  ...   55           1   1197.2510
83  20220103-78  2022-01-03T19:54:44  sexnidd1428  ...  208           0   7302.8800
84  20220103-59  2022-01-03T13:13:44  dludxgk4225  ...  209           0  18837.1700

[85 rows x 8 columns]
[2022-01-24 05:22:42,432] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: sales_dw, Login: awsuser, Password: ***, extra: {}
[2022-01-24 05:22:42,438] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: sales_dw, Login: awsuser, Password: ***, extra: {}
[2022-01-24 05:22:56,573] {python.py:175} INFO - Done. Returned value was: None
[2022-01-24 05:22:56,592] {taskinstance.py:1277} INFO - Marking task as SUCCESS. dag_id=datawarehouse_etl, task_id=load_invoices, execution_date=20220103T000000, start_date=20220124T052242, end_date=20220124T052256
[2022-01-24 05:22:56,655] {local_task_job.py:154} INFO - Task exited with return code 0
[2022-01-24 05:22:56,701] {local_task_job.py:264} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2022-01-24 18:00:52,735] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [queued]>
[2022-01-24 18:00:52,745] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [queued]>
[2022-01-24 18:00:52,745] {taskinstance.py:1238} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 18:00:52,745] {taskinstance.py:1239} INFO - Starting attempt 1 of 1
[2022-01-24 18:00:52,745] {taskinstance.py:1240} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 18:00:52,756] {taskinstance.py:1259} INFO - Executing <Task(PythonOperator): load_invoices> on 2022-01-03 00:00:00+00:00
[2022-01-24 18:00:52,761] {standard_task_runner.py:52} INFO - Started process 1599 to run task
[2022-01-24 18:00:52,765] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'datawarehouse_etl', 'load_invoices', 'scheduled__2022-01-03T00:00:00+00:00', '--job-id', '98', '--raw', '--subdir', 'DAGS_FOLDER/datawarehouse_***.py', '--cfg-path', '/tmp/tmpr_2u3zuk', '--error-file', '/tmp/tmpf1b4fcrc']
[2022-01-24 18:00:52,766] {standard_task_runner.py:77} INFO - Job 98: Subtask load_invoices
[2022-01-24 18:00:52,820] {logging_mixin.py:109} INFO - Running <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [running]> on host cd9bb47288d1
[2022-01-24 18:00:52,888] {taskinstance.py:1426} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=datawarehouse_etl
AIRFLOW_CTX_TASK_ID=load_invoices
AIRFLOW_CTX_EXECUTION_DATE=2022-01-03T00:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-01-03T00:00:00+00:00
[2022-01-24 18:00:52,890] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:00:52,890] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:00:52,890] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds_nodash' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds_nodash }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:00:52,890] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_end' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:00:52,890] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:00:52,891] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:00:52,891] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:00:52,891] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date_success' from the template is deprecated and will be removed in a future version. Please use 'prev_data_interval_start_success' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:00:52,891] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:00:52,891] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:00:52,891] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:00:52,891] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:00:52,892] {logging_mixin.py:109} INFO - {'conf': <***.configuration.AirflowConfigParser object at 0x7f76fb23ca90>, 'dag': <DAG: datawarehouse_etl>, 'dag_run': <DagRun datawarehouse_etl @ 2022-01-03 00:00:00+00:00: scheduled__2022-01-03T00:00:00+00:00, externally triggered: False>, 'data_interval_end': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'data_interval_start': DateTime(2022, 1, 3, 0, 0, 0, tzinfo=Timezone('UTC')), 'ds': '2022-01-03', 'ds_nodash': '20220103', 'execution_date': DateTime(2022, 1, 3, 0, 0, 0, tzinfo=Timezone('UTC')), 'inlets': [], 'logical_date': DateTime(2022, 1, 3, 0, 0, 0, tzinfo=Timezone('UTC')), 'macros': <module '***.macros' from '/home/***/.local/lib/python3.7/site-packages/***/macros/__init__.py'>, 'next_ds': '2022-01-04', 'next_ds_nodash': '20220104', 'next_execution_date': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'outlets': [], 'params': {}, 'prev_data_interval_start_success': None, 'prev_data_interval_end_success': None, 'prev_ds': '2022-01-02', 'prev_ds_nodash': '20220102', 'prev_execution_date': datetime.datetime(2022, 1, 2, 0, 0, tzinfo=Timezone('UTC')), 'prev_execution_date_success': None, 'prev_start_date_success': None, 'run_id': 'scheduled__2022-01-03T00:00:00+00:00', 'task': <Task(PythonOperator): load_invoices>, 'task_instance': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [running]>, 'task_instance_key_str': 'datawarehouse_etl__load_invoices__20220103', 'test_mode': False, 'ti': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [running]>, 'tomorrow_ds': '2022-01-04', 'tomorrow_ds_nodash': '20220104', 'ts': '2022-01-03T00:00:00+00:00', 'ts_nodash': '20220103T000000', 'ts_nodash_with_tz': '20220103T000000+0000', 'var': {'json': None, 'value': None}, 'conn': None, 'yesterday_ds': '2022-01-02', 'yesterday_ds_nodash': '20220102', 'key': 'value', 'ts_var': '2022-01-03T00:00:00+00:00', 'tsnodash_var': '20220103T000000', 'templates_dict': None}
[2022-01-24 18:00:52,894] {logging_mixin.py:109} INFO - ts:  2022-01-03 00:00:00+00:00
[2022-01-24 18:00:52,894] {logging_mixin.py:109} INFO - <class 'pandas._libs.tslibs.timestamps.Timestamp'>
[2022-01-24 18:00:52,894] {logging_mixin.py:109} INFO - Object created.
[2022-01-24 18:00:52,894] {logging_mixin.py:109} INFO - 2022 1 3
[2022-01-24 18:00:52,896] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-3.json
[2022-01-24 18:00:52,897] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-19.json
[2022-01-24 18:00:52,897] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-49.json
[2022-01-24 18:00:52,898] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-45.json
[2022-01-24 18:00:52,898] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-7.json
[2022-01-24 18:00:52,898] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-54.json
[2022-01-24 18:00:52,898] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-75.json
[2022-01-24 18:00:52,899] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-60.json
[2022-01-24 18:00:52,899] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-83.json
[2022-01-24 18:00:52,899] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-13.json
[2022-01-24 18:00:52,900] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-2.json
[2022-01-24 18:00:52,900] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-59.json
[2022-01-24 18:00:52,900] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-71.json
[2022-01-24 18:00:52,900] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-8.json
[2022-01-24 18:00:52,900] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-40.json
[2022-01-24 18:00:52,901] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-39.json
[2022-01-24 18:00:52,901] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-65.json
[2022-01-24 18:00:52,901] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-86.json
[2022-01-24 18:00:52,901] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-18.json
[2022-01-24 18:00:52,901] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-27.json
[2022-01-24 18:00:52,902] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-51.json
[2022-01-24 18:00:52,902] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-16.json
[2022-01-24 18:00:52,902] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-4.json
[2022-01-24 18:00:52,902] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-62.json
[2022-01-24 18:00:52,903] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-68.json
[2022-01-24 18:00:52,903] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-78.json
[2022-01-24 18:00:52,903] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-33.json
[2022-01-24 18:00:52,903] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-41.json
[2022-01-24 18:00:52,903] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-69.json
[2022-01-24 18:00:52,904] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-0.json
[2022-01-24 18:00:52,904] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-21.json
[2022-01-24 18:00:52,904] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-47.json
[2022-01-24 18:00:52,904] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-9.json
[2022-01-24 18:00:52,905] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-80.json
[2022-01-24 18:00:52,905] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-70.json
[2022-01-24 18:00:52,905] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-6.json
[2022-01-24 18:00:52,905] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-87.json
[2022-01-24 18:00:52,905] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-66.json
[2022-01-24 18:00:52,906] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-43.json
[2022-01-24 18:00:52,906] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-46.json
[2022-01-24 18:00:52,906] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-25.json
[2022-01-24 18:00:52,906] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-17.json
[2022-01-24 18:00:52,907] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-85.json
[2022-01-24 18:00:52,907] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-35.json
[2022-01-24 18:00:52,907] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-22.json
[2022-01-24 18:00:52,907] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-15.json
[2022-01-24 18:00:52,908] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-53.json
[2022-01-24 18:00:52,908] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-14.json
[2022-01-24 18:00:52,908] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-1.json
[2022-01-24 18:00:52,908] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-72.json
[2022-01-24 18:00:52,908] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-64.json
[2022-01-24 18:00:52,909] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-28.json
[2022-01-24 18:00:52,909] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-12.json
[2022-01-24 18:00:52,909] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-20.json
[2022-01-24 18:00:52,909] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-61.json
[2022-01-24 18:00:52,910] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-56.json
[2022-01-24 18:00:52,910] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-42.json
[2022-01-24 18:00:52,910] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-50.json
[2022-01-24 18:00:52,910] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-58.json
[2022-01-24 18:00:52,911] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-77.json
[2022-01-24 18:00:52,911] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-52.json
[2022-01-24 18:00:52,911] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-79.json
[2022-01-24 18:00:52,911] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-36.json
[2022-01-24 18:00:52,911] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-24.json
[2022-01-24 18:00:52,912] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-23.json
[2022-01-24 18:00:52,912] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-81.json
[2022-01-24 18:00:52,912] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-37.json
[2022-01-24 18:00:52,912] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-74.json
[2022-01-24 18:00:52,913] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-48.json
[2022-01-24 18:00:52,913] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-57.json
[2022-01-24 18:00:52,913] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-34.json
[2022-01-24 18:00:52,913] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-32.json
[2022-01-24 18:00:52,914] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-63.json
[2022-01-24 18:00:52,914] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-5.json
[2022-01-24 18:00:52,914] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-84.json
[2022-01-24 18:00:52,914] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-73.json
[2022-01-24 18:00:52,914] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-30.json
[2022-01-24 18:00:52,915] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-10.json
[2022-01-24 18:00:52,915] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-29.json
[2022-01-24 18:00:52,915] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-38.json
[2022-01-24 18:00:52,915] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-44.json
[2022-01-24 18:00:52,916] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-31.json
[2022-01-24 18:00:52,916] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-11.json
[2022-01-24 18:00:52,916] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-67.json
[2022-01-24 18:00:52,916] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-26.json
[2022-01-24 18:00:52,917] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-82.json
[2022-01-24 18:00:52,917] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-76.json
[2022-01-24 18:00:52,917] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-55.json
[2022-01-24 18:00:52,920] {logging_mixin.py:109} INFO - 88
[2022-01-24 18:00:52,946] {logging_mixin.py:109} INFO -      invoice_id    invoice_timestamp  customer_id  ...  qty is_discount       price
0   20220103-11  2022-01-03T20:18:17  swibheb5634  ...  184           0  11439.2800
1   20220103-26  2022-01-03T14:44:24  mcbdghx4658  ...   34           1    111.7376
2   20220103-53  2022-01-03T02:37:16  dheanrq4135  ...   72           1   4212.4320
3    20220103-5  2022-01-03T00:59:19  okehqjl1310  ...   61           1   2866.6584
4   20220103-15  2022-01-03T01:43:15  wkigwzj3895  ...   40           0    507.6000
..          ...                  ...          ...  ...  ...         ...         ...
83   20220103-7  2022-01-03T17:17:57  fdstekl3454  ...  217           1  10054.0440
84  20220103-32  2022-01-03T23:20:38  ohzbsfe1717  ...  293           1   3197.6262
85  20220103-83  2022-01-03T04:43:11  ojxlnok1963  ...  286           0  11042.4600
86  20220103-78  2022-01-03T05:34:33  okejdpd4001  ...    2           1     56.3706
87  20220103-59  2022-01-03T12:44:15  vovqlzc2954  ...   87           1   3549.2781

[88 rows x 8 columns]
[2022-01-24 18:00:52,955] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: sales_dw, Login: awsuser, Password: ***, extra: {}
[2022-01-24 18:00:52,961] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: sales_dw, Login: awsuser, Password: ***, extra: {}
[2022-01-24 18:01:07,741] {python.py:175} INFO - Done. Returned value was: None
[2022-01-24 18:01:07,758] {taskinstance.py:1277} INFO - Marking task as SUCCESS. dag_id=datawarehouse_etl, task_id=load_invoices, execution_date=20220103T000000, start_date=20220124T180052, end_date=20220124T180107
[2022-01-24 18:01:07,780] {local_task_job.py:154} INFO - Task exited with return code 0
[2022-01-24 18:01:07,808] {local_task_job.py:264} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2022-01-24 18:02:56,767] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [queued]>
[2022-01-24 18:02:56,779] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [queued]>
[2022-01-24 18:02:56,779] {taskinstance.py:1238} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 18:02:56,779] {taskinstance.py:1239} INFO - Starting attempt 1 of 1
[2022-01-24 18:02:56,779] {taskinstance.py:1240} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 18:02:56,792] {taskinstance.py:1259} INFO - Executing <Task(PythonOperator): load_invoices> on 2022-01-03 00:00:00+00:00
[2022-01-24 18:02:56,797] {standard_task_runner.py:52} INFO - Started process 1709 to run task
[2022-01-24 18:02:56,800] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'datawarehouse_etl', 'load_invoices', 'scheduled__2022-01-03T00:00:00+00:00', '--job-id', '104', '--raw', '--subdir', 'DAGS_FOLDER/datawarehouse_***.py', '--cfg-path', '/tmp/tmpvndm7kaq', '--error-file', '/tmp/tmp7sx2bu5v']
[2022-01-24 18:02:56,801] {standard_task_runner.py:77} INFO - Job 104: Subtask load_invoices
[2022-01-24 18:02:56,842] {logging_mixin.py:109} INFO - Running <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [running]> on host cd9bb47288d1
[2022-01-24 18:02:56,882] {taskinstance.py:1426} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=datawarehouse_etl
AIRFLOW_CTX_TASK_ID=load_invoices
AIRFLOW_CTX_EXECUTION_DATE=2022-01-03T00:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-01-03T00:00:00+00:00
[2022-01-24 18:02:56,883] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:02:56,883] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:02:56,883] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds_nodash' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds_nodash }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:02:56,884] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_end' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:02:56,884] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:02:56,884] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:02:56,884] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:02:56,884] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date_success' from the template is deprecated and will be removed in a future version. Please use 'prev_data_interval_start_success' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:02:56,884] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:02:56,884] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:02:56,884] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:02:56,884] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:02:56,885] {logging_mixin.py:109} INFO - {'conf': <***.configuration.AirflowConfigParser object at 0x7f76fb23ca90>, 'dag': <DAG: datawarehouse_etl>, 'dag_run': <DagRun datawarehouse_etl @ 2022-01-03 00:00:00+00:00: scheduled__2022-01-03T00:00:00+00:00, externally triggered: False>, 'data_interval_end': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'data_interval_start': DateTime(2022, 1, 3, 0, 0, 0, tzinfo=Timezone('UTC')), 'ds': '2022-01-03', 'ds_nodash': '20220103', 'execution_date': DateTime(2022, 1, 3, 0, 0, 0, tzinfo=Timezone('UTC')), 'inlets': [], 'logical_date': DateTime(2022, 1, 3, 0, 0, 0, tzinfo=Timezone('UTC')), 'macros': <module '***.macros' from '/home/***/.local/lib/python3.7/site-packages/***/macros/__init__.py'>, 'next_ds': '2022-01-04', 'next_ds_nodash': '20220104', 'next_execution_date': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'outlets': [], 'params': {}, 'prev_data_interval_start_success': None, 'prev_data_interval_end_success': None, 'prev_ds': '2022-01-02', 'prev_ds_nodash': '20220102', 'prev_execution_date': datetime.datetime(2022, 1, 2, 0, 0, tzinfo=Timezone('UTC')), 'prev_execution_date_success': None, 'prev_start_date_success': None, 'run_id': 'scheduled__2022-01-03T00:00:00+00:00', 'task': <Task(PythonOperator): load_invoices>, 'task_instance': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [running]>, 'task_instance_key_str': 'datawarehouse_etl__load_invoices__20220103', 'test_mode': False, 'ti': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [running]>, 'tomorrow_ds': '2022-01-04', 'tomorrow_ds_nodash': '20220104', 'ts': '2022-01-03T00:00:00+00:00', 'ts_nodash': '20220103T000000', 'ts_nodash_with_tz': '20220103T000000+0000', 'var': {'json': None, 'value': None}, 'conn': None, 'yesterday_ds': '2022-01-02', 'yesterday_ds_nodash': '20220102', 'key': 'value', 'ts_var': '2022-01-03T00:00:00+00:00', 'tsnodash_var': '20220103T000000', 'templates_dict': None}
[2022-01-24 18:02:56,886] {logging_mixin.py:109} INFO - ts:  2022-01-03 00:00:00+00:00
[2022-01-24 18:02:56,886] {logging_mixin.py:109} INFO - <class 'pandas._libs.tslibs.timestamps.Timestamp'>
[2022-01-24 18:02:56,886] {logging_mixin.py:109} INFO - Object created.
[2022-01-24 18:02:56,886] {logging_mixin.py:109} INFO - 2022 1 3
[2022-01-24 18:02:56,886] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-3.json
[2022-01-24 18:02:56,887] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-19.json
[2022-01-24 18:02:56,887] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-49.json
[2022-01-24 18:02:56,887] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-45.json
[2022-01-24 18:02:56,887] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-7.json
[2022-01-24 18:02:56,887] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-54.json
[2022-01-24 18:02:56,887] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-75.json
[2022-01-24 18:02:56,887] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-60.json
[2022-01-24 18:02:56,887] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-83.json
[2022-01-24 18:02:56,887] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-13.json
[2022-01-24 18:02:56,888] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-2.json
[2022-01-24 18:02:56,888] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-59.json
[2022-01-24 18:02:56,888] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-71.json
[2022-01-24 18:02:56,888] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-8.json
[2022-01-24 18:02:56,888] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-40.json
[2022-01-24 18:02:56,888] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-39.json
[2022-01-24 18:02:56,888] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-65.json
[2022-01-24 18:02:56,888] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-86.json
[2022-01-24 18:02:56,888] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-18.json
[2022-01-24 18:02:56,888] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-27.json
[2022-01-24 18:02:56,888] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-51.json
[2022-01-24 18:02:56,888] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-16.json
[2022-01-24 18:02:56,889] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-4.json
[2022-01-24 18:02:56,889] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-62.json
[2022-01-24 18:02:56,889] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-68.json
[2022-01-24 18:02:56,889] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-78.json
[2022-01-24 18:02:56,889] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-33.json
[2022-01-24 18:02:56,889] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-41.json
[2022-01-24 18:02:56,889] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-69.json
[2022-01-24 18:02:56,889] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-0.json
[2022-01-24 18:02:56,889] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-21.json
[2022-01-24 18:02:56,889] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-47.json
[2022-01-24 18:02:56,889] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-9.json
[2022-01-24 18:02:56,889] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-80.json
[2022-01-24 18:02:56,890] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-70.json
[2022-01-24 18:02:56,890] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-6.json
[2022-01-24 18:02:56,890] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-87.json
[2022-01-24 18:02:56,890] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-66.json
[2022-01-24 18:02:56,890] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-43.json
[2022-01-24 18:02:56,890] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-46.json
[2022-01-24 18:02:56,890] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-25.json
[2022-01-24 18:02:56,890] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-17.json
[2022-01-24 18:02:56,890] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-85.json
[2022-01-24 18:02:56,890] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-35.json
[2022-01-24 18:02:56,890] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-22.json
[2022-01-24 18:02:56,891] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-15.json
[2022-01-24 18:02:56,891] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-53.json
[2022-01-24 18:02:56,891] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-14.json
[2022-01-24 18:02:56,891] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-1.json
[2022-01-24 18:02:56,891] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-72.json
[2022-01-24 18:02:56,891] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-64.json
[2022-01-24 18:02:56,891] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-28.json
[2022-01-24 18:02:56,891] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-12.json
[2022-01-24 18:02:56,891] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-20.json
[2022-01-24 18:02:56,891] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-61.json
[2022-01-24 18:02:56,891] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-56.json
[2022-01-24 18:02:56,891] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-42.json
[2022-01-24 18:02:56,892] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-50.json
[2022-01-24 18:02:56,892] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-58.json
[2022-01-24 18:02:56,892] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-77.json
[2022-01-24 18:02:56,892] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-52.json
[2022-01-24 18:02:56,892] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-79.json
[2022-01-24 18:02:56,892] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-36.json
[2022-01-24 18:02:56,892] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-24.json
[2022-01-24 18:02:56,892] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-23.json
[2022-01-24 18:02:56,892] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-81.json
[2022-01-24 18:02:56,893] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-37.json
[2022-01-24 18:02:56,893] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-74.json
[2022-01-24 18:02:56,893] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-48.json
[2022-01-24 18:02:56,893] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-57.json
[2022-01-24 18:02:56,893] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-34.json
[2022-01-24 18:02:56,893] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-32.json
[2022-01-24 18:02:56,893] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-63.json
[2022-01-24 18:02:56,894] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-5.json
[2022-01-24 18:02:56,894] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-84.json
[2022-01-24 18:02:56,894] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-73.json
[2022-01-24 18:02:56,894] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-30.json
[2022-01-24 18:02:56,894] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-10.json
[2022-01-24 18:02:56,894] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-29.json
[2022-01-24 18:02:56,894] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-38.json
[2022-01-24 18:02:56,894] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-44.json
[2022-01-24 18:02:56,894] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-31.json
[2022-01-24 18:02:56,894] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-11.json
[2022-01-24 18:02:56,894] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-67.json
[2022-01-24 18:02:56,895] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-26.json
[2022-01-24 18:02:56,895] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-82.json
[2022-01-24 18:02:56,895] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-76.json
[2022-01-24 18:02:56,895] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-55.json
[2022-01-24 18:02:56,897] {logging_mixin.py:109} INFO - 88
[2022-01-24 18:02:56,912] {logging_mixin.py:109} INFO -      invoice_id    invoice_timestamp  customer_id  ...  qty is_discount       price
0   20220103-11  2022-01-03T20:18:17  swibheb5634  ...  184           0  11439.2800
1   20220103-26  2022-01-03T14:44:24  mcbdghx4658  ...   34           1    111.7376
2   20220103-53  2022-01-03T02:37:16  dheanrq4135  ...   72           1   4212.4320
3    20220103-5  2022-01-03T00:59:19  okehqjl1310  ...   61           1   2866.6584
4   20220103-15  2022-01-03T01:43:15  wkigwzj3895  ...   40           0    507.6000
..          ...                  ...          ...  ...  ...         ...         ...
83   20220103-7  2022-01-03T17:17:57  fdstekl3454  ...  217           1  10054.0440
84  20220103-32  2022-01-03T23:20:38  ohzbsfe1717  ...  293           1   3197.6262
85  20220103-83  2022-01-03T04:43:11  ojxlnok1963  ...  286           0  11042.4600
86  20220103-78  2022-01-03T05:34:33  okejdpd4001  ...    2           1     56.3706
87  20220103-59  2022-01-03T12:44:15  vovqlzc2954  ...   87           1   3549.2781

[88 rows x 8 columns]
[2022-01-24 18:02:56,920] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: sales_dw, Login: awsuser, Password: ***, extra: {}
[2022-01-24 18:02:56,925] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: sales_dw, Login: awsuser, Password: ***, extra: {}
[2022-01-24 18:03:11,672] {python.py:175} INFO - Done. Returned value was: None
[2022-01-24 18:03:11,689] {taskinstance.py:1277} INFO - Marking task as SUCCESS. dag_id=datawarehouse_etl, task_id=load_invoices, execution_date=20220103T000000, start_date=20220124T180256, end_date=20220124T180311
[2022-01-24 18:03:11,727] {local_task_job.py:154} INFO - Task exited with return code 0
[2022-01-24 18:03:11,758] {local_task_job.py:264} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2022-01-24 18:10:35,497] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [queued]>
[2022-01-24 18:10:35,511] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [queued]>
[2022-01-24 18:10:35,512] {taskinstance.py:1238} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 18:10:35,512] {taskinstance.py:1239} INFO - Starting attempt 1 of 1
[2022-01-24 18:10:35,512] {taskinstance.py:1240} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 18:10:35,524] {taskinstance.py:1259} INFO - Executing <Task(PythonOperator): load_invoices> on 2022-01-03 00:00:00+00:00
[2022-01-24 18:10:35,531] {standard_task_runner.py:52} INFO - Started process 2064 to run task
[2022-01-24 18:10:35,536] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'datawarehouse_etl', 'load_invoices', 'scheduled__2022-01-03T00:00:00+00:00', '--job-id', '110', '--raw', '--subdir', 'DAGS_FOLDER/datawarehouse_***.py', '--cfg-path', '/tmp/tmpk79ahqxz', '--error-file', '/tmp/tmpsfvnv_ui']
[2022-01-24 18:10:35,538] {standard_task_runner.py:77} INFO - Job 110: Subtask load_invoices
[2022-01-24 18:10:35,720] {logging_mixin.py:109} INFO - Running <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [running]> on host cd9bb47288d1
[2022-01-24 18:10:35,781] {taskinstance.py:1426} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=datawarehouse_etl
AIRFLOW_CTX_TASK_ID=load_invoices
AIRFLOW_CTX_EXECUTION_DATE=2022-01-03T00:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-01-03T00:00:00+00:00
[2022-01-24 18:10:35,782] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:10:35,782] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:10:35,783] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds_nodash' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds_nodash }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:10:35,783] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_end' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:10:35,783] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:10:35,783] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:10:35,783] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:10:35,783] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date_success' from the template is deprecated and will be removed in a future version. Please use 'prev_data_interval_start_success' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:10:35,784] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:10:35,784] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:10:35,784] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:10:35,784] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:10:35,784] {logging_mixin.py:109} INFO - {'conf': <***.configuration.AirflowConfigParser object at 0x7f76fb23ca90>, 'dag': <DAG: datawarehouse_etl>, 'dag_run': <DagRun datawarehouse_etl @ 2022-01-03 00:00:00+00:00: scheduled__2022-01-03T00:00:00+00:00, externally triggered: False>, 'data_interval_end': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'data_interval_start': DateTime(2022, 1, 3, 0, 0, 0, tzinfo=Timezone('UTC')), 'ds': '2022-01-03', 'ds_nodash': '20220103', 'execution_date': DateTime(2022, 1, 3, 0, 0, 0, tzinfo=Timezone('UTC')), 'inlets': [], 'logical_date': DateTime(2022, 1, 3, 0, 0, 0, tzinfo=Timezone('UTC')), 'macros': <module '***.macros' from '/home/***/.local/lib/python3.7/site-packages/***/macros/__init__.py'>, 'next_ds': '2022-01-04', 'next_ds_nodash': '20220104', 'next_execution_date': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'outlets': [], 'params': {}, 'prev_data_interval_start_success': None, 'prev_data_interval_end_success': None, 'prev_ds': '2022-01-02', 'prev_ds_nodash': '20220102', 'prev_execution_date': datetime.datetime(2022, 1, 2, 0, 0, tzinfo=Timezone('UTC')), 'prev_execution_date_success': None, 'prev_start_date_success': None, 'run_id': 'scheduled__2022-01-03T00:00:00+00:00', 'task': <Task(PythonOperator): load_invoices>, 'task_instance': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [running]>, 'task_instance_key_str': 'datawarehouse_etl__load_invoices__20220103', 'test_mode': False, 'ti': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [running]>, 'tomorrow_ds': '2022-01-04', 'tomorrow_ds_nodash': '20220104', 'ts': '2022-01-03T00:00:00+00:00', 'ts_nodash': '20220103T000000', 'ts_nodash_with_tz': '20220103T000000+0000', 'var': {'json': None, 'value': None}, 'conn': None, 'yesterday_ds': '2022-01-02', 'yesterday_ds_nodash': '20220102', 'key': 'value', 'ts_var': '2022-01-03T00:00:00+00:00', 'tsnodash_var': '20220103T000000', 'templates_dict': None}
[2022-01-24 18:10:35,786] {logging_mixin.py:109} INFO - ts:  2022-01-03 00:00:00+00:00
[2022-01-24 18:10:35,786] {logging_mixin.py:109} INFO - <class 'pandas._libs.tslibs.timestamps.Timestamp'>
[2022-01-24 18:10:35,786] {logging_mixin.py:109} INFO - Object created.
[2022-01-24 18:10:35,786] {logging_mixin.py:109} INFO - 2022 1 3
[2022-01-24 18:10:35,787] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-3.json
[2022-01-24 18:10:35,787] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-19.json
[2022-01-24 18:10:35,787] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-49.json
[2022-01-24 18:10:35,787] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-45.json
[2022-01-24 18:10:35,787] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-7.json
[2022-01-24 18:10:35,788] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-54.json
[2022-01-24 18:10:35,788] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-75.json
[2022-01-24 18:10:35,788] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-60.json
[2022-01-24 18:10:35,788] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-83.json
[2022-01-24 18:10:35,788] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-13.json
[2022-01-24 18:10:35,788] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-2.json
[2022-01-24 18:10:35,788] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-59.json
[2022-01-24 18:10:35,788] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-71.json
[2022-01-24 18:10:35,789] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-8.json
[2022-01-24 18:10:35,789] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-40.json
[2022-01-24 18:10:35,789] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-39.json
[2022-01-24 18:10:35,789] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-65.json
[2022-01-24 18:10:35,789] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-86.json
[2022-01-24 18:10:35,789] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-18.json
[2022-01-24 18:10:35,789] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-27.json
[2022-01-24 18:10:35,790] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-51.json
[2022-01-24 18:10:35,790] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-16.json
[2022-01-24 18:10:35,790] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-4.json
[2022-01-24 18:10:35,790] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-62.json
[2022-01-24 18:10:35,790] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-68.json
[2022-01-24 18:10:35,790] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-78.json
[2022-01-24 18:10:35,790] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-33.json
[2022-01-24 18:10:35,790] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-41.json
[2022-01-24 18:10:35,790] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-69.json
[2022-01-24 18:10:35,790] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-0.json
[2022-01-24 18:10:35,790] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-21.json
[2022-01-24 18:10:35,791] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-47.json
[2022-01-24 18:10:35,791] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-9.json
[2022-01-24 18:10:35,791] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-80.json
[2022-01-24 18:10:35,791] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-70.json
[2022-01-24 18:10:35,791] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-6.json
[2022-01-24 18:10:35,791] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-87.json
[2022-01-24 18:10:35,791] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-66.json
[2022-01-24 18:10:35,791] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-43.json
[2022-01-24 18:10:35,791] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-46.json
[2022-01-24 18:10:35,791] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-25.json
[2022-01-24 18:10:35,791] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-17.json
[2022-01-24 18:10:35,792] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-85.json
[2022-01-24 18:10:35,792] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-35.json
[2022-01-24 18:10:35,792] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-22.json
[2022-01-24 18:10:35,792] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-15.json
[2022-01-24 18:10:35,792] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-53.json
[2022-01-24 18:10:35,792] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-14.json
[2022-01-24 18:10:35,792] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-1.json
[2022-01-24 18:10:35,792] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-72.json
[2022-01-24 18:10:35,792] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-64.json
[2022-01-24 18:10:35,792] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-28.json
[2022-01-24 18:10:35,792] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-12.json
[2022-01-24 18:10:35,793] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-20.json
[2022-01-24 18:10:35,793] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-61.json
[2022-01-24 18:10:35,793] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-56.json
[2022-01-24 18:10:35,793] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-42.json
[2022-01-24 18:10:35,793] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-50.json
[2022-01-24 18:10:35,793] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-58.json
[2022-01-24 18:10:35,793] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-77.json
[2022-01-24 18:10:35,793] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-52.json
[2022-01-24 18:10:35,793] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-79.json
[2022-01-24 18:10:35,793] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-36.json
[2022-01-24 18:10:35,793] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-24.json
[2022-01-24 18:10:35,793] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-23.json
[2022-01-24 18:10:35,793] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-81.json
[2022-01-24 18:10:35,794] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-37.json
[2022-01-24 18:10:35,794] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-74.json
[2022-01-24 18:10:35,794] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-48.json
[2022-01-24 18:10:35,794] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-57.json
[2022-01-24 18:10:35,794] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-34.json
[2022-01-24 18:10:35,794] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-32.json
[2022-01-24 18:10:35,794] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-63.json
[2022-01-24 18:10:35,794] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-5.json
[2022-01-24 18:10:35,794] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-84.json
[2022-01-24 18:10:35,794] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-73.json
[2022-01-24 18:10:35,794] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-30.json
[2022-01-24 18:10:35,794] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-10.json
[2022-01-24 18:10:35,795] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-29.json
[2022-01-24 18:10:35,795] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-38.json
[2022-01-24 18:10:35,795] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-44.json
[2022-01-24 18:10:35,795] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-31.json
[2022-01-24 18:10:35,795] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-11.json
[2022-01-24 18:10:35,795] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-67.json
[2022-01-24 18:10:35,795] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-26.json
[2022-01-24 18:10:35,795] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-82.json
[2022-01-24 18:10:35,795] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-76.json
[2022-01-24 18:10:35,795] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-55.json
[2022-01-24 18:10:35,797] {logging_mixin.py:109} INFO - 88
[2022-01-24 18:10:35,811] {logging_mixin.py:109} INFO -      invoice_id    invoice_timestamp  customer_id  ...  qty is_discount       price
0   20220103-11  2022-01-03T20:18:17  swibheb5634  ...  184           0  11439.2800
1   20220103-26  2022-01-03T14:44:24  mcbdghx4658  ...   34           1    111.7376
2   20220103-53  2022-01-03T02:37:16  dheanrq4135  ...   72           1   4212.4320
3    20220103-5  2022-01-03T00:59:19  okehqjl1310  ...   61           1   2866.6584
4   20220103-15  2022-01-03T01:43:15  wkigwzj3895  ...   40           0    507.6000
..          ...                  ...          ...  ...  ...         ...         ...
83   20220103-7  2022-01-03T17:17:57  fdstekl3454  ...  217           1  10054.0440
84  20220103-32  2022-01-03T23:20:38  ohzbsfe1717  ...  293           1   3197.6262
85  20220103-83  2022-01-03T04:43:11  ojxlnok1963  ...  286           0  11042.4600
86  20220103-78  2022-01-03T05:34:33  okejdpd4001  ...    2           1     56.3706
87  20220103-59  2022-01-03T12:44:15  vovqlzc2954  ...   87           1   3549.2781

[88 rows x 8 columns]
[2022-01-24 18:10:35,820] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: sales_dw, Login: awsuser, Password: ***, extra: {}
[2022-01-24 18:10:35,827] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: sales_dw, Login: awsuser, Password: ***, extra: {}
[2022-01-24 18:10:49,276] {python.py:175} INFO - Done. Returned value was: None
[2022-01-24 18:10:49,314] {taskinstance.py:1277} INFO - Marking task as SUCCESS. dag_id=datawarehouse_etl, task_id=load_invoices, execution_date=20220103T000000, start_date=20220124T181035, end_date=20220124T181049
[2022-01-24 18:10:49,368] {local_task_job.py:154} INFO - Task exited with return code 0
[2022-01-24 18:10:49,403] {local_task_job.py:264} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2022-01-24 18:11:06,055] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [queued]>
[2022-01-24 18:11:06,069] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [queued]>
[2022-01-24 18:11:06,069] {taskinstance.py:1238} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 18:11:06,069] {taskinstance.py:1239} INFO - Starting attempt 1 of 1
[2022-01-24 18:11:06,069] {taskinstance.py:1240} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 18:11:06,081] {taskinstance.py:1259} INFO - Executing <Task(PythonOperator): load_invoices> on 2022-01-03 00:00:00+00:00
[2022-01-24 18:11:06,085] {standard_task_runner.py:52} INFO - Started process 2101 to run task
[2022-01-24 18:11:06,088] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'datawarehouse_etl', 'load_invoices', 'scheduled__2022-01-03T00:00:00+00:00', '--job-id', '116', '--raw', '--subdir', 'DAGS_FOLDER/datawarehouse_***.py', '--cfg-path', '/tmp/tmpa7b6y23z', '--error-file', '/tmp/tmphvnkre9k']
[2022-01-24 18:11:06,088] {standard_task_runner.py:77} INFO - Job 116: Subtask load_invoices
[2022-01-24 18:11:06,129] {logging_mixin.py:109} INFO - Running <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [running]> on host cd9bb47288d1
[2022-01-24 18:11:06,167] {taskinstance.py:1426} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=datawarehouse_etl
AIRFLOW_CTX_TASK_ID=load_invoices
AIRFLOW_CTX_EXECUTION_DATE=2022-01-03T00:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-01-03T00:00:00+00:00
[2022-01-24 18:11:06,168] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:11:06,168] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:11:06,168] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds_nodash' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds_nodash }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:11:06,168] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_end' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:11:06,168] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:11:06,169] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:11:06,169] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:11:06,169] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date_success' from the template is deprecated and will be removed in a future version. Please use 'prev_data_interval_start_success' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:11:06,169] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:11:06,169] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:11:06,169] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:11:06,169] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:11:06,169] {logging_mixin.py:109} INFO - {'conf': <***.configuration.AirflowConfigParser object at 0x7f76fb23ca90>, 'dag': <DAG: datawarehouse_etl>, 'dag_run': <DagRun datawarehouse_etl @ 2022-01-03 00:00:00+00:00: scheduled__2022-01-03T00:00:00+00:00, externally triggered: False>, 'data_interval_end': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'data_interval_start': DateTime(2022, 1, 3, 0, 0, 0, tzinfo=Timezone('UTC')), 'ds': '2022-01-03', 'ds_nodash': '20220103', 'execution_date': DateTime(2022, 1, 3, 0, 0, 0, tzinfo=Timezone('UTC')), 'inlets': [], 'logical_date': DateTime(2022, 1, 3, 0, 0, 0, tzinfo=Timezone('UTC')), 'macros': <module '***.macros' from '/home/***/.local/lib/python3.7/site-packages/***/macros/__init__.py'>, 'next_ds': '2022-01-04', 'next_ds_nodash': '20220104', 'next_execution_date': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'outlets': [], 'params': {}, 'prev_data_interval_start_success': None, 'prev_data_interval_end_success': None, 'prev_ds': '2022-01-02', 'prev_ds_nodash': '20220102', 'prev_execution_date': datetime.datetime(2022, 1, 2, 0, 0, tzinfo=Timezone('UTC')), 'prev_execution_date_success': None, 'prev_start_date_success': None, 'run_id': 'scheduled__2022-01-03T00:00:00+00:00', 'task': <Task(PythonOperator): load_invoices>, 'task_instance': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [running]>, 'task_instance_key_str': 'datawarehouse_etl__load_invoices__20220103', 'test_mode': False, 'ti': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [running]>, 'tomorrow_ds': '2022-01-04', 'tomorrow_ds_nodash': '20220104', 'ts': '2022-01-03T00:00:00+00:00', 'ts_nodash': '20220103T000000', 'ts_nodash_with_tz': '20220103T000000+0000', 'var': {'json': None, 'value': None}, 'conn': None, 'yesterday_ds': '2022-01-02', 'yesterday_ds_nodash': '20220102', 'key': 'value', 'ts_var': '2022-01-03T00:00:00+00:00', 'tsnodash_var': '20220103T000000', 'templates_dict': None}
[2022-01-24 18:11:06,171] {logging_mixin.py:109} INFO - ts:  2022-01-03 00:00:00+00:00
[2022-01-24 18:11:06,171] {logging_mixin.py:109} INFO - <class 'pandas._libs.tslibs.timestamps.Timestamp'>
[2022-01-24 18:11:06,171] {logging_mixin.py:109} INFO - Object created.
[2022-01-24 18:11:06,171] {logging_mixin.py:109} INFO - 2022 1 3
[2022-01-24 18:11:06,171] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-3.json
[2022-01-24 18:11:06,172] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-19.json
[2022-01-24 18:11:06,172] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-49.json
[2022-01-24 18:11:06,172] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-45.json
[2022-01-24 18:11:06,172] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-7.json
[2022-01-24 18:11:06,173] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-54.json
[2022-01-24 18:11:06,173] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-75.json
[2022-01-24 18:11:06,173] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-60.json
[2022-01-24 18:11:06,173] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-83.json
[2022-01-24 18:11:06,173] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-13.json
[2022-01-24 18:11:06,174] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-2.json
[2022-01-24 18:11:06,174] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-59.json
[2022-01-24 18:11:06,174] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-71.json
[2022-01-24 18:11:06,174] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-8.json
[2022-01-24 18:11:06,174] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-40.json
[2022-01-24 18:11:06,175] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-39.json
[2022-01-24 18:11:06,175] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-65.json
[2022-01-24 18:11:06,175] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-86.json
[2022-01-24 18:11:06,175] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-18.json
[2022-01-24 18:11:06,175] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-27.json
[2022-01-24 18:11:06,175] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-51.json
[2022-01-24 18:11:06,176] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-16.json
[2022-01-24 18:11:06,176] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-4.json
[2022-01-24 18:11:06,176] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-62.json
[2022-01-24 18:11:06,176] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-68.json
[2022-01-24 18:11:06,177] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-78.json
[2022-01-24 18:11:06,177] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-33.json
[2022-01-24 18:11:06,177] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-41.json
[2022-01-24 18:11:06,177] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-69.json
[2022-01-24 18:11:06,177] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-0.json
[2022-01-24 18:11:06,178] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-21.json
[2022-01-24 18:11:06,178] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-47.json
[2022-01-24 18:11:06,178] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-9.json
[2022-01-24 18:11:06,178] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-80.json
[2022-01-24 18:11:06,178] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-70.json
[2022-01-24 18:11:06,179] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-6.json
[2022-01-24 18:11:06,179] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-87.json
[2022-01-24 18:11:06,179] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-66.json
[2022-01-24 18:11:06,179] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-43.json
[2022-01-24 18:11:06,179] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-46.json
[2022-01-24 18:11:06,179] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-25.json
[2022-01-24 18:11:06,180] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-17.json
[2022-01-24 18:11:06,180] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-85.json
[2022-01-24 18:11:06,180] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-35.json
[2022-01-24 18:11:06,180] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-22.json
[2022-01-24 18:11:06,180] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-15.json
[2022-01-24 18:11:06,181] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-53.json
[2022-01-24 18:11:06,181] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-14.json
[2022-01-24 18:11:06,181] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-1.json
[2022-01-24 18:11:06,181] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-72.json
[2022-01-24 18:11:06,181] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-64.json
[2022-01-24 18:11:06,181] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-28.json
[2022-01-24 18:11:06,182] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-12.json
[2022-01-24 18:11:06,182] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-20.json
[2022-01-24 18:11:06,182] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-61.json
[2022-01-24 18:11:06,182] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-56.json
[2022-01-24 18:11:06,182] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-42.json
[2022-01-24 18:11:06,183] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-50.json
[2022-01-24 18:11:06,183] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-58.json
[2022-01-24 18:11:06,183] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-77.json
[2022-01-24 18:11:06,183] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-52.json
[2022-01-24 18:11:06,183] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-79.json
[2022-01-24 18:11:06,184] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-36.json
[2022-01-24 18:11:06,184] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-24.json
[2022-01-24 18:11:06,184] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-23.json
[2022-01-24 18:11:06,184] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-81.json
[2022-01-24 18:11:06,185] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-37.json
[2022-01-24 18:11:06,185] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-74.json
[2022-01-24 18:11:06,185] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-48.json
[2022-01-24 18:11:06,185] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-57.json
[2022-01-24 18:11:06,185] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-34.json
[2022-01-24 18:11:06,185] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-32.json
[2022-01-24 18:11:06,186] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-63.json
[2022-01-24 18:11:06,186] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-5.json
[2022-01-24 18:11:06,186] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-84.json
[2022-01-24 18:11:06,186] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-73.json
[2022-01-24 18:11:06,186] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-30.json
[2022-01-24 18:11:06,186] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-10.json
[2022-01-24 18:11:06,187] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-29.json
[2022-01-24 18:11:06,187] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-38.json
[2022-01-24 18:11:06,187] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-44.json
[2022-01-24 18:11:06,187] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-31.json
[2022-01-24 18:11:06,187] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-11.json
[2022-01-24 18:11:06,188] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-67.json
[2022-01-24 18:11:06,188] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-26.json
[2022-01-24 18:11:06,188] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-82.json
[2022-01-24 18:11:06,188] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-76.json
[2022-01-24 18:11:06,188] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-55.json
[2022-01-24 18:11:06,190] {logging_mixin.py:109} INFO - 88
[2022-01-24 18:11:06,208] {logging_mixin.py:109} INFO -      invoice_id    invoice_timestamp  customer_id  ...  qty is_discount       price
0   20220103-11  2022-01-03T20:18:17  swibheb5634  ...  184           0  11439.2800
1   20220103-26  2022-01-03T14:44:24  mcbdghx4658  ...   34           1    111.7376
2   20220103-53  2022-01-03T02:37:16  dheanrq4135  ...   72           1   4212.4320
3    20220103-5  2022-01-03T00:59:19  okehqjl1310  ...   61           1   2866.6584
4   20220103-15  2022-01-03T01:43:15  wkigwzj3895  ...   40           0    507.6000
..          ...                  ...          ...  ...  ...         ...         ...
83   20220103-7  2022-01-03T17:17:57  fdstekl3454  ...  217           1  10054.0440
84  20220103-32  2022-01-03T23:20:38  ohzbsfe1717  ...  293           1   3197.6262
85  20220103-83  2022-01-03T04:43:11  ojxlnok1963  ...  286           0  11042.4600
86  20220103-78  2022-01-03T05:34:33  okejdpd4001  ...    2           1     56.3706
87  20220103-59  2022-01-03T12:44:15  vovqlzc2954  ...   87           1   3549.2781

[88 rows x 8 columns]
[2022-01-24 18:11:06,217] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: sales_dw, Login: awsuser, Password: ***, extra: {}
[2022-01-24 18:11:06,224] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: sales_dw, Login: awsuser, Password: ***, extra: {}
[2022-01-24 18:11:20,645] {python.py:175} INFO - Done. Returned value was: None
[2022-01-24 18:11:20,654] {taskinstance.py:1277} INFO - Marking task as SUCCESS. dag_id=datawarehouse_etl, task_id=load_invoices, execution_date=20220103T000000, start_date=20220124T181106, end_date=20220124T181120
[2022-01-24 18:11:20,683] {local_task_job.py:154} INFO - Task exited with return code 0
[2022-01-24 18:11:20,713] {local_task_job.py:264} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2022-01-24 18:16:57,721] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [queued]>
[2022-01-24 18:16:57,738] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [queued]>
[2022-01-24 18:16:57,738] {taskinstance.py:1238} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 18:16:57,738] {taskinstance.py:1239} INFO - Starting attempt 1 of 1
[2022-01-24 18:16:57,738] {taskinstance.py:1240} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 18:16:57,748] {taskinstance.py:1259} INFO - Executing <Task(PythonOperator): load_invoices> on 2022-01-03 00:00:00+00:00
[2022-01-24 18:16:57,772] {standard_task_runner.py:52} INFO - Started process 2393 to run task
[2022-01-24 18:16:57,776] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'datawarehouse_etl', 'load_invoices', 'scheduled__2022-01-03T00:00:00+00:00', '--job-id', '123', '--raw', '--subdir', 'DAGS_FOLDER/datawarehouse_***.py', '--cfg-path', '/tmp/tmpoe7foww4', '--error-file', '/tmp/tmpjrsodc92']
[2022-01-24 18:16:57,776] {standard_task_runner.py:77} INFO - Job 123: Subtask load_invoices
[2022-01-24 18:16:57,814] {logging_mixin.py:109} INFO - Running <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [running]> on host cd9bb47288d1
[2022-01-24 18:16:57,858] {taskinstance.py:1426} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=datawarehouse_etl
AIRFLOW_CTX_TASK_ID=load_invoices
AIRFLOW_CTX_EXECUTION_DATE=2022-01-03T00:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-01-03T00:00:00+00:00
[2022-01-24 18:16:57,859] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:16:57,860] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:16:57,860] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds_nodash' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds_nodash }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:16:57,860] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_end' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:16:57,860] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:16:57,860] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:16:57,860] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:16:57,860] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date_success' from the template is deprecated and will be removed in a future version. Please use 'prev_data_interval_start_success' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:16:57,860] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:16:57,860] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:16:57,860] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:16:57,860] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:16:57,861] {logging_mixin.py:109} INFO - {'conf': <***.configuration.AirflowConfigParser object at 0x7f76fb23ca90>, 'dag': <DAG: datawarehouse_etl>, 'dag_run': <DagRun datawarehouse_etl @ 2022-01-03 00:00:00+00:00: scheduled__2022-01-03T00:00:00+00:00, externally triggered: False>, 'data_interval_end': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'data_interval_start': DateTime(2022, 1, 3, 0, 0, 0, tzinfo=Timezone('UTC')), 'ds': '2022-01-03', 'ds_nodash': '20220103', 'execution_date': DateTime(2022, 1, 3, 0, 0, 0, tzinfo=Timezone('UTC')), 'inlets': [], 'logical_date': DateTime(2022, 1, 3, 0, 0, 0, tzinfo=Timezone('UTC')), 'macros': <module '***.macros' from '/home/***/.local/lib/python3.7/site-packages/***/macros/__init__.py'>, 'next_ds': '2022-01-04', 'next_ds_nodash': '20220104', 'next_execution_date': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'outlets': [], 'params': {}, 'prev_data_interval_start_success': None, 'prev_data_interval_end_success': None, 'prev_ds': '2022-01-02', 'prev_ds_nodash': '20220102', 'prev_execution_date': datetime.datetime(2022, 1, 2, 0, 0, tzinfo=Timezone('UTC')), 'prev_execution_date_success': None, 'prev_start_date_success': None, 'run_id': 'scheduled__2022-01-03T00:00:00+00:00', 'task': <Task(PythonOperator): load_invoices>, 'task_instance': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [running]>, 'task_instance_key_str': 'datawarehouse_etl__load_invoices__20220103', 'test_mode': False, 'ti': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [running]>, 'tomorrow_ds': '2022-01-04', 'tomorrow_ds_nodash': '20220104', 'ts': '2022-01-03T00:00:00+00:00', 'ts_nodash': '20220103T000000', 'ts_nodash_with_tz': '20220103T000000+0000', 'var': {'json': None, 'value': None}, 'conn': None, 'yesterday_ds': '2022-01-02', 'yesterday_ds_nodash': '20220102', 'key': 'value', 'ts_var': '2022-01-03T00:00:00+00:00', 'tsnodash_var': '20220103T000000', 'templates_dict': None}
[2022-01-24 18:16:57,862] {logging_mixin.py:109} INFO - ts:  2022-01-03 00:00:00+00:00
[2022-01-24 18:16:57,862] {logging_mixin.py:109} INFO - <class 'pandas._libs.tslibs.timestamps.Timestamp'>
[2022-01-24 18:16:57,862] {logging_mixin.py:109} INFO - Object created.
[2022-01-24 18:16:57,862] {logging_mixin.py:109} INFO - 2022 1 3
[2022-01-24 18:16:57,862] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-3.json
[2022-01-24 18:16:57,863] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-19.json
[2022-01-24 18:16:57,863] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-49.json
[2022-01-24 18:16:57,863] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-45.json
[2022-01-24 18:16:57,863] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-7.json
[2022-01-24 18:16:57,863] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-54.json
[2022-01-24 18:16:57,863] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-75.json
[2022-01-24 18:16:57,863] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-60.json
[2022-01-24 18:16:57,863] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-83.json
[2022-01-24 18:16:57,863] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-13.json
[2022-01-24 18:16:57,864] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-2.json
[2022-01-24 18:16:57,864] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-59.json
[2022-01-24 18:16:57,864] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-71.json
[2022-01-24 18:16:57,864] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-8.json
[2022-01-24 18:16:57,864] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-40.json
[2022-01-24 18:16:57,864] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-39.json
[2022-01-24 18:16:57,864] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-65.json
[2022-01-24 18:16:57,864] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-86.json
[2022-01-24 18:16:57,864] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-18.json
[2022-01-24 18:16:57,864] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-27.json
[2022-01-24 18:16:57,865] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-51.json
[2022-01-24 18:16:57,865] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-16.json
[2022-01-24 18:16:57,865] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-4.json
[2022-01-24 18:16:57,865] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-62.json
[2022-01-24 18:16:57,865] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-68.json
[2022-01-24 18:16:57,865] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-78.json
[2022-01-24 18:16:57,865] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-33.json
[2022-01-24 18:16:57,865] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-41.json
[2022-01-24 18:16:57,865] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-69.json
[2022-01-24 18:16:57,865] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-0.json
[2022-01-24 18:16:57,865] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-21.json
[2022-01-24 18:16:57,866] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-47.json
[2022-01-24 18:16:57,866] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-9.json
[2022-01-24 18:16:57,866] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-80.json
[2022-01-24 18:16:57,866] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-70.json
[2022-01-24 18:16:57,866] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-6.json
[2022-01-24 18:16:57,866] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-87.json
[2022-01-24 18:16:57,866] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-66.json
[2022-01-24 18:16:57,866] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-43.json
[2022-01-24 18:16:57,866] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-46.json
[2022-01-24 18:16:57,866] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-25.json
[2022-01-24 18:16:57,866] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-17.json
[2022-01-24 18:16:57,866] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-85.json
[2022-01-24 18:16:57,866] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-35.json
[2022-01-24 18:16:57,867] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-22.json
[2022-01-24 18:16:57,867] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-15.json
[2022-01-24 18:16:57,867] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-53.json
[2022-01-24 18:16:57,867] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-14.json
[2022-01-24 18:16:57,867] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-1.json
[2022-01-24 18:16:57,867] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-72.json
[2022-01-24 18:16:57,867] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-64.json
[2022-01-24 18:16:57,867] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-28.json
[2022-01-24 18:16:57,867] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-12.json
[2022-01-24 18:16:57,867] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-20.json
[2022-01-24 18:16:57,867] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-61.json
[2022-01-24 18:16:57,868] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-56.json
[2022-01-24 18:16:57,868] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-42.json
[2022-01-24 18:16:57,868] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-50.json
[2022-01-24 18:16:57,868] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-58.json
[2022-01-24 18:16:57,868] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-77.json
[2022-01-24 18:16:57,868] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-52.json
[2022-01-24 18:16:57,868] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-79.json
[2022-01-24 18:16:57,868] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-36.json
[2022-01-24 18:16:57,868] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-24.json
[2022-01-24 18:16:57,868] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-23.json
[2022-01-24 18:16:57,868] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-81.json
[2022-01-24 18:16:57,868] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-37.json
[2022-01-24 18:16:57,869] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-74.json
[2022-01-24 18:16:57,869] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-48.json
[2022-01-24 18:16:57,869] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-57.json
[2022-01-24 18:16:57,869] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-34.json
[2022-01-24 18:16:57,869] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-32.json
[2022-01-24 18:16:57,869] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-63.json
[2022-01-24 18:16:57,869] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-5.json
[2022-01-24 18:16:57,869] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-84.json
[2022-01-24 18:16:57,869] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-73.json
[2022-01-24 18:16:57,869] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-30.json
[2022-01-24 18:16:57,869] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-10.json
[2022-01-24 18:16:57,870] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-29.json
[2022-01-24 18:16:57,870] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-38.json
[2022-01-24 18:16:57,870] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-44.json
[2022-01-24 18:16:57,870] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-31.json
[2022-01-24 18:16:57,870] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-11.json
[2022-01-24 18:16:57,870] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-67.json
[2022-01-24 18:16:57,870] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-26.json
[2022-01-24 18:16:57,870] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-82.json
[2022-01-24 18:16:57,870] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-76.json
[2022-01-24 18:16:57,870] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-55.json
[2022-01-24 18:16:57,872] {logging_mixin.py:109} INFO - 88
[2022-01-24 18:16:57,886] {logging_mixin.py:109} INFO -      invoice_id    invoice_timestamp  customer_id  ...  qty is_discount       price
0   20220103-11  2022-01-03T20:18:17  swibheb5634  ...  184           0  11439.2800
1   20220103-26  2022-01-03T14:44:24  mcbdghx4658  ...   34           1    111.7376
2   20220103-53  2022-01-03T02:37:16  dheanrq4135  ...   72           1   4212.4320
3    20220103-5  2022-01-03T00:59:19  okehqjl1310  ...   61           1   2866.6584
4   20220103-15  2022-01-03T01:43:15  wkigwzj3895  ...   40           0    507.6000
..          ...                  ...          ...  ...  ...         ...         ...
83   20220103-7  2022-01-03T17:17:57  fdstekl3454  ...  217           1  10054.0440
84  20220103-32  2022-01-03T23:20:38  ohzbsfe1717  ...  293           1   3197.6262
85  20220103-83  2022-01-03T04:43:11  ojxlnok1963  ...  286           0  11042.4600
86  20220103-78  2022-01-03T05:34:33  okejdpd4001  ...    2           1     56.3706
87  20220103-59  2022-01-03T12:44:15  vovqlzc2954  ...   87           1   3549.2781

[88 rows x 8 columns]
[2022-01-24 18:16:57,893] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: sales_dw, Login: awsuser, Password: ***, extra: {}
[2022-01-24 18:16:57,899] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: sales_dw, Login: awsuser, Password: ***, extra: {}
[2022-01-24 18:17:15,506] {python.py:175} INFO - Done. Returned value was: None
[2022-01-24 18:17:15,515] {taskinstance.py:1277} INFO - Marking task as SUCCESS. dag_id=datawarehouse_etl, task_id=load_invoices, execution_date=20220103T000000, start_date=20220124T181657, end_date=20220124T181715
[2022-01-24 18:17:15,541] {local_task_job.py:154} INFO - Task exited with return code 0
[2022-01-24 18:17:15,571] {local_task_job.py:264} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2022-01-24 18:40:51,151] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [queued]>
[2022-01-24 18:40:51,168] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [queued]>
[2022-01-24 18:40:51,169] {taskinstance.py:1238} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 18:40:51,169] {taskinstance.py:1239} INFO - Starting attempt 1 of 1
[2022-01-24 18:40:51,169] {taskinstance.py:1240} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 18:40:51,185] {taskinstance.py:1259} INFO - Executing <Task(PythonOperator): load_invoices> on 2022-01-03 00:00:00+00:00
[2022-01-24 18:40:51,194] {standard_task_runner.py:52} INFO - Started process 3500 to run task
[2022-01-24 18:40:51,197] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'datawarehouse_etl', 'load_invoices', 'scheduled__2022-01-03T00:00:00+00:00', '--job-id', '131', '--raw', '--subdir', 'DAGS_FOLDER/datawarehouse_***.py', '--cfg-path', '/tmp/tmpvyok_3zr', '--error-file', '/tmp/tmpncp8xugh']
[2022-01-24 18:40:51,197] {standard_task_runner.py:77} INFO - Job 131: Subtask load_invoices
[2022-01-24 18:40:51,276] {logging_mixin.py:109} INFO - Running <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [running]> on host cd9bb47288d1
[2022-01-24 18:40:51,378] {taskinstance.py:1426} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=datawarehouse_etl
AIRFLOW_CTX_TASK_ID=load_invoices
AIRFLOW_CTX_EXECUTION_DATE=2022-01-03T00:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-01-03T00:00:00+00:00
[2022-01-24 18:40:51,379] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:40:51,379] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:40:51,380] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds_nodash' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds_nodash }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:40:51,380] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_end' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:40:51,380] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:40:51,380] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:40:51,380] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:40:51,380] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date_success' from the template is deprecated and will be removed in a future version. Please use 'prev_data_interval_start_success' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:40:51,380] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:40:51,381] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:40:51,381] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:40:51,381] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:40:51,381] {logging_mixin.py:109} INFO - {'conf': <***.configuration.AirflowConfigParser object at 0x7f76fb23ca90>, 'dag': <DAG: datawarehouse_etl>, 'dag_run': <DagRun datawarehouse_etl @ 2022-01-03 00:00:00+00:00: scheduled__2022-01-03T00:00:00+00:00, externally triggered: False>, 'data_interval_end': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'data_interval_start': DateTime(2022, 1, 3, 0, 0, 0, tzinfo=Timezone('UTC')), 'ds': '2022-01-03', 'ds_nodash': '20220103', 'execution_date': DateTime(2022, 1, 3, 0, 0, 0, tzinfo=Timezone('UTC')), 'inlets': [], 'logical_date': DateTime(2022, 1, 3, 0, 0, 0, tzinfo=Timezone('UTC')), 'macros': <module '***.macros' from '/home/***/.local/lib/python3.7/site-packages/***/macros/__init__.py'>, 'next_ds': '2022-01-04', 'next_ds_nodash': '20220104', 'next_execution_date': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'outlets': [], 'params': {}, 'prev_data_interval_start_success': None, 'prev_data_interval_end_success': None, 'prev_ds': '2022-01-02', 'prev_ds_nodash': '20220102', 'prev_execution_date': datetime.datetime(2022, 1, 2, 0, 0, tzinfo=Timezone('UTC')), 'prev_execution_date_success': None, 'prev_start_date_success': None, 'run_id': 'scheduled__2022-01-03T00:00:00+00:00', 'task': <Task(PythonOperator): load_invoices>, 'task_instance': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [running]>, 'task_instance_key_str': 'datawarehouse_etl__load_invoices__20220103', 'test_mode': False, 'ti': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [running]>, 'tomorrow_ds': '2022-01-04', 'tomorrow_ds_nodash': '20220104', 'ts': '2022-01-03T00:00:00+00:00', 'ts_nodash': '20220103T000000', 'ts_nodash_with_tz': '20220103T000000+0000', 'var': {'json': None, 'value': None}, 'conn': None, 'yesterday_ds': '2022-01-02', 'yesterday_ds_nodash': '20220102', 'key': 'value', 'ts_var': '2022-01-03T00:00:00+00:00', 'tsnodash_var': '20220103T000000', 'templates_dict': None}
[2022-01-24 18:40:51,383] {logging_mixin.py:109} INFO - ts:  2022-01-03 00:00:00+00:00
[2022-01-24 18:40:51,383] {logging_mixin.py:109} INFO - <class 'pandas._libs.tslibs.timestamps.Timestamp'>
[2022-01-24 18:40:51,383] {logging_mixin.py:109} INFO - Object created.
[2022-01-24 18:40:51,383] {logging_mixin.py:109} INFO - 2022 1 3
[2022-01-24 18:40:51,384] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-3.json
[2022-01-24 18:40:51,384] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-19.json
[2022-01-24 18:40:51,384] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-49.json
[2022-01-24 18:40:51,385] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-45.json
[2022-01-24 18:40:51,385] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-7.json
[2022-01-24 18:40:51,385] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-54.json
[2022-01-24 18:40:51,385] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-75.json
[2022-01-24 18:40:51,385] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-60.json
[2022-01-24 18:40:51,385] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-83.json
[2022-01-24 18:40:51,386] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-13.json
[2022-01-24 18:40:51,386] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-2.json
[2022-01-24 18:40:51,386] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-59.json
[2022-01-24 18:40:51,387] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-71.json
[2022-01-24 18:40:51,387] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-8.json
[2022-01-24 18:40:51,387] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-40.json
[2022-01-24 18:40:51,387] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-39.json
[2022-01-24 18:40:51,387] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-65.json
[2022-01-24 18:40:51,387] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-86.json
[2022-01-24 18:40:51,388] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-18.json
[2022-01-24 18:40:51,388] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-27.json
[2022-01-24 18:40:51,388] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-51.json
[2022-01-24 18:40:51,388] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-16.json
[2022-01-24 18:40:51,388] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-4.json
[2022-01-24 18:40:51,389] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-62.json
[2022-01-24 18:40:51,389] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-68.json
[2022-01-24 18:40:51,389] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-78.json
[2022-01-24 18:40:51,389] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-33.json
[2022-01-24 18:40:51,389] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-41.json
[2022-01-24 18:40:51,389] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-69.json
[2022-01-24 18:40:51,390] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-0.json
[2022-01-24 18:40:51,390] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-21.json
[2022-01-24 18:40:51,390] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-47.json
[2022-01-24 18:40:51,390] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-9.json
[2022-01-24 18:40:51,390] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-80.json
[2022-01-24 18:40:51,390] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-70.json
[2022-01-24 18:40:51,391] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-6.json
[2022-01-24 18:40:51,391] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-87.json
[2022-01-24 18:40:51,391] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-66.json
[2022-01-24 18:40:51,391] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-43.json
[2022-01-24 18:40:51,391] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-46.json
[2022-01-24 18:40:51,391] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-25.json
[2022-01-24 18:40:51,392] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-17.json
[2022-01-24 18:40:51,392] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-85.json
[2022-01-24 18:40:51,392] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-35.json
[2022-01-24 18:40:51,392] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-22.json
[2022-01-24 18:40:51,392] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-15.json
[2022-01-24 18:40:51,392] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-53.json
[2022-01-24 18:40:51,393] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-14.json
[2022-01-24 18:40:51,393] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-1.json
[2022-01-24 18:40:51,393] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-72.json
[2022-01-24 18:40:51,393] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-64.json
[2022-01-24 18:40:51,393] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-28.json
[2022-01-24 18:40:51,393] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-12.json
[2022-01-24 18:40:51,393] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-20.json
[2022-01-24 18:40:51,394] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-61.json
[2022-01-24 18:40:51,394] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-56.json
[2022-01-24 18:40:51,394] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-42.json
[2022-01-24 18:40:51,394] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-50.json
[2022-01-24 18:40:51,394] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-58.json
[2022-01-24 18:40:51,394] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-77.json
[2022-01-24 18:40:51,394] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-52.json
[2022-01-24 18:40:51,395] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-79.json
[2022-01-24 18:40:51,395] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-36.json
[2022-01-24 18:40:51,395] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-24.json
[2022-01-24 18:40:51,395] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-23.json
[2022-01-24 18:40:51,395] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-81.json
[2022-01-24 18:40:51,395] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-37.json
[2022-01-24 18:40:51,396] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-74.json
[2022-01-24 18:40:51,396] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-48.json
[2022-01-24 18:40:51,396] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-57.json
[2022-01-24 18:40:51,397] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-34.json
[2022-01-24 18:40:51,397] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-32.json
[2022-01-24 18:40:51,398] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-63.json
[2022-01-24 18:40:51,399] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-5.json
[2022-01-24 18:40:51,399] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-84.json
[2022-01-24 18:40:51,399] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-73.json
[2022-01-24 18:40:51,399] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-30.json
[2022-01-24 18:40:51,400] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-10.json
[2022-01-24 18:40:51,400] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-29.json
[2022-01-24 18:40:51,400] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-38.json
[2022-01-24 18:40:51,400] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-44.json
[2022-01-24 18:40:51,400] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-31.json
[2022-01-24 18:40:51,400] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-11.json
[2022-01-24 18:40:51,400] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-67.json
[2022-01-24 18:40:51,400] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-26.json
[2022-01-24 18:40:51,400] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-82.json
[2022-01-24 18:40:51,401] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-76.json
[2022-01-24 18:40:51,401] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-55.json
[2022-01-24 18:40:51,406] {logging_mixin.py:109} INFO - 88
[2022-01-24 18:40:51,422] {logging_mixin.py:109} INFO -      invoice_id    invoice_timestamp  customer_id  ...  qty is_discount       price
0   20220103-11  2022-01-03T20:18:17  swibheb5634  ...  184           0  11439.2800
1   20220103-26  2022-01-03T14:44:24  mcbdghx4658  ...   34           1    111.7376
2   20220103-53  2022-01-03T02:37:16  dheanrq4135  ...   72           1   4212.4320
3    20220103-5  2022-01-03T00:59:19  okehqjl1310  ...   61           1   2866.6584
4   20220103-15  2022-01-03T01:43:15  wkigwzj3895  ...   40           0    507.6000
..          ...                  ...          ...  ...  ...         ...         ...
83   20220103-7  2022-01-03T17:17:57  fdstekl3454  ...  217           1  10054.0440
84  20220103-32  2022-01-03T23:20:38  ohzbsfe1717  ...  293           1   3197.6262
85  20220103-83  2022-01-03T04:43:11  ojxlnok1963  ...  286           0  11042.4600
86  20220103-78  2022-01-03T05:34:33  okejdpd4001  ...    2           1     56.3706
87  20220103-59  2022-01-03T12:44:15  vovqlzc2954  ...   87           1   3549.2781

[88 rows x 8 columns]
[2022-01-24 18:40:51,431] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: sales_dw, Login: awsuser, Password: ***, extra: {}
[2022-01-24 18:40:51,443] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: sales_dw, Login: awsuser, Password: ***, extra: {}
[2022-01-24 18:41:11,452] {local_task_job.py:212} WARNING - State of this instance has been externally set to None. Terminating instance.
[2022-01-24 18:41:11,459] {process_utils.py:124} INFO - Sending Signals.SIGTERM to group 3500. PIDs of all processes in the group: [3500]
[2022-01-24 18:41:11,460] {process_utils.py:75} INFO - Sending the signal Signals.SIGTERM to group 3500
[2022-01-24 18:41:11,779] {taskinstance.py:1408} ERROR - Received SIGTERM. Terminating subprocesses.
[2022-01-24 18:41:11,795] {taskinstance.py:1700} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1329, in _run_raw_task
    self._execute_task_with_callbacks(context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1455, in _execute_task_with_callbacks
    result = self._execute_task(context, self.task)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1511, in _execute_task
    result = execute_callable(context=context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 174, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 185, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/datawarehouse_airflow.py", line 57, in load_invoice_staging
    invoice_df.to_sql('invoice_staging_{}_{}_{}'.format(ts.year, ts.month, ts.day), redshift_hook.get_sqlalchemy_engine(), if_exists='replace', index=False)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/core/generic.py", line 2882, in to_sql
    method=method,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 728, in to_sql
    **engine_kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1770, in to_sql
    **engine_kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1340, in insert_records
    table.insert(chunksize=chunksize, method=method)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 967, in insert
    exec_insert(conn, keys, chunk_iter)
  File "/usr/local/lib/python3.7/contextlib.py", line 119, in __exit__
    next(self.gen)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1420, in run_transaction
    yield self.connectable
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 2110, in __exit__
    self.transaction.commit()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1762, in commit
    self._do_commit()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1793, in _do_commit
    self.connection._commit_impl()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 773, in _commit_impl
    self._handle_dbapi_exception(e, None, None, None, None)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1514, in _handle_dbapi_exception
    util.raise_(exc_info[1], with_traceback=exc_info[2])
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 182, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 771, in _commit_impl
    self.engine.dialect.do_commit(self.connection)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/default.py", line 561, in do_commit
    dbapi_connection.commit()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1410, in signal_handler
    raise AirflowException("Task received SIGTERM signal")
airflow.exceptions.AirflowException: Task received SIGTERM signal
[2022-01-24 18:41:11,825] {taskinstance.py:1277} INFO - Marking task as FAILED. dag_id=datawarehouse_etl, task_id=load_invoices, execution_date=20220103T000000, start_date=20220124T184051, end_date=20220124T184111
[2022-01-24 18:41:11,860] {standard_task_runner.py:92} ERROR - Failed to execute job 131 for task load_invoices
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/task/task_runner/standard_task_runner.py", line 85, in _start_by_fork
    args.func(args, dag=self.dag)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/cli_parser.py", line 48, in command
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/cli.py", line 92, in wrapper
    return f(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/commands/task_command.py", line 298, in task_run
    _run_task_by_selected_method(args, dag, ti)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/commands/task_command.py", line 107, in _run_task_by_selected_method
    _run_raw_task(args, ti)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/commands/task_command.py", line 184, in _run_raw_task
    error_file=args.error_file,
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/session.py", line 70, in wrapper
    return func(*args, session=session, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1329, in _run_raw_task
    self._execute_task_with_callbacks(context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1455, in _execute_task_with_callbacks
    result = self._execute_task(context, self.task)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1511, in _execute_task
    result = execute_callable(context=context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 174, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 185, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/datawarehouse_airflow.py", line 57, in load_invoice_staging
    invoice_df.to_sql('invoice_staging_{}_{}_{}'.format(ts.year, ts.month, ts.day), redshift_hook.get_sqlalchemy_engine(), if_exists='replace', index=False)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/core/generic.py", line 2882, in to_sql
    method=method,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 728, in to_sql
    **engine_kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1770, in to_sql
    **engine_kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1340, in insert_records
    table.insert(chunksize=chunksize, method=method)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 967, in insert
    exec_insert(conn, keys, chunk_iter)
  File "/usr/local/lib/python3.7/contextlib.py", line 119, in __exit__
    next(self.gen)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1420, in run_transaction
    yield self.connectable
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 2110, in __exit__
    self.transaction.commit()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1762, in commit
    self._do_commit()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1793, in _do_commit
    self.connection._commit_impl()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 773, in _commit_impl
    self._handle_dbapi_exception(e, None, None, None, None)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1514, in _handle_dbapi_exception
    util.raise_(exc_info[1], with_traceback=exc_info[2])
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 182, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 771, in _commit_impl
    self.engine.dialect.do_commit(self.connection)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/default.py", line 561, in do_commit
    dbapi_connection.commit()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1410, in signal_handler
    raise AirflowException("Task received SIGTERM signal")
airflow.exceptions.AirflowException: Task received SIGTERM signal
[2022-01-24 18:41:11,877] {process_utils.py:70} INFO - Process psutil.Process(pid=3500, status='terminated', exitcode=1, started='18:40:50') (3500) terminated with exit code 1
[2022-01-24 18:41:52,977] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [queued]>
[2022-01-24 18:41:52,987] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [queued]>
[2022-01-24 18:41:52,987] {taskinstance.py:1238} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 18:41:52,987] {taskinstance.py:1239} INFO - Starting attempt 1 of 1
[2022-01-24 18:41:52,987] {taskinstance.py:1240} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 18:41:52,997] {taskinstance.py:1259} INFO - Executing <Task(PythonOperator): load_invoices> on 2022-01-03 00:00:00+00:00
[2022-01-24 18:41:53,001] {standard_task_runner.py:52} INFO - Started process 3564 to run task
[2022-01-24 18:41:53,004] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'datawarehouse_etl', 'load_invoices', 'scheduled__2022-01-03T00:00:00+00:00', '--job-id', '137', '--raw', '--subdir', 'DAGS_FOLDER/datawarehouse_***.py', '--cfg-path', '/tmp/tmp6qg3ry0w', '--error-file', '/tmp/tmphriq6gj6']
[2022-01-24 18:41:53,004] {standard_task_runner.py:77} INFO - Job 137: Subtask load_invoices
[2022-01-24 18:41:53,044] {logging_mixin.py:109} INFO - Running <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [running]> on host cd9bb47288d1
[2022-01-24 18:41:53,087] {taskinstance.py:1426} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=datawarehouse_etl
AIRFLOW_CTX_TASK_ID=load_invoices
AIRFLOW_CTX_EXECUTION_DATE=2022-01-03T00:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-01-03T00:00:00+00:00
[2022-01-24 18:41:53,088] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:41:53,088] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:41:53,088] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds_nodash' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds_nodash }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:41:53,089] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_end' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:41:53,089] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:41:53,089] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:41:53,089] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:41:53,089] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date_success' from the template is deprecated and will be removed in a future version. Please use 'prev_data_interval_start_success' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:41:53,089] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:41:53,089] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:41:53,089] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:41:53,089] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:41:53,090] {logging_mixin.py:109} INFO - {'conf': <***.configuration.AirflowConfigParser object at 0x7f76fb23ca90>, 'dag': <DAG: datawarehouse_etl>, 'dag_run': <DagRun datawarehouse_etl @ 2022-01-03 00:00:00+00:00: scheduled__2022-01-03T00:00:00+00:00, externally triggered: False>, 'data_interval_end': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'data_interval_start': DateTime(2022, 1, 3, 0, 0, 0, tzinfo=Timezone('UTC')), 'ds': '2022-01-03', 'ds_nodash': '20220103', 'execution_date': DateTime(2022, 1, 3, 0, 0, 0, tzinfo=Timezone('UTC')), 'inlets': [], 'logical_date': DateTime(2022, 1, 3, 0, 0, 0, tzinfo=Timezone('UTC')), 'macros': <module '***.macros' from '/home/***/.local/lib/python3.7/site-packages/***/macros/__init__.py'>, 'next_ds': '2022-01-04', 'next_ds_nodash': '20220104', 'next_execution_date': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'outlets': [], 'params': {}, 'prev_data_interval_start_success': None, 'prev_data_interval_end_success': None, 'prev_ds': '2022-01-02', 'prev_ds_nodash': '20220102', 'prev_execution_date': datetime.datetime(2022, 1, 2, 0, 0, tzinfo=Timezone('UTC')), 'prev_execution_date_success': None, 'prev_start_date_success': None, 'run_id': 'scheduled__2022-01-03T00:00:00+00:00', 'task': <Task(PythonOperator): load_invoices>, 'task_instance': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [running]>, 'task_instance_key_str': 'datawarehouse_etl__load_invoices__20220103', 'test_mode': False, 'ti': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-03T00:00:00+00:00 [running]>, 'tomorrow_ds': '2022-01-04', 'tomorrow_ds_nodash': '20220104', 'ts': '2022-01-03T00:00:00+00:00', 'ts_nodash': '20220103T000000', 'ts_nodash_with_tz': '20220103T000000+0000', 'var': {'json': None, 'value': None}, 'conn': None, 'yesterday_ds': '2022-01-02', 'yesterday_ds_nodash': '20220102', 'key': 'value', 'ts_var': '2022-01-03T00:00:00+00:00', 'tsnodash_var': '20220103T000000', 'templates_dict': None}
[2022-01-24 18:41:53,091] {logging_mixin.py:109} INFO - ts:  2022-01-03 00:00:00+00:00
[2022-01-24 18:41:53,091] {logging_mixin.py:109} INFO - <class 'pandas._libs.tslibs.timestamps.Timestamp'>
[2022-01-24 18:41:53,091] {logging_mixin.py:109} INFO - Object created.
[2022-01-24 18:41:53,091] {logging_mixin.py:109} INFO - 2022 1 3
[2022-01-24 18:41:53,092] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-3.json
[2022-01-24 18:41:53,092] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-19.json
[2022-01-24 18:41:53,092] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-49.json
[2022-01-24 18:41:53,092] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-45.json
[2022-01-24 18:41:53,092] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-7.json
[2022-01-24 18:41:53,092] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-54.json
[2022-01-24 18:41:53,092] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-75.json
[2022-01-24 18:41:53,093] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-60.json
[2022-01-24 18:41:53,093] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-83.json
[2022-01-24 18:41:53,093] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-13.json
[2022-01-24 18:41:53,093] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-2.json
[2022-01-24 18:41:53,093] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-59.json
[2022-01-24 18:41:53,093] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-71.json
[2022-01-24 18:41:53,093] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-8.json
[2022-01-24 18:41:53,093] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-40.json
[2022-01-24 18:41:53,094] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-39.json
[2022-01-24 18:41:53,094] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-65.json
[2022-01-24 18:41:53,094] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-86.json
[2022-01-24 18:41:53,094] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-18.json
[2022-01-24 18:41:53,094] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-27.json
[2022-01-24 18:41:53,094] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-51.json
[2022-01-24 18:41:53,094] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-16.json
[2022-01-24 18:41:53,095] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-4.json
[2022-01-24 18:41:53,095] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-62.json
[2022-01-24 18:41:53,095] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-68.json
[2022-01-24 18:41:53,095] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-78.json
[2022-01-24 18:41:53,095] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-33.json
[2022-01-24 18:41:53,095] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-41.json
[2022-01-24 18:41:53,095] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-69.json
[2022-01-24 18:41:53,095] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-0.json
[2022-01-24 18:41:53,096] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-21.json
[2022-01-24 18:41:53,096] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-47.json
[2022-01-24 18:41:53,096] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-9.json
[2022-01-24 18:41:53,096] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-80.json
[2022-01-24 18:41:53,096] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-70.json
[2022-01-24 18:41:53,096] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-6.json
[2022-01-24 18:41:53,096] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-87.json
[2022-01-24 18:41:53,096] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-66.json
[2022-01-24 18:41:53,097] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-43.json
[2022-01-24 18:41:53,097] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-46.json
[2022-01-24 18:41:53,097] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-25.json
[2022-01-24 18:41:53,097] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-17.json
[2022-01-24 18:41:53,097] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-85.json
[2022-01-24 18:41:53,097] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-35.json
[2022-01-24 18:41:53,097] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-22.json
[2022-01-24 18:41:53,098] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-15.json
[2022-01-24 18:41:53,098] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-53.json
[2022-01-24 18:41:53,098] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-14.json
[2022-01-24 18:41:53,098] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-1.json
[2022-01-24 18:41:53,098] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-72.json
[2022-01-24 18:41:53,098] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-64.json
[2022-01-24 18:41:53,098] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-28.json
[2022-01-24 18:41:53,098] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-12.json
[2022-01-24 18:41:53,099] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-20.json
[2022-01-24 18:41:53,099] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-61.json
[2022-01-24 18:41:53,099] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-56.json
[2022-01-24 18:41:53,099] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-42.json
[2022-01-24 18:41:53,099] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-50.json
[2022-01-24 18:41:53,099] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-58.json
[2022-01-24 18:41:53,099] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-77.json
[2022-01-24 18:41:53,099] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-52.json
[2022-01-24 18:41:53,100] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-79.json
[2022-01-24 18:41:53,100] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-36.json
[2022-01-24 18:41:53,100] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-24.json
[2022-01-24 18:41:53,100] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-23.json
[2022-01-24 18:41:53,100] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-81.json
[2022-01-24 18:41:53,100] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-37.json
[2022-01-24 18:41:53,100] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-74.json
[2022-01-24 18:41:53,101] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-48.json
[2022-01-24 18:41:53,101] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-57.json
[2022-01-24 18:41:53,101] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-34.json
[2022-01-24 18:41:53,101] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-32.json
[2022-01-24 18:41:53,101] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-63.json
[2022-01-24 18:41:53,101] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-5.json
[2022-01-24 18:41:53,101] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-84.json
[2022-01-24 18:41:53,101] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-73.json
[2022-01-24 18:41:53,102] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-30.json
[2022-01-24 18:41:53,102] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-10.json
[2022-01-24 18:41:53,102] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-29.json
[2022-01-24 18:41:53,102] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-38.json
[2022-01-24 18:41:53,102] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-44.json
[2022-01-24 18:41:53,102] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-31.json
[2022-01-24 18:41:53,102] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-11.json
[2022-01-24 18:41:53,102] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-67.json
[2022-01-24 18:41:53,103] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-26.json
[2022-01-24 18:41:53,103] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-82.json
[2022-01-24 18:41:53,103] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-76.json
[2022-01-24 18:41:53,103] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-3/invoice_2022-1-3-55.json
[2022-01-24 18:41:53,105] {logging_mixin.py:109} INFO - 88
[2022-01-24 18:41:53,118] {logging_mixin.py:109} INFO -      invoice_id    invoice_timestamp  customer_id  ...  qty is_discount       price
0   20220103-11  2022-01-03T20:18:17  swibheb5634  ...  184           0  11439.2800
1   20220103-26  2022-01-03T14:44:24  mcbdghx4658  ...   34           1    111.7376
2   20220103-53  2022-01-03T02:37:16  dheanrq4135  ...   72           1   4212.4320
3    20220103-5  2022-01-03T00:59:19  okehqjl1310  ...   61           1   2866.6584
4   20220103-15  2022-01-03T01:43:15  wkigwzj3895  ...   40           0    507.6000
..          ...                  ...          ...  ...  ...         ...         ...
83   20220103-7  2022-01-03T17:17:57  fdstekl3454  ...  217           1  10054.0440
84  20220103-32  2022-01-03T23:20:38  ohzbsfe1717  ...  293           1   3197.6262
85  20220103-83  2022-01-03T04:43:11  ojxlnok1963  ...  286           0  11042.4600
86  20220103-78  2022-01-03T05:34:33  okejdpd4001  ...    2           1     56.3706
87  20220103-59  2022-01-03T12:44:15  vovqlzc2954  ...   87           1   3549.2781

[88 rows x 8 columns]
[2022-01-24 18:41:53,126] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: sales_dw, Login: awsuser, Password: ***, extra: {}
[2022-01-24 18:41:53,132] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: sales_dw, Login: awsuser, Password: ***, extra: {}
[2022-01-24 18:42:14,480] {python.py:175} INFO - Done. Returned value was: None
[2022-01-24 18:42:14,490] {taskinstance.py:1277} INFO - Marking task as SUCCESS. dag_id=datawarehouse_etl, task_id=load_invoices, execution_date=20220103T000000, start_date=20220124T184152, end_date=20220124T184214
[2022-01-24 18:42:14,510] {local_task_job.py:154} INFO - Task exited with return code 0
[2022-01-24 18:42:14,538] {local_task_job.py:264} INFO - 1 downstream tasks scheduled from follow-on schedule check
