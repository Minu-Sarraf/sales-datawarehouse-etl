[2022-01-24 02:21:07,033] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [queued]>
[2022-01-24 02:21:07,057] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [queued]>
[2022-01-24 02:21:07,057] {taskinstance.py:1238} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 02:21:07,057] {taskinstance.py:1239} INFO - Starting attempt 1 of 1
[2022-01-24 02:21:07,058] {taskinstance.py:1240} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 02:21:07,076] {taskinstance.py:1259} INFO - Executing <Task(PythonOperator): load_invoices> on 2022-01-04 00:00:00+00:00
[2022-01-24 02:21:07,086] {standard_task_runner.py:52} INFO - Started process 1839 to run task
[2022-01-24 02:21:07,090] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'datawarehouse_etl', 'load_invoices', 'scheduled__2022-01-04T00:00:00+00:00', '--job-id', '19', '--raw', '--subdir', 'DAGS_FOLDER/datawarehouse_***.py', '--cfg-path', '/tmp/tmpimzwpv2s', '--error-file', '/tmp/tmpzayzj_9n']
[2022-01-24 02:21:07,091] {standard_task_runner.py:77} INFO - Job 19: Subtask load_invoices
[2022-01-24 02:21:07,196] {logging_mixin.py:109} INFO - Running <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [running]> on host cd9bb47288d1
[2022-01-24 02:21:07,299] {taskinstance.py:1426} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=datawarehouse_etl
AIRFLOW_CTX_TASK_ID=load_invoices
AIRFLOW_CTX_EXECUTION_DATE=2022-01-04T00:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-01-04T00:00:00+00:00
[2022-01-24 02:21:07,302] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:21:07,302] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:21:07,302] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds_nodash' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds_nodash }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:21:07,302] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_end' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:21:07,303] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:21:07,303] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:21:07,303] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:21:07,303] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date_success' from the template is deprecated and will be removed in a future version. Please use 'prev_data_interval_start_success' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:21:07,304] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:21:07,304] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:21:07,304] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:21:07,304] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:21:07,305] {logging_mixin.py:109} INFO - {'conf': <***.configuration.AirflowConfigParser object at 0x7f1e4dfc6a10>, 'dag': <DAG: datawarehouse_etl>, 'dag_run': <DagRun datawarehouse_etl @ 2022-01-04 00:00:00+00:00: scheduled__2022-01-04T00:00:00+00:00, externally triggered: False>, 'data_interval_end': DateTime(2022, 1, 5, 0, 0, 0, tzinfo=Timezone('UTC')), 'data_interval_start': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'ds': '2022-01-04', 'ds_nodash': '20220104', 'execution_date': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'inlets': [], 'logical_date': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'macros': <module '***.macros' from '/home/***/.local/lib/python3.7/site-packages/***/macros/__init__.py'>, 'next_ds': '2022-01-05', 'next_ds_nodash': '20220105', 'next_execution_date': DateTime(2022, 1, 5, 0, 0, 0, tzinfo=Timezone('UTC')), 'outlets': [], 'params': {}, 'prev_data_interval_start_success': DateTime(2022, 1, 1, 0, 0, 0, tzinfo=Timezone('UTC')), 'prev_data_interval_end_success': DateTime(2022, 1, 2, 0, 0, 0, tzinfo=Timezone('UTC')), 'prev_ds': '2022-01-03', 'prev_ds_nodash': '20220103', 'prev_execution_date': datetime.datetime(2022, 1, 3, 0, 0, tzinfo=Timezone('UTC')), 'prev_execution_date_success': DateTime(2022, 1, 1, 0, 0, 0, tzinfo=Timezone('UTC')), 'prev_start_date_success': DateTime(2022, 1, 24, 2, 21, 3, 847547, tzinfo=Timezone('UTC')), 'run_id': 'scheduled__2022-01-04T00:00:00+00:00', 'task': <Task(PythonOperator): load_invoices>, 'task_instance': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [running]>, 'task_instance_key_str': 'datawarehouse_etl__load_invoices__20220104', 'test_mode': False, 'ti': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [running]>, 'tomorrow_ds': '2022-01-05', 'tomorrow_ds_nodash': '20220105', 'ts': '2022-01-04T00:00:00+00:00', 'ts_nodash': '20220104T000000', 'ts_nodash_with_tz': '20220104T000000+0000', 'var': {'json': None, 'value': None}, 'conn': None, 'yesterday_ds': '2022-01-03', 'yesterday_ds_nodash': '20220103', 'key': 'value', 'ts_var': '2022-01-04T00:00:00+00:00', 'tsnodash_var': '20220104T000000', 'templates_dict': None}
[2022-01-24 02:21:07,305] {logging_mixin.py:109} INFO - 2022-01-04T00:00:00+00:00
[2022-01-24 02:21:07,306] {logging_mixin.py:109} INFO - Object created.
[2022-01-24 02:21:07,306] {python.py:175} INFO - Done. Returned value was: None
[2022-01-24 02:21:07,322] {taskinstance.py:1277} INFO - Marking task as SUCCESS. dag_id=datawarehouse_etl, task_id=load_invoices, execution_date=20220104T000000, start_date=20220124T022107, end_date=20220124T022107
[2022-01-24 02:21:07,382] {local_task_job.py:154} INFO - Task exited with return code 0
[2022-01-24 02:21:07,432] {local_task_job.py:264} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2022-01-24 02:24:54,131] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [queued]>
[2022-01-24 02:24:54,153] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [queued]>
[2022-01-24 02:24:54,153] {taskinstance.py:1238} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 02:24:54,153] {taskinstance.py:1239} INFO - Starting attempt 1 of 1
[2022-01-24 02:24:54,153] {taskinstance.py:1240} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 02:24:54,168] {taskinstance.py:1259} INFO - Executing <Task(PythonOperator): load_invoices> on 2022-01-04 00:00:00+00:00
[2022-01-24 02:24:54,172] {standard_task_runner.py:52} INFO - Started process 2019 to run task
[2022-01-24 02:24:54,176] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'datawarehouse_etl', 'load_invoices', 'scheduled__2022-01-04T00:00:00+00:00', '--job-id', '24', '--raw', '--subdir', 'DAGS_FOLDER/datawarehouse_***.py', '--cfg-path', '/tmp/tmp2mzajnzi', '--error-file', '/tmp/tmpcfzoerpl']
[2022-01-24 02:24:54,177] {standard_task_runner.py:77} INFO - Job 24: Subtask load_invoices
[2022-01-24 02:24:54,245] {logging_mixin.py:109} INFO - Running <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [running]> on host cd9bb47288d1
[2022-01-24 02:24:54,308] {taskinstance.py:1426} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=datawarehouse_etl
AIRFLOW_CTX_TASK_ID=load_invoices
AIRFLOW_CTX_EXECUTION_DATE=2022-01-04T00:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-01-04T00:00:00+00:00
[2022-01-24 02:24:54,310] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:24:54,310] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:24:54,310] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds_nodash' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds_nodash }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:24:54,311] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_end' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:24:54,311] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:24:54,311] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:24:54,311] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:24:54,311] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date_success' from the template is deprecated and will be removed in a future version. Please use 'prev_data_interval_start_success' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:24:54,311] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:24:54,311] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:24:54,312] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:24:54,312] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:24:54,312] {logging_mixin.py:109} INFO - {'conf': <***.configuration.AirflowConfigParser object at 0x7f1e4dfc6a10>, 'dag': <DAG: datawarehouse_etl>, 'dag_run': <DagRun datawarehouse_etl @ 2022-01-04 00:00:00+00:00: scheduled__2022-01-04T00:00:00+00:00, externally triggered: False>, 'data_interval_end': DateTime(2022, 1, 5, 0, 0, 0, tzinfo=Timezone('UTC')), 'data_interval_start': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'ds': '2022-01-04', 'ds_nodash': '20220104', 'execution_date': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'inlets': [], 'logical_date': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'macros': <module '***.macros' from '/home/***/.local/lib/python3.7/site-packages/***/macros/__init__.py'>, 'next_ds': '2022-01-05', 'next_ds_nodash': '20220105', 'next_execution_date': DateTime(2022, 1, 5, 0, 0, 0, tzinfo=Timezone('UTC')), 'outlets': [], 'params': {}, 'prev_data_interval_start_success': DateTime(2022, 1, 1, 0, 0, 0, tzinfo=Timezone('UTC')), 'prev_data_interval_end_success': DateTime(2022, 1, 2, 0, 0, 0, tzinfo=Timezone('UTC')), 'prev_ds': '2022-01-03', 'prev_ds_nodash': '20220103', 'prev_execution_date': datetime.datetime(2022, 1, 3, 0, 0, tzinfo=Timezone('UTC')), 'prev_execution_date_success': DateTime(2022, 1, 1, 0, 0, 0, tzinfo=Timezone('UTC')), 'prev_start_date_success': DateTime(2022, 1, 24, 2, 24, 51, 640871, tzinfo=Timezone('UTC')), 'run_id': 'scheduled__2022-01-04T00:00:00+00:00', 'task': <Task(PythonOperator): load_invoices>, 'task_instance': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [running]>, 'task_instance_key_str': 'datawarehouse_etl__load_invoices__20220104', 'test_mode': False, 'ti': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [running]>, 'tomorrow_ds': '2022-01-05', 'tomorrow_ds_nodash': '20220105', 'ts': '2022-01-04T00:00:00+00:00', 'ts_nodash': '20220104T000000', 'ts_nodash_with_tz': '20220104T000000+0000', 'var': {'json': None, 'value': None}, 'conn': None, 'yesterday_ds': '2022-01-03', 'yesterday_ds_nodash': '20220103', 'key': 'value', 'ts_var': '2022-01-04T00:00:00+00:00', 'tsnodash_var': '20220104T000000', 'templates_dict': None}
[2022-01-24 02:24:54,312] {logging_mixin.py:109} INFO - 2022-01-04T00:00:00+00:00
[2022-01-24 02:24:54,313] {logging_mixin.py:109} INFO - 2022-01-04
[2022-01-24 02:24:54,313] {logging_mixin.py:109} INFO - Object created.
[2022-01-24 02:24:54,313] {python.py:175} INFO - Done. Returned value was: None
[2022-01-24 02:24:54,325] {taskinstance.py:1277} INFO - Marking task as SUCCESS. dag_id=datawarehouse_etl, task_id=load_invoices, execution_date=20220104T000000, start_date=20220124T022454, end_date=20220124T022454
[2022-01-24 02:24:54,387] {local_task_job.py:154} INFO - Task exited with return code 0
[2022-01-24 02:24:54,425] {local_task_job.py:264} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2022-01-24 02:30:03,782] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [queued]>
[2022-01-24 02:30:03,794] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [queued]>
[2022-01-24 02:30:03,794] {taskinstance.py:1238} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 02:30:03,794] {taskinstance.py:1239} INFO - Starting attempt 1 of 1
[2022-01-24 02:30:03,794] {taskinstance.py:1240} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 02:30:03,808] {taskinstance.py:1259} INFO - Executing <Task(PythonOperator): load_invoices> on 2022-01-04 00:00:00+00:00
[2022-01-24 02:30:03,813] {standard_task_runner.py:52} INFO - Started process 2266 to run task
[2022-01-24 02:30:03,816] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'datawarehouse_etl', 'load_invoices', 'scheduled__2022-01-04T00:00:00+00:00', '--job-id', '29', '--raw', '--subdir', 'DAGS_FOLDER/datawarehouse_***.py', '--cfg-path', '/tmp/tmpj3nqlnl2', '--error-file', '/tmp/tmpdtuff5_s']
[2022-01-24 02:30:03,817] {standard_task_runner.py:77} INFO - Job 29: Subtask load_invoices
[2022-01-24 02:30:03,869] {logging_mixin.py:109} INFO - Running <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [running]> on host cd9bb47288d1
[2022-01-24 02:30:03,917] {taskinstance.py:1426} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=datawarehouse_etl
AIRFLOW_CTX_TASK_ID=load_invoices
AIRFLOW_CTX_EXECUTION_DATE=2022-01-04T00:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-01-04T00:00:00+00:00
[2022-01-24 02:30:03,918] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:30:03,919] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:30:03,919] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds_nodash' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds_nodash }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:30:03,919] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_end' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:30:03,919] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:30:03,919] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:30:03,919] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:30:03,919] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date_success' from the template is deprecated and will be removed in a future version. Please use 'prev_data_interval_start_success' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:30:03,919] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:30:03,919] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:30:03,919] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:30:03,920] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:30:03,920] {logging_mixin.py:109} INFO - {'conf': <***.configuration.AirflowConfigParser object at 0x7f1e4dfc6a10>, 'dag': <DAG: datawarehouse_etl>, 'dag_run': <DagRun datawarehouse_etl @ 2022-01-04 00:00:00+00:00: scheduled__2022-01-04T00:00:00+00:00, externally triggered: False>, 'data_interval_end': DateTime(2022, 1, 5, 0, 0, 0, tzinfo=Timezone('UTC')), 'data_interval_start': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'ds': '2022-01-04', 'ds_nodash': '20220104', 'execution_date': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'inlets': [], 'logical_date': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'macros': <module '***.macros' from '/home/***/.local/lib/python3.7/site-packages/***/macros/__init__.py'>, 'next_ds': '2022-01-05', 'next_ds_nodash': '20220105', 'next_execution_date': DateTime(2022, 1, 5, 0, 0, 0, tzinfo=Timezone('UTC')), 'outlets': [], 'params': {}, 'prev_data_interval_start_success': DateTime(2022, 1, 1, 0, 0, 0, tzinfo=Timezone('UTC')), 'prev_data_interval_end_success': DateTime(2022, 1, 2, 0, 0, 0, tzinfo=Timezone('UTC')), 'prev_ds': '2022-01-03', 'prev_ds_nodash': '20220103', 'prev_execution_date': datetime.datetime(2022, 1, 3, 0, 0, tzinfo=Timezone('UTC')), 'prev_execution_date_success': DateTime(2022, 1, 1, 0, 0, 0, tzinfo=Timezone('UTC')), 'prev_start_date_success': DateTime(2022, 1, 24, 2, 30, 1, 333762, tzinfo=Timezone('UTC')), 'run_id': 'scheduled__2022-01-04T00:00:00+00:00', 'task': <Task(PythonOperator): load_invoices>, 'task_instance': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [running]>, 'task_instance_key_str': 'datawarehouse_etl__load_invoices__20220104', 'test_mode': False, 'ti': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [running]>, 'tomorrow_ds': '2022-01-05', 'tomorrow_ds_nodash': '20220105', 'ts': '2022-01-04T00:00:00+00:00', 'ts_nodash': '20220104T000000', 'ts_nodash_with_tz': '20220104T000000+0000', 'var': {'json': None, 'value': None}, 'conn': None, 'yesterday_ds': '2022-01-03', 'yesterday_ds_nodash': '20220103', 'key': 'value', 'ts_var': '2022-01-04T00:00:00+00:00', 'tsnodash_var': '20220104T000000', 'templates_dict': None}
[2022-01-24 02:30:03,920] {logging_mixin.py:109} INFO - 2022-01-04T00:00:00+00:00
[2022-01-24 02:30:03,921] {logging_mixin.py:109} INFO - 2022-01-04
[2022-01-24 02:30:03,922] {logging_mixin.py:109} INFO - Object created.
[2022-01-24 02:30:03,922] {python.py:175} INFO - Done. Returned value was: None
[2022-01-24 02:30:03,932] {taskinstance.py:1277} INFO - Marking task as SUCCESS. dag_id=datawarehouse_etl, task_id=load_invoices, execution_date=20220104T000000, start_date=20220124T023003, end_date=20220124T023003
[2022-01-24 02:30:03,987] {local_task_job.py:154} INFO - Task exited with return code 0
[2022-01-24 02:30:04,020] {local_task_job.py:264} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2022-01-24 02:31:44,015] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [queued]>
[2022-01-24 02:31:44,029] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [queued]>
[2022-01-24 02:31:44,029] {taskinstance.py:1238} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 02:31:44,029] {taskinstance.py:1239} INFO - Starting attempt 1 of 1
[2022-01-24 02:31:44,029] {taskinstance.py:1240} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 02:31:44,040] {taskinstance.py:1259} INFO - Executing <Task(PythonOperator): load_invoices> on 2022-01-04 00:00:00+00:00
[2022-01-24 02:31:44,045] {standard_task_runner.py:52} INFO - Started process 2354 to run task
[2022-01-24 02:31:44,049] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'datawarehouse_etl', 'load_invoices', 'scheduled__2022-01-04T00:00:00+00:00', '--job-id', '34', '--raw', '--subdir', 'DAGS_FOLDER/datawarehouse_***.py', '--cfg-path', '/tmp/tmp1wlo3pd9', '--error-file', '/tmp/tmp4wmbi6m1']
[2022-01-24 02:31:44,050] {standard_task_runner.py:77} INFO - Job 34: Subtask load_invoices
[2022-01-24 02:31:44,101] {logging_mixin.py:109} INFO - Running <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [running]> on host cd9bb47288d1
[2022-01-24 02:31:44,147] {taskinstance.py:1426} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=datawarehouse_etl
AIRFLOW_CTX_TASK_ID=load_invoices
AIRFLOW_CTX_EXECUTION_DATE=2022-01-04T00:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-01-04T00:00:00+00:00
[2022-01-24 02:31:44,148] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:31:44,148] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:31:44,148] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds_nodash' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds_nodash }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:31:44,148] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_end' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:31:44,149] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:31:44,149] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:31:44,149] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:31:44,149] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date_success' from the template is deprecated and will be removed in a future version. Please use 'prev_data_interval_start_success' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:31:44,149] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:31:44,149] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:31:44,149] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:31:44,149] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:31:44,150] {logging_mixin.py:109} INFO - {'conf': <***.configuration.AirflowConfigParser object at 0x7f1e4dfc6a10>, 'dag': <DAG: datawarehouse_etl>, 'dag_run': <DagRun datawarehouse_etl @ 2022-01-04 00:00:00+00:00: scheduled__2022-01-04T00:00:00+00:00, externally triggered: False>, 'data_interval_end': DateTime(2022, 1, 5, 0, 0, 0, tzinfo=Timezone('UTC')), 'data_interval_start': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'ds': '2022-01-04', 'ds_nodash': '20220104', 'execution_date': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'inlets': [], 'logical_date': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'macros': <module '***.macros' from '/home/***/.local/lib/python3.7/site-packages/***/macros/__init__.py'>, 'next_ds': '2022-01-05', 'next_ds_nodash': '20220105', 'next_execution_date': DateTime(2022, 1, 5, 0, 0, 0, tzinfo=Timezone('UTC')), 'outlets': [], 'params': {}, 'prev_data_interval_start_success': None, 'prev_data_interval_end_success': None, 'prev_ds': '2022-01-03', 'prev_ds_nodash': '20220103', 'prev_execution_date': datetime.datetime(2022, 1, 3, 0, 0, tzinfo=Timezone('UTC')), 'prev_execution_date_success': None, 'prev_start_date_success': None, 'run_id': 'scheduled__2022-01-04T00:00:00+00:00', 'task': <Task(PythonOperator): load_invoices>, 'task_instance': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [running]>, 'task_instance_key_str': 'datawarehouse_etl__load_invoices__20220104', 'test_mode': False, 'ti': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [running]>, 'tomorrow_ds': '2022-01-05', 'tomorrow_ds_nodash': '20220105', 'ts': '2022-01-04T00:00:00+00:00', 'ts_nodash': '20220104T000000', 'ts_nodash_with_tz': '20220104T000000+0000', 'var': {'json': None, 'value': None}, 'conn': None, 'yesterday_ds': '2022-01-03', 'yesterday_ds_nodash': '20220103', 'key': 'value', 'ts_var': '2022-01-04T00:00:00+00:00', 'tsnodash_var': '20220104T000000', 'templates_dict': None}
[2022-01-24 02:31:44,150] {logging_mixin.py:109} INFO - 2022-01-04T00:00:00+00:00
[2022-01-24 02:31:44,150] {taskinstance.py:1700} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1329, in _run_raw_task
    self._execute_task_with_callbacks(context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1455, in _execute_task_with_callbacks
    result = self._execute_task(context, self.task)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1511, in _execute_task
    result = execute_callable(context=context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 174, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 185, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/datawarehouse_airflow.py", line 45, in load_invoices
    print(ts.year())
AttributeError: 'str' object has no attribute 'year'
[2022-01-24 02:31:44,161] {taskinstance.py:1277} INFO - Marking task as FAILED. dag_id=datawarehouse_etl, task_id=load_invoices, execution_date=20220104T000000, start_date=20220124T023144, end_date=20220124T023144
[2022-01-24 02:31:44,174] {standard_task_runner.py:92} ERROR - Failed to execute job 34 for task load_invoices
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/task/task_runner/standard_task_runner.py", line 85, in _start_by_fork
    args.func(args, dag=self.dag)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/cli_parser.py", line 48, in command
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/cli.py", line 92, in wrapper
    return f(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/commands/task_command.py", line 298, in task_run
    _run_task_by_selected_method(args, dag, ti)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/commands/task_command.py", line 107, in _run_task_by_selected_method
    _run_raw_task(args, ti)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/commands/task_command.py", line 184, in _run_raw_task
    error_file=args.error_file,
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/session.py", line 70, in wrapper
    return func(*args, session=session, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1329, in _run_raw_task
    self._execute_task_with_callbacks(context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1455, in _execute_task_with_callbacks
    result = self._execute_task(context, self.task)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1511, in _execute_task
    result = execute_callable(context=context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 174, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 185, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/datawarehouse_airflow.py", line 45, in load_invoices
    print(ts.year())
AttributeError: 'str' object has no attribute 'year'
[2022-01-24 02:31:44,180] {local_task_job.py:154} INFO - Task exited with return code 1
[2022-01-24 02:31:44,216] {local_task_job.py:264} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-01-24 02:33:05,520] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [queued]>
[2022-01-24 02:33:05,535] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [queued]>
[2022-01-24 02:33:05,536] {taskinstance.py:1238} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 02:33:05,536] {taskinstance.py:1239} INFO - Starting attempt 1 of 1
[2022-01-24 02:33:05,536] {taskinstance.py:1240} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 02:33:05,551] {taskinstance.py:1259} INFO - Executing <Task(PythonOperator): load_invoices> on 2022-01-04 00:00:00+00:00
[2022-01-24 02:33:05,556] {standard_task_runner.py:52} INFO - Started process 2430 to run task
[2022-01-24 02:33:05,559] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'datawarehouse_etl', 'load_invoices', 'scheduled__2022-01-04T00:00:00+00:00', '--job-id', '39', '--raw', '--subdir', 'DAGS_FOLDER/datawarehouse_***.py', '--cfg-path', '/tmp/tmpyhybic66', '--error-file', '/tmp/tmp52pt11ab']
[2022-01-24 02:33:05,560] {standard_task_runner.py:77} INFO - Job 39: Subtask load_invoices
[2022-01-24 02:33:05,639] {logging_mixin.py:109} INFO - Running <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [running]> on host cd9bb47288d1
[2022-01-24 02:33:05,710] {taskinstance.py:1426} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=datawarehouse_etl
AIRFLOW_CTX_TASK_ID=load_invoices
AIRFLOW_CTX_EXECUTION_DATE=2022-01-04T00:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-01-04T00:00:00+00:00
[2022-01-24 02:33:05,711] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:33:05,711] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:33:05,712] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds_nodash' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds_nodash }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:33:05,712] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_end' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:33:05,712] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:33:05,712] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:33:05,713] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:33:05,713] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date_success' from the template is deprecated and will be removed in a future version. Please use 'prev_data_interval_start_success' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:33:05,713] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:33:05,713] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:33:05,713] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:33:05,713] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:33:05,714] {logging_mixin.py:109} INFO - {'conf': <***.configuration.AirflowConfigParser object at 0x7f1e4dfc6a10>, 'dag': <DAG: datawarehouse_etl>, 'dag_run': <DagRun datawarehouse_etl @ 2022-01-04 00:00:00+00:00: scheduled__2022-01-04T00:00:00+00:00, externally triggered: False>, 'data_interval_end': DateTime(2022, 1, 5, 0, 0, 0, tzinfo=Timezone('UTC')), 'data_interval_start': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'ds': '2022-01-04', 'ds_nodash': '20220104', 'execution_date': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'inlets': [], 'logical_date': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'macros': <module '***.macros' from '/home/***/.local/lib/python3.7/site-packages/***/macros/__init__.py'>, 'next_ds': '2022-01-05', 'next_ds_nodash': '20220105', 'next_execution_date': DateTime(2022, 1, 5, 0, 0, 0, tzinfo=Timezone('UTC')), 'outlets': [], 'params': {}, 'prev_data_interval_start_success': None, 'prev_data_interval_end_success': None, 'prev_ds': '2022-01-03', 'prev_ds_nodash': '20220103', 'prev_execution_date': datetime.datetime(2022, 1, 3, 0, 0, tzinfo=Timezone('UTC')), 'prev_execution_date_success': None, 'prev_start_date_success': None, 'run_id': 'scheduled__2022-01-04T00:00:00+00:00', 'task': <Task(PythonOperator): load_invoices>, 'task_instance': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [running]>, 'task_instance_key_str': 'datawarehouse_etl__load_invoices__20220104', 'test_mode': False, 'ti': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [running]>, 'tomorrow_ds': '2022-01-05', 'tomorrow_ds_nodash': '20220105', 'ts': '2022-01-04T00:00:00+00:00', 'ts_nodash': '20220104T000000', 'ts_nodash_with_tz': '20220104T000000+0000', 'var': {'json': None, 'value': None}, 'conn': None, 'yesterday_ds': '2022-01-03', 'yesterday_ds_nodash': '20220103', 'key': 'value', 'ts_var': '2022-01-04T00:00:00+00:00', 'tsnodash_var': '20220104T000000', 'templates_dict': None}
[2022-01-24 02:33:05,715] {logging_mixin.py:109} INFO - 2022-01-04 00:00:00+00:00
[2022-01-24 02:33:05,715] {taskinstance.py:1700} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1329, in _run_raw_task
    self._execute_task_with_callbacks(context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1455, in _execute_task_with_callbacks
    result = self._execute_task(context, self.task)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1511, in _execute_task
    result = execute_callable(context=context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 174, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 185, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/datawarehouse_airflow.py", line 45, in load_invoices
    print(ts.year())
TypeError: 'int' object is not callable
[2022-01-24 02:33:05,730] {taskinstance.py:1277} INFO - Marking task as FAILED. dag_id=datawarehouse_etl, task_id=load_invoices, execution_date=20220104T000000, start_date=20220124T023305, end_date=20220124T023305
[2022-01-24 02:33:05,753] {standard_task_runner.py:92} ERROR - Failed to execute job 39 for task load_invoices
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/task/task_runner/standard_task_runner.py", line 85, in _start_by_fork
    args.func(args, dag=self.dag)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/cli_parser.py", line 48, in command
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/cli.py", line 92, in wrapper
    return f(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/commands/task_command.py", line 298, in task_run
    _run_task_by_selected_method(args, dag, ti)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/commands/task_command.py", line 107, in _run_task_by_selected_method
    _run_raw_task(args, ti)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/commands/task_command.py", line 184, in _run_raw_task
    error_file=args.error_file,
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/session.py", line 70, in wrapper
    return func(*args, session=session, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1329, in _run_raw_task
    self._execute_task_with_callbacks(context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1455, in _execute_task_with_callbacks
    result = self._execute_task(context, self.task)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1511, in _execute_task
    result = execute_callable(context=context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 174, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 185, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/datawarehouse_airflow.py", line 45, in load_invoices
    print(ts.year())
TypeError: 'int' object is not callable
[2022-01-24 02:33:05,773] {local_task_job.py:154} INFO - Task exited with return code 1
[2022-01-24 02:33:05,837] {local_task_job.py:264} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-01-24 02:34:35,140] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [queued]>
[2022-01-24 02:34:35,154] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [queued]>
[2022-01-24 02:34:35,154] {taskinstance.py:1238} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 02:34:35,154] {taskinstance.py:1239} INFO - Starting attempt 1 of 1
[2022-01-24 02:34:35,154] {taskinstance.py:1240} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 02:34:35,169] {taskinstance.py:1259} INFO - Executing <Task(PythonOperator): load_invoices> on 2022-01-04 00:00:00+00:00
[2022-01-24 02:34:35,174] {standard_task_runner.py:52} INFO - Started process 2514 to run task
[2022-01-24 02:34:35,178] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'datawarehouse_etl', 'load_invoices', 'scheduled__2022-01-04T00:00:00+00:00', '--job-id', '44', '--raw', '--subdir', 'DAGS_FOLDER/datawarehouse_***.py', '--cfg-path', '/tmp/tmpa9dhrzg8', '--error-file', '/tmp/tmp8rz6zfd9']
[2022-01-24 02:34:35,179] {standard_task_runner.py:77} INFO - Job 44: Subtask load_invoices
[2022-01-24 02:34:35,237] {logging_mixin.py:109} INFO - Running <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [running]> on host cd9bb47288d1
[2022-01-24 02:34:35,287] {taskinstance.py:1426} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=datawarehouse_etl
AIRFLOW_CTX_TASK_ID=load_invoices
AIRFLOW_CTX_EXECUTION_DATE=2022-01-04T00:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-01-04T00:00:00+00:00
[2022-01-24 02:34:35,289] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:34:35,289] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:34:35,289] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds_nodash' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds_nodash }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:34:35,289] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_end' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:34:35,289] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:34:35,289] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:34:35,289] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:34:35,289] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date_success' from the template is deprecated and will be removed in a future version. Please use 'prev_data_interval_start_success' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:34:35,290] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:34:35,290] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:34:35,290] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:34:35,290] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:34:35,290] {logging_mixin.py:109} INFO - {'conf': <***.configuration.AirflowConfigParser object at 0x7f1e4dfc6a10>, 'dag': <DAG: datawarehouse_etl>, 'dag_run': <DagRun datawarehouse_etl @ 2022-01-04 00:00:00+00:00: scheduled__2022-01-04T00:00:00+00:00, externally triggered: False>, 'data_interval_end': DateTime(2022, 1, 5, 0, 0, 0, tzinfo=Timezone('UTC')), 'data_interval_start': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'ds': '2022-01-04', 'ds_nodash': '20220104', 'execution_date': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'inlets': [], 'logical_date': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'macros': <module '***.macros' from '/home/***/.local/lib/python3.7/site-packages/***/macros/__init__.py'>, 'next_ds': '2022-01-05', 'next_ds_nodash': '20220105', 'next_execution_date': DateTime(2022, 1, 5, 0, 0, 0, tzinfo=Timezone('UTC')), 'outlets': [], 'params': {}, 'prev_data_interval_start_success': None, 'prev_data_interval_end_success': None, 'prev_ds': '2022-01-03', 'prev_ds_nodash': '20220103', 'prev_execution_date': datetime.datetime(2022, 1, 3, 0, 0, tzinfo=Timezone('UTC')), 'prev_execution_date_success': None, 'prev_start_date_success': None, 'run_id': 'scheduled__2022-01-04T00:00:00+00:00', 'task': <Task(PythonOperator): load_invoices>, 'task_instance': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [running]>, 'task_instance_key_str': 'datawarehouse_etl__load_invoices__20220104', 'test_mode': False, 'ti': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [running]>, 'tomorrow_ds': '2022-01-05', 'tomorrow_ds_nodash': '20220105', 'ts': '2022-01-04T00:00:00+00:00', 'ts_nodash': '20220104T000000', 'ts_nodash_with_tz': '20220104T000000+0000', 'var': {'json': None, 'value': None}, 'conn': None, 'yesterday_ds': '2022-01-03', 'yesterday_ds_nodash': '20220103', 'key': 'value', 'ts_var': '2022-01-04T00:00:00+00:00', 'tsnodash_var': '20220104T000000', 'templates_dict': None}
[2022-01-24 02:34:35,291] {logging_mixin.py:109} INFO - ts:  2022-01-04 00:00:00+00:00
[2022-01-24 02:34:35,292] {taskinstance.py:1700} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1329, in _run_raw_task
    self._execute_task_with_callbacks(context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1455, in _execute_task_with_callbacks
    result = self._execute_task(context, self.task)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1511, in _execute_task
    result = execute_callable(context=context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 174, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 185, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/datawarehouse_airflow.py", line 45, in load_invoices
    print(ts.year())
TypeError: 'int' object is not callable
[2022-01-24 02:34:35,302] {taskinstance.py:1277} INFO - Marking task as FAILED. dag_id=datawarehouse_etl, task_id=load_invoices, execution_date=20220104T000000, start_date=20220124T023435, end_date=20220124T023435
[2022-01-24 02:34:35,315] {standard_task_runner.py:92} ERROR - Failed to execute job 44 for task load_invoices
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/task/task_runner/standard_task_runner.py", line 85, in _start_by_fork
    args.func(args, dag=self.dag)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/cli_parser.py", line 48, in command
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/cli.py", line 92, in wrapper
    return f(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/commands/task_command.py", line 298, in task_run
    _run_task_by_selected_method(args, dag, ti)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/commands/task_command.py", line 107, in _run_task_by_selected_method
    _run_raw_task(args, ti)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/commands/task_command.py", line 184, in _run_raw_task
    error_file=args.error_file,
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/session.py", line 70, in wrapper
    return func(*args, session=session, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1329, in _run_raw_task
    self._execute_task_with_callbacks(context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1455, in _execute_task_with_callbacks
    result = self._execute_task(context, self.task)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1511, in _execute_task
    result = execute_callable(context=context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 174, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 185, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/datawarehouse_airflow.py", line 45, in load_invoices
    print(ts.year())
TypeError: 'int' object is not callable
[2022-01-24 02:34:35,349] {local_task_job.py:154} INFO - Task exited with return code 1
[2022-01-24 02:34:35,388] {local_task_job.py:264} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-01-24 02:39:36,126] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [queued]>
[2022-01-24 02:39:36,149] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [queued]>
[2022-01-24 02:39:36,149] {taskinstance.py:1238} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 02:39:36,150] {taskinstance.py:1239} INFO - Starting attempt 1 of 1
[2022-01-24 02:39:36,150] {taskinstance.py:1240} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 02:39:36,166] {taskinstance.py:1259} INFO - Executing <Task(PythonOperator): load_invoices> on 2022-01-04 00:00:00+00:00
[2022-01-24 02:39:36,171] {standard_task_runner.py:52} INFO - Started process 2763 to run task
[2022-01-24 02:39:36,174] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'datawarehouse_etl', 'load_invoices', 'scheduled__2022-01-04T00:00:00+00:00', '--job-id', '54', '--raw', '--subdir', 'DAGS_FOLDER/datawarehouse_***.py', '--cfg-path', '/tmp/tmpvlmymybq', '--error-file', '/tmp/tmpzf8rgsj_']
[2022-01-24 02:39:36,175] {standard_task_runner.py:77} INFO - Job 54: Subtask load_invoices
[2022-01-24 02:39:36,238] {logging_mixin.py:109} INFO - Running <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [running]> on host cd9bb47288d1
[2022-01-24 02:39:36,292] {taskinstance.py:1426} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=datawarehouse_etl
AIRFLOW_CTX_TASK_ID=load_invoices
AIRFLOW_CTX_EXECUTION_DATE=2022-01-04T00:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-01-04T00:00:00+00:00
[2022-01-24 02:39:36,294] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:39:36,294] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:39:36,294] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds_nodash' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds_nodash }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:39:36,294] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_end' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:39:36,295] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:39:36,295] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:39:36,295] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:39:36,295] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date_success' from the template is deprecated and will be removed in a future version. Please use 'prev_data_interval_start_success' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:39:36,295] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:39:36,295] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:39:36,295] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:39:36,296] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:39:36,296] {logging_mixin.py:109} INFO - {'conf': <***.configuration.AirflowConfigParser object at 0x7f1e4dfc6a10>, 'dag': <DAG: datawarehouse_etl>, 'dag_run': <DagRun datawarehouse_etl @ 2022-01-04 00:00:00+00:00: scheduled__2022-01-04T00:00:00+00:00, externally triggered: False>, 'data_interval_end': DateTime(2022, 1, 5, 0, 0, 0, tzinfo=Timezone('UTC')), 'data_interval_start': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'ds': '2022-01-04', 'ds_nodash': '20220104', 'execution_date': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'inlets': [], 'logical_date': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'macros': <module '***.macros' from '/home/***/.local/lib/python3.7/site-packages/***/macros/__init__.py'>, 'next_ds': '2022-01-05', 'next_ds_nodash': '20220105', 'next_execution_date': DateTime(2022, 1, 5, 0, 0, 0, tzinfo=Timezone('UTC')), 'outlets': [], 'params': {}, 'prev_data_interval_start_success': DateTime(2022, 1, 1, 0, 0, 0, tzinfo=Timezone('UTC')), 'prev_data_interval_end_success': DateTime(2022, 1, 2, 0, 0, 0, tzinfo=Timezone('UTC')), 'prev_ds': '2022-01-03', 'prev_ds_nodash': '20220103', 'prev_execution_date': datetime.datetime(2022, 1, 3, 0, 0, tzinfo=Timezone('UTC')), 'prev_execution_date_success': DateTime(2022, 1, 1, 0, 0, 0, tzinfo=Timezone('UTC')), 'prev_start_date_success': DateTime(2022, 1, 24, 2, 39, 33, 705019, tzinfo=Timezone('UTC')), 'run_id': 'scheduled__2022-01-04T00:00:00+00:00', 'task': <Task(PythonOperator): load_invoices>, 'task_instance': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [running]>, 'task_instance_key_str': 'datawarehouse_etl__load_invoices__20220104', 'test_mode': False, 'ti': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [running]>, 'tomorrow_ds': '2022-01-05', 'tomorrow_ds_nodash': '20220105', 'ts': '2022-01-04T00:00:00+00:00', 'ts_nodash': '20220104T000000', 'ts_nodash_with_tz': '20220104T000000+0000', 'var': {'json': None, 'value': None}, 'conn': None, 'yesterday_ds': '2022-01-03', 'yesterday_ds_nodash': '20220103', 'key': 'value', 'ts_var': '2022-01-04T00:00:00+00:00', 'tsnodash_var': '20220104T000000', 'templates_dict': None}
[2022-01-24 02:39:36,297] {logging_mixin.py:109} INFO - ts:  2022-01-04 00:00:00+00:00
[2022-01-24 02:39:36,298] {logging_mixin.py:109} INFO - <class 'pandas._libs.tslibs.timestamps.Timestamp'>
[2022-01-24 02:39:36,298] {logging_mixin.py:109} INFO - Object created.
[2022-01-24 02:39:36,298] {logging_mixin.py:109} INFO - 2022 1 4
[2022-01-24 02:39:36,299] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-33.json
[2022-01-24 02:39:36,299] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-40.json
[2022-01-24 02:39:36,299] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-23.json
[2022-01-24 02:39:36,300] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-67.json
[2022-01-24 02:39:36,300] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-29.json
[2022-01-24 02:39:36,300] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-63.json
[2022-01-24 02:39:36,300] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-37.json
[2022-01-24 02:39:36,301] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-28.json
[2022-01-24 02:39:36,301] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-45.json
[2022-01-24 02:39:36,301] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-11.json
[2022-01-24 02:39:36,301] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-51.json
[2022-01-24 02:39:36,302] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-30.json
[2022-01-24 02:39:36,302] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-71.json
[2022-01-24 02:39:36,302] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-8.json
[2022-01-24 02:39:36,302] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-32.json
[2022-01-24 02:39:36,303] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-47.json
[2022-01-24 02:39:36,303] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-5.json
[2022-01-24 02:39:36,303] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-44.json
[2022-01-24 02:39:36,304] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-55.json
[2022-01-24 02:39:36,304] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-4.json
[2022-01-24 02:39:36,304] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-57.json
[2022-01-24 02:39:36,305] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-72.json
[2022-01-24 02:39:36,305] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-9.json
[2022-01-24 02:39:36,305] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-3.json
[2022-01-24 02:39:36,305] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-16.json
[2022-01-24 02:39:36,306] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-66.json
[2022-01-24 02:39:36,306] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-14.json
[2022-01-24 02:39:36,306] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-35.json
[2022-01-24 02:39:36,306] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-13.json
[2022-01-24 02:39:36,306] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-58.json
[2022-01-24 02:39:36,307] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-31.json
[2022-01-24 02:39:36,307] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-12.json
[2022-01-24 02:39:36,307] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-68.json
[2022-01-24 02:39:36,307] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-10.json
[2022-01-24 02:39:36,308] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-34.json
[2022-01-24 02:39:36,308] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-2.json
[2022-01-24 02:39:36,308] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-36.json
[2022-01-24 02:39:36,308] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-56.json
[2022-01-24 02:39:36,308] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-76.json
[2022-01-24 02:39:36,309] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-6.json
[2022-01-24 02:39:36,309] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-7.json
[2022-01-24 02:39:36,309] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-54.json
[2022-01-24 02:39:36,309] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-48.json
[2022-01-24 02:39:36,309] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-59.json
[2022-01-24 02:39:36,310] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-53.json
[2022-01-24 02:39:36,310] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-70.json
[2022-01-24 02:39:36,310] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-22.json
[2022-01-24 02:39:36,310] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-42.json
[2022-01-24 02:39:36,310] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-43.json
[2022-01-24 02:39:36,311] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-18.json
[2022-01-24 02:39:36,311] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-62.json
[2022-01-24 02:39:36,311] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-52.json
[2022-01-24 02:39:36,311] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-49.json
[2022-01-24 02:39:36,312] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-27.json
[2022-01-24 02:39:36,312] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-0.json
[2022-01-24 02:39:36,312] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-15.json
[2022-01-24 02:39:36,312] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-74.json
[2022-01-24 02:39:36,313] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-73.json
[2022-01-24 02:39:36,313] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-69.json
[2022-01-24 02:39:36,313] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-46.json
[2022-01-24 02:39:36,313] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-38.json
[2022-01-24 02:39:36,313] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-1.json
[2022-01-24 02:39:36,314] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-19.json
[2022-01-24 02:39:36,314] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-26.json
[2022-01-24 02:39:36,314] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-21.json
[2022-01-24 02:39:36,314] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-20.json
[2022-01-24 02:39:36,314] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-65.json
[2022-01-24 02:39:36,315] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-60.json
[2022-01-24 02:39:36,315] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-17.json
[2022-01-24 02:39:36,315] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-64.json
[2022-01-24 02:39:36,315] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-25.json
[2022-01-24 02:39:36,315] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-50.json
[2022-01-24 02:39:36,316] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-75.json
[2022-01-24 02:39:36,316] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-41.json
[2022-01-24 02:39:36,316] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-61.json
[2022-01-24 02:39:36,316] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-24.json
[2022-01-24 02:39:36,316] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-39.json
[2022-01-24 02:39:36,318] {logging_mixin.py:109} INFO - 77
[2022-01-24 02:39:36,337] {logging_mixin.py:109} INFO -      invoice_id    invoice_timestamp  customer_id  ...  qty is_discount      price
0   20220104-39  2022-01-04T00:49:41  mjbhujn4102  ...  164           0  6692.8400
1   20220104-45  2022-01-04T05:00:49  epybnes3286  ...  259           0  2478.6300
2    20220104-3  2022-01-04T16:45:42  yyymlnv2864  ...  182           1  5528.9962
3    20220104-7  2022-01-04T11:23:17  svphxxg5796  ...  124           1  6975.5952
4   20220104-35  2022-01-04T05:27:40  yadoags1019  ...  270           1  8984.3850
..          ...                  ...          ...  ...  ...         ...        ...
72   20220104-8  2022-01-04T14:53:17  lzoimgb3646  ...   55           1  1621.0810
73  20220104-46  2022-01-04T13:36:40  zeytfvk2553  ...   44           1   227.8804
74  20220104-64  2022-01-04T10:42:21  yadoags1019  ...  210           1  3861.6900
75  20220104-30  2022-01-04T07:13:05  codpbua4340  ...  268           1  9648.8040
76  20220104-44  2022-01-04T14:47:09  sexnidd1428  ...   54           0  2879.2800

[77 rows x 8 columns]
[2022-01-24 02:39:36,338] {python.py:175} INFO - Done. Returned value was: None
[2022-01-24 02:39:36,349] {taskinstance.py:1277} INFO - Marking task as SUCCESS. dag_id=datawarehouse_etl, task_id=load_invoices, execution_date=20220104T000000, start_date=20220124T023936, end_date=20220124T023936
[2022-01-24 02:39:36,387] {local_task_job.py:154} INFO - Task exited with return code 0
[2022-01-24 02:39:36,420] {local_task_job.py:264} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2022-01-24 03:55:07,683] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [queued]>
[2022-01-24 03:55:07,693] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [queued]>
[2022-01-24 03:55:07,693] {taskinstance.py:1238} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 03:55:07,694] {taskinstance.py:1239} INFO - Starting attempt 1 of 1
[2022-01-24 03:55:07,694] {taskinstance.py:1240} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 03:55:07,708] {taskinstance.py:1259} INFO - Executing <Task(PythonOperator): load_invoices> on 2022-01-04 00:00:00+00:00
[2022-01-24 03:55:07,712] {standard_task_runner.py:52} INFO - Started process 6185 to run task
[2022-01-24 03:55:07,716] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'datawarehouse_etl', 'load_invoices', 'scheduled__2022-01-04T00:00:00+00:00', '--job-id', '70', '--raw', '--subdir', 'DAGS_FOLDER/datawarehouse_***.py', '--cfg-path', '/tmp/tmpckcy_inp', '--error-file', '/tmp/tmp6426fnab']
[2022-01-24 03:55:07,718] {standard_task_runner.py:77} INFO - Job 70: Subtask load_invoices
[2022-01-24 03:55:07,772] {logging_mixin.py:109} INFO - Running <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [running]> on host cd9bb47288d1
[2022-01-24 03:55:07,846] {taskinstance.py:1426} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=datawarehouse_etl
AIRFLOW_CTX_TASK_ID=load_invoices
AIRFLOW_CTX_EXECUTION_DATE=2022-01-04T00:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-01-04T00:00:00+00:00
[2022-01-24 03:55:07,849] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:55:07,850] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:55:07,850] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds_nodash' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds_nodash }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:55:07,851] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_end' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:55:07,851] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:55:07,851] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:55:07,851] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:55:07,851] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date_success' from the template is deprecated and will be removed in a future version. Please use 'prev_data_interval_start_success' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:55:07,852] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:55:07,852] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:55:07,852] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:55:07,852] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:55:07,853] {logging_mixin.py:109} INFO - {'conf': <***.configuration.AirflowConfigParser object at 0x7f1e4dfc6a10>, 'dag': <DAG: datawarehouse_etl>, 'dag_run': <DagRun datawarehouse_etl @ 2022-01-04 00:00:00+00:00: scheduled__2022-01-04T00:00:00+00:00, externally triggered: False>, 'data_interval_end': DateTime(2022, 1, 5, 0, 0, 0, tzinfo=Timezone('UTC')), 'data_interval_start': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'ds': '2022-01-04', 'ds_nodash': '20220104', 'execution_date': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'inlets': [], 'logical_date': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'macros': <module '***.macros' from '/home/***/.local/lib/python3.7/site-packages/***/macros/__init__.py'>, 'next_ds': '2022-01-05', 'next_ds_nodash': '20220105', 'next_execution_date': DateTime(2022, 1, 5, 0, 0, 0, tzinfo=Timezone('UTC')), 'outlets': [], 'params': {}, 'prev_data_interval_start_success': DateTime(2022, 1, 3, 0, 0, 0, tzinfo=Timezone('UTC')), 'prev_data_interval_end_success': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'prev_ds': '2022-01-03', 'prev_ds_nodash': '20220103', 'prev_execution_date': datetime.datetime(2022, 1, 3, 0, 0, tzinfo=Timezone('UTC')), 'prev_execution_date_success': DateTime(2022, 1, 3, 0, 0, 0, tzinfo=Timezone('UTC')), 'prev_start_date_success': DateTime(2022, 1, 24, 3, 52, 28, 415719, tzinfo=Timezone('UTC')), 'run_id': 'scheduled__2022-01-04T00:00:00+00:00', 'task': <Task(PythonOperator): load_invoices>, 'task_instance': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [running]>, 'task_instance_key_str': 'datawarehouse_etl__load_invoices__20220104', 'test_mode': False, 'ti': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [running]>, 'tomorrow_ds': '2022-01-05', 'tomorrow_ds_nodash': '20220105', 'ts': '2022-01-04T00:00:00+00:00', 'ts_nodash': '20220104T000000', 'ts_nodash_with_tz': '20220104T000000+0000', 'var': {'json': None, 'value': None}, 'conn': None, 'yesterday_ds': '2022-01-03', 'yesterday_ds_nodash': '20220103', 'key': 'value', 'ts_var': '2022-01-04T00:00:00+00:00', 'tsnodash_var': '20220104T000000', 'templates_dict': None}
[2022-01-24 03:55:07,855] {logging_mixin.py:109} INFO - ts:  2022-01-04 00:00:00+00:00
[2022-01-24 03:55:07,856] {logging_mixin.py:109} INFO - <class 'pandas._libs.tslibs.timestamps.Timestamp'>
[2022-01-24 03:55:07,856] {logging_mixin.py:109} INFO - Object created.
[2022-01-24 03:55:07,856] {logging_mixin.py:109} INFO - 2022 1 4
[2022-01-24 03:55:07,858] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-33.json
[2022-01-24 03:55:07,858] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-40.json
[2022-01-24 03:55:07,858] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-23.json
[2022-01-24 03:55:07,858] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-67.json
[2022-01-24 03:55:07,859] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-29.json
[2022-01-24 03:55:07,859] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-63.json
[2022-01-24 03:55:07,859] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-37.json
[2022-01-24 03:55:07,859] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-28.json
[2022-01-24 03:55:07,859] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-45.json
[2022-01-24 03:55:07,859] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-11.json
[2022-01-24 03:55:07,860] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-51.json
[2022-01-24 03:55:07,860] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-30.json
[2022-01-24 03:55:07,860] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-71.json
[2022-01-24 03:55:07,860] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-8.json
[2022-01-24 03:55:07,861] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-32.json
[2022-01-24 03:55:07,861] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-47.json
[2022-01-24 03:55:07,861] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-5.json
[2022-01-24 03:55:07,861] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-44.json
[2022-01-24 03:55:07,861] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-55.json
[2022-01-24 03:55:07,862] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-4.json
[2022-01-24 03:55:07,862] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-57.json
[2022-01-24 03:55:07,862] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-72.json
[2022-01-24 03:55:07,862] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-9.json
[2022-01-24 03:55:07,863] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-3.json
[2022-01-24 03:55:07,863] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-16.json
[2022-01-24 03:55:07,863] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-66.json
[2022-01-24 03:55:07,863] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-14.json
[2022-01-24 03:55:07,864] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-35.json
[2022-01-24 03:55:07,864] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-13.json
[2022-01-24 03:55:07,865] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-58.json
[2022-01-24 03:55:07,866] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-31.json
[2022-01-24 03:55:07,866] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-12.json
[2022-01-24 03:55:07,867] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-68.json
[2022-01-24 03:55:07,867] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-10.json
[2022-01-24 03:55:07,867] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-34.json
[2022-01-24 03:55:07,867] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-2.json
[2022-01-24 03:55:07,867] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-36.json
[2022-01-24 03:55:07,868] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-56.json
[2022-01-24 03:55:07,868] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-76.json
[2022-01-24 03:55:07,868] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-6.json
[2022-01-24 03:55:07,868] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-7.json
[2022-01-24 03:55:07,869] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-54.json
[2022-01-24 03:55:07,869] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-48.json
[2022-01-24 03:55:07,869] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-59.json
[2022-01-24 03:55:07,870] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-53.json
[2022-01-24 03:55:07,870] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-70.json
[2022-01-24 03:55:07,870] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-22.json
[2022-01-24 03:55:07,870] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-42.json
[2022-01-24 03:55:07,871] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-43.json
[2022-01-24 03:55:07,872] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-18.json
[2022-01-24 03:55:07,872] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-62.json
[2022-01-24 03:55:07,873] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-52.json
[2022-01-24 03:55:07,873] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-49.json
[2022-01-24 03:55:07,874] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-27.json
[2022-01-24 03:55:07,874] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-0.json
[2022-01-24 03:55:07,874] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-15.json
[2022-01-24 03:55:07,874] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-74.json
[2022-01-24 03:55:07,874] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-73.json
[2022-01-24 03:55:07,875] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-69.json
[2022-01-24 03:55:07,875] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-46.json
[2022-01-24 03:55:07,875] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-38.json
[2022-01-24 03:55:07,875] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-1.json
[2022-01-24 03:55:07,876] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-19.json
[2022-01-24 03:55:07,876] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-26.json
[2022-01-24 03:55:07,876] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-21.json
[2022-01-24 03:55:07,876] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-20.json
[2022-01-24 03:55:07,876] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-65.json
[2022-01-24 03:55:07,877] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-60.json
[2022-01-24 03:55:07,877] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-17.json
[2022-01-24 03:55:07,877] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-64.json
[2022-01-24 03:55:07,877] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-25.json
[2022-01-24 03:55:07,877] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-50.json
[2022-01-24 03:55:07,878] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-75.json
[2022-01-24 03:55:07,878] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-41.json
[2022-01-24 03:55:07,878] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-61.json
[2022-01-24 03:55:07,878] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-24.json
[2022-01-24 03:55:07,879] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-39.json
[2022-01-24 03:55:07,883] {logging_mixin.py:109} INFO - 77
[2022-01-24 03:55:07,913] {logging_mixin.py:109} INFO -      invoice_id    invoice_timestamp  customer_id  ...  qty is_discount      price
0   20220104-39  2022-01-04T00:49:41  mjbhujn4102  ...  164           0  6692.8400
1   20220104-45  2022-01-04T05:00:49  epybnes3286  ...  259           0  2478.6300
2    20220104-3  2022-01-04T16:45:42  yyymlnv2864  ...  182           1  5528.9962
3    20220104-7  2022-01-04T11:23:17  svphxxg5796  ...  124           1  6975.5952
4   20220104-35  2022-01-04T05:27:40  yadoags1019  ...  270           1  8984.3850
..          ...                  ...          ...  ...  ...         ...        ...
72   20220104-8  2022-01-04T14:53:17  lzoimgb3646  ...   55           1  1621.0810
73  20220104-46  2022-01-04T13:36:40  zeytfvk2553  ...   44           1   227.8804
74  20220104-64  2022-01-04T10:42:21  yadoags1019  ...  210           1  3861.6900
75  20220104-30  2022-01-04T07:13:05  codpbua4340  ...  268           1  9648.8040
76  20220104-44  2022-01-04T14:47:09  sexnidd1428  ...   54           0  2879.2800

[77 rows x 8 columns]
[2022-01-24 03:55:07,930] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: sales_dw, Login: awsuser, Password: ***, extra: {}
[2022-01-24 03:55:07,943] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: sales_dw, Login: awsuser, Password: ***, extra: {}
[2022-01-24 03:55:16,377] {python.py:175} INFO - Done. Returned value was: None
[2022-01-24 03:55:16,394] {taskinstance.py:1277} INFO - Marking task as SUCCESS. dag_id=datawarehouse_etl, task_id=load_invoices, execution_date=20220104T000000, start_date=20220124T035507, end_date=20220124T035516
[2022-01-24 03:55:16,436] {local_task_job.py:154} INFO - Task exited with return code 0
[2022-01-24 03:55:16,477] {local_task_job.py:264} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2022-01-24 03:55:40,439] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [queued]>
[2022-01-24 03:55:40,451] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [queued]>
[2022-01-24 03:55:40,451] {taskinstance.py:1238} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 03:55:40,452] {taskinstance.py:1239} INFO - Starting attempt 1 of 1
[2022-01-24 03:55:40,452] {taskinstance.py:1240} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 03:55:40,468] {taskinstance.py:1259} INFO - Executing <Task(PythonOperator): load_invoices> on 2022-01-04 00:00:00+00:00
[2022-01-24 03:55:40,474] {standard_task_runner.py:52} INFO - Started process 6223 to run task
[2022-01-24 03:55:40,476] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'datawarehouse_etl', 'load_invoices', 'scheduled__2022-01-04T00:00:00+00:00', '--job-id', '73', '--raw', '--subdir', 'DAGS_FOLDER/datawarehouse_***.py', '--cfg-path', '/tmp/tmpp1qq3irk', '--error-file', '/tmp/tmptz29suig']
[2022-01-24 03:55:40,477] {standard_task_runner.py:77} INFO - Job 73: Subtask load_invoices
[2022-01-24 03:55:40,522] {logging_mixin.py:109} INFO - Running <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [running]> on host cd9bb47288d1
[2022-01-24 03:55:40,578] {taskinstance.py:1426} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=datawarehouse_etl
AIRFLOW_CTX_TASK_ID=load_invoices
AIRFLOW_CTX_EXECUTION_DATE=2022-01-04T00:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-01-04T00:00:00+00:00
[2022-01-24 03:55:40,580] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:55:40,580] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:55:40,580] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds_nodash' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds_nodash }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:55:40,580] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_end' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:55:40,580] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:55:40,580] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:55:40,580] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:55:40,581] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date_success' from the template is deprecated and will be removed in a future version. Please use 'prev_data_interval_start_success' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:55:40,581] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:55:40,581] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:55:40,581] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:55:40,581] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:55:40,581] {logging_mixin.py:109} INFO - {'conf': <***.configuration.AirflowConfigParser object at 0x7f1e4dfc6a10>, 'dag': <DAG: datawarehouse_etl>, 'dag_run': <DagRun datawarehouse_etl @ 2022-01-04 00:00:00+00:00: scheduled__2022-01-04T00:00:00+00:00, externally triggered: False>, 'data_interval_end': DateTime(2022, 1, 5, 0, 0, 0, tzinfo=Timezone('UTC')), 'data_interval_start': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'ds': '2022-01-04', 'ds_nodash': '20220104', 'execution_date': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'inlets': [], 'logical_date': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'macros': <module '***.macros' from '/home/***/.local/lib/python3.7/site-packages/***/macros/__init__.py'>, 'next_ds': '2022-01-05', 'next_ds_nodash': '20220105', 'next_execution_date': DateTime(2022, 1, 5, 0, 0, 0, tzinfo=Timezone('UTC')), 'outlets': [], 'params': {}, 'prev_data_interval_start_success': None, 'prev_data_interval_end_success': None, 'prev_ds': '2022-01-03', 'prev_ds_nodash': '20220103', 'prev_execution_date': datetime.datetime(2022, 1, 3, 0, 0, tzinfo=Timezone('UTC')), 'prev_execution_date_success': None, 'prev_start_date_success': None, 'run_id': 'scheduled__2022-01-04T00:00:00+00:00', 'task': <Task(PythonOperator): load_invoices>, 'task_instance': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [running]>, 'task_instance_key_str': 'datawarehouse_etl__load_invoices__20220104', 'test_mode': False, 'ti': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [running]>, 'tomorrow_ds': '2022-01-05', 'tomorrow_ds_nodash': '20220105', 'ts': '2022-01-04T00:00:00+00:00', 'ts_nodash': '20220104T000000', 'ts_nodash_with_tz': '20220104T000000+0000', 'var': {'json': None, 'value': None}, 'conn': None, 'yesterday_ds': '2022-01-03', 'yesterday_ds_nodash': '20220103', 'key': 'value', 'ts_var': '2022-01-04T00:00:00+00:00', 'tsnodash_var': '20220104T000000', 'templates_dict': None}
[2022-01-24 03:55:40,583] {logging_mixin.py:109} INFO - ts:  2022-01-04 00:00:00+00:00
[2022-01-24 03:55:40,583] {logging_mixin.py:109} INFO - <class 'pandas._libs.tslibs.timestamps.Timestamp'>
[2022-01-24 03:55:40,583] {logging_mixin.py:109} INFO - Object created.
[2022-01-24 03:55:40,583] {logging_mixin.py:109} INFO - 2022 1 4
[2022-01-24 03:55:40,584] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-33.json
[2022-01-24 03:55:40,584] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-40.json
[2022-01-24 03:55:40,585] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-23.json
[2022-01-24 03:55:40,585] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-67.json
[2022-01-24 03:55:40,585] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-29.json
[2022-01-24 03:55:40,585] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-63.json
[2022-01-24 03:55:40,585] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-37.json
[2022-01-24 03:55:40,585] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-28.json
[2022-01-24 03:55:40,585] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-45.json
[2022-01-24 03:55:40,585] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-11.json
[2022-01-24 03:55:40,585] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-51.json
[2022-01-24 03:55:40,585] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-30.json
[2022-01-24 03:55:40,586] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-71.json
[2022-01-24 03:55:40,586] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-8.json
[2022-01-24 03:55:40,586] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-32.json
[2022-01-24 03:55:40,586] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-47.json
[2022-01-24 03:55:40,586] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-5.json
[2022-01-24 03:55:40,586] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-44.json
[2022-01-24 03:55:40,586] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-55.json
[2022-01-24 03:55:40,586] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-4.json
[2022-01-24 03:55:40,586] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-57.json
[2022-01-24 03:55:40,586] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-72.json
[2022-01-24 03:55:40,587] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-9.json
[2022-01-24 03:55:40,587] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-3.json
[2022-01-24 03:55:40,587] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-16.json
[2022-01-24 03:55:40,587] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-66.json
[2022-01-24 03:55:40,587] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-14.json
[2022-01-24 03:55:40,587] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-35.json
[2022-01-24 03:55:40,587] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-13.json
[2022-01-24 03:55:40,587] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-58.json
[2022-01-24 03:55:40,587] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-31.json
[2022-01-24 03:55:40,587] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-12.json
[2022-01-24 03:55:40,587] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-68.json
[2022-01-24 03:55:40,587] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-10.json
[2022-01-24 03:55:40,588] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-34.json
[2022-01-24 03:55:40,588] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-2.json
[2022-01-24 03:55:40,588] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-36.json
[2022-01-24 03:55:40,588] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-56.json
[2022-01-24 03:55:40,588] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-76.json
[2022-01-24 03:55:40,588] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-6.json
[2022-01-24 03:55:40,588] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-7.json
[2022-01-24 03:55:40,588] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-54.json
[2022-01-24 03:55:40,588] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-48.json
[2022-01-24 03:55:40,588] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-59.json
[2022-01-24 03:55:40,589] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-53.json
[2022-01-24 03:55:40,589] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-70.json
[2022-01-24 03:55:40,589] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-22.json
[2022-01-24 03:55:40,589] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-42.json
[2022-01-24 03:55:40,589] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-43.json
[2022-01-24 03:55:40,589] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-18.json
[2022-01-24 03:55:40,589] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-62.json
[2022-01-24 03:55:40,589] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-52.json
[2022-01-24 03:55:40,589] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-49.json
[2022-01-24 03:55:40,589] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-27.json
[2022-01-24 03:55:40,589] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-0.json
[2022-01-24 03:55:40,589] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-15.json
[2022-01-24 03:55:40,590] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-74.json
[2022-01-24 03:55:40,590] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-73.json
[2022-01-24 03:55:40,590] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-69.json
[2022-01-24 03:55:40,590] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-46.json
[2022-01-24 03:55:40,590] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-38.json
[2022-01-24 03:55:40,590] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-1.json
[2022-01-24 03:55:40,590] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-19.json
[2022-01-24 03:55:40,590] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-26.json
[2022-01-24 03:55:40,590] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-21.json
[2022-01-24 03:55:40,590] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-20.json
[2022-01-24 03:55:40,590] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-65.json
[2022-01-24 03:55:40,591] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-60.json
[2022-01-24 03:55:40,591] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-17.json
[2022-01-24 03:55:40,591] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-64.json
[2022-01-24 03:55:40,591] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-25.json
[2022-01-24 03:55:40,591] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-50.json
[2022-01-24 03:55:40,591] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-75.json
[2022-01-24 03:55:40,591] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-41.json
[2022-01-24 03:55:40,591] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-61.json
[2022-01-24 03:55:40,591] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-24.json
[2022-01-24 03:55:40,591] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-39.json
[2022-01-24 03:55:40,599] {logging_mixin.py:109} INFO - 77
[2022-01-24 03:55:40,630] {logging_mixin.py:109} INFO -      invoice_id    invoice_timestamp  customer_id  ...  qty is_discount      price
0   20220104-39  2022-01-04T00:49:41  mjbhujn4102  ...  164           0  6692.8400
1   20220104-45  2022-01-04T05:00:49  epybnes3286  ...  259           0  2478.6300
2    20220104-3  2022-01-04T16:45:42  yyymlnv2864  ...  182           1  5528.9962
3    20220104-7  2022-01-04T11:23:17  svphxxg5796  ...  124           1  6975.5952
4   20220104-35  2022-01-04T05:27:40  yadoags1019  ...  270           1  8984.3850
..          ...                  ...          ...  ...  ...         ...        ...
72   20220104-8  2022-01-04T14:53:17  lzoimgb3646  ...   55           1  1621.0810
73  20220104-46  2022-01-04T13:36:40  zeytfvk2553  ...   44           1   227.8804
74  20220104-64  2022-01-04T10:42:21  yadoags1019  ...  210           1  3861.6900
75  20220104-30  2022-01-04T07:13:05  codpbua4340  ...  268           1  9648.8040
76  20220104-44  2022-01-04T14:47:09  sexnidd1428  ...   54           0  2879.2800

[77 rows x 8 columns]
[2022-01-24 03:55:40,642] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: sales_dw, Login: awsuser, Password: ***, extra: {}
[2022-01-24 03:55:40,654] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: sales_dw, Login: awsuser, Password: ***, extra: {}
[2022-01-24 03:55:53,730] {python.py:175} INFO - Done. Returned value was: None
[2022-01-24 03:55:53,740] {taskinstance.py:1277} INFO - Marking task as SUCCESS. dag_id=datawarehouse_etl, task_id=load_invoices, execution_date=20220104T000000, start_date=20220124T035540, end_date=20220124T035553
[2022-01-24 03:55:53,772] {local_task_job.py:154} INFO - Task exited with return code 0
[2022-01-24 03:55:53,803] {local_task_job.py:264} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-01-24 04:25:26,935] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [queued]>
[2022-01-24 04:25:26,957] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [queued]>
[2022-01-24 04:25:26,957] {taskinstance.py:1238} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 04:25:26,957] {taskinstance.py:1239} INFO - Starting attempt 1 of 1
[2022-01-24 04:25:26,957] {taskinstance.py:1240} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 04:25:26,975] {taskinstance.py:1259} INFO - Executing <Task(PythonOperator): load_invoices> on 2022-01-04 00:00:00+00:00
[2022-01-24 04:25:26,985] {standard_task_runner.py:52} INFO - Started process 7575 to run task
[2022-01-24 04:25:26,991] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'datawarehouse_etl', 'load_invoices', 'scheduled__2022-01-04T00:00:00+00:00', '--job-id', '82', '--raw', '--subdir', 'DAGS_FOLDER/datawarehouse_***.py', '--cfg-path', '/tmp/tmpyfo5lf3y', '--error-file', '/tmp/tmp8h4v08jy']
[2022-01-24 04:25:26,992] {standard_task_runner.py:77} INFO - Job 82: Subtask load_invoices
[2022-01-24 04:25:27,038] {logging_mixin.py:109} INFO - Running <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [running]> on host cd9bb47288d1
[2022-01-24 04:25:27,083] {taskinstance.py:1426} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=datawarehouse_etl
AIRFLOW_CTX_TASK_ID=load_invoices
AIRFLOW_CTX_EXECUTION_DATE=2022-01-04T00:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-01-04T00:00:00+00:00
[2022-01-24 04:25:27,085] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 04:25:27,085] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 04:25:27,085] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds_nodash' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds_nodash }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 04:25:27,085] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_end' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 04:25:27,085] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 04:25:27,085] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 04:25:27,085] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 04:25:27,085] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date_success' from the template is deprecated and will be removed in a future version. Please use 'prev_data_interval_start_success' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 04:25:27,086] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 04:25:27,086] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 04:25:27,086] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 04:25:27,086] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 04:25:27,086] {logging_mixin.py:109} INFO - {'conf': <***.configuration.AirflowConfigParser object at 0x7f1e4dfc6a10>, 'dag': <DAG: datawarehouse_etl>, 'dag_run': <DagRun datawarehouse_etl @ 2022-01-04 00:00:00+00:00: scheduled__2022-01-04T00:00:00+00:00, externally triggered: False>, 'data_interval_end': DateTime(2022, 1, 5, 0, 0, 0, tzinfo=Timezone('UTC')), 'data_interval_start': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'ds': '2022-01-04', 'ds_nodash': '20220104', 'execution_date': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'inlets': [], 'logical_date': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'macros': <module '***.macros' from '/home/***/.local/lib/python3.7/site-packages/***/macros/__init__.py'>, 'next_ds': '2022-01-05', 'next_ds_nodash': '20220105', 'next_execution_date': DateTime(2022, 1, 5, 0, 0, 0, tzinfo=Timezone('UTC')), 'outlets': [], 'params': {}, 'prev_data_interval_start_success': None, 'prev_data_interval_end_success': None, 'prev_ds': '2022-01-03', 'prev_ds_nodash': '20220103', 'prev_execution_date': datetime.datetime(2022, 1, 3, 0, 0, tzinfo=Timezone('UTC')), 'prev_execution_date_success': None, 'prev_start_date_success': None, 'run_id': 'scheduled__2022-01-04T00:00:00+00:00', 'task': <Task(PythonOperator): load_invoices>, 'task_instance': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [running]>, 'task_instance_key_str': 'datawarehouse_etl__load_invoices__20220104', 'test_mode': False, 'ti': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [running]>, 'tomorrow_ds': '2022-01-05', 'tomorrow_ds_nodash': '20220105', 'ts': '2022-01-04T00:00:00+00:00', 'ts_nodash': '20220104T000000', 'ts_nodash_with_tz': '20220104T000000+0000', 'var': {'json': None, 'value': None}, 'conn': None, 'yesterday_ds': '2022-01-03', 'yesterday_ds_nodash': '20220103', 'key': 'value', 'ts_var': '2022-01-04T00:00:00+00:00', 'tsnodash_var': '20220104T000000', 'templates_dict': None}
[2022-01-24 04:25:27,087] {logging_mixin.py:109} INFO - ts:  2022-01-04 00:00:00+00:00
[2022-01-24 04:25:27,087] {logging_mixin.py:109} INFO - <class 'pandas._libs.tslibs.timestamps.Timestamp'>
[2022-01-24 04:25:27,087] {logging_mixin.py:109} INFO - Object created.
[2022-01-24 04:25:27,087] {logging_mixin.py:109} INFO - 2022 1 4
[2022-01-24 04:25:27,088] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-33.json
[2022-01-24 04:25:27,088] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-40.json
[2022-01-24 04:25:27,088] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-23.json
[2022-01-24 04:25:27,088] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-67.json
[2022-01-24 04:25:27,088] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-29.json
[2022-01-24 04:25:27,088] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-63.json
[2022-01-24 04:25:27,089] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-37.json
[2022-01-24 04:25:27,089] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-28.json
[2022-01-24 04:25:27,089] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-45.json
[2022-01-24 04:25:27,089] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-11.json
[2022-01-24 04:25:27,089] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-51.json
[2022-01-24 04:25:27,089] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-30.json
[2022-01-24 04:25:27,089] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-71.json
[2022-01-24 04:25:27,089] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-8.json
[2022-01-24 04:25:27,089] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-32.json
[2022-01-24 04:25:27,089] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-47.json
[2022-01-24 04:25:27,089] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-5.json
[2022-01-24 04:25:27,090] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-44.json
[2022-01-24 04:25:27,090] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-55.json
[2022-01-24 04:25:27,090] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-4.json
[2022-01-24 04:25:27,090] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-57.json
[2022-01-24 04:25:27,090] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-72.json
[2022-01-24 04:25:27,090] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-9.json
[2022-01-24 04:25:27,090] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-3.json
[2022-01-24 04:25:27,090] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-16.json
[2022-01-24 04:25:27,090] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-66.json
[2022-01-24 04:25:27,090] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-14.json
[2022-01-24 04:25:27,090] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-35.json
[2022-01-24 04:25:27,090] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-13.json
[2022-01-24 04:25:27,091] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-58.json
[2022-01-24 04:25:27,091] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-31.json
[2022-01-24 04:25:27,091] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-12.json
[2022-01-24 04:25:27,091] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-68.json
[2022-01-24 04:25:27,091] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-10.json
[2022-01-24 04:25:27,091] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-34.json
[2022-01-24 04:25:27,091] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-2.json
[2022-01-24 04:25:27,091] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-36.json
[2022-01-24 04:25:27,091] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-56.json
[2022-01-24 04:25:27,091] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-76.json
[2022-01-24 04:25:27,091] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-6.json
[2022-01-24 04:25:27,091] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-7.json
[2022-01-24 04:25:27,092] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-54.json
[2022-01-24 04:25:27,092] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-48.json
[2022-01-24 04:25:27,092] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-59.json
[2022-01-24 04:25:27,092] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-53.json
[2022-01-24 04:25:27,092] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-70.json
[2022-01-24 04:25:27,092] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-22.json
[2022-01-24 04:25:27,092] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-42.json
[2022-01-24 04:25:27,092] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-43.json
[2022-01-24 04:25:27,092] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-18.json
[2022-01-24 04:25:27,092] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-62.json
[2022-01-24 04:25:27,092] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-52.json
[2022-01-24 04:25:27,093] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-49.json
[2022-01-24 04:25:27,093] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-27.json
[2022-01-24 04:25:27,093] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-0.json
[2022-01-24 04:25:27,093] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-15.json
[2022-01-24 04:25:27,093] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-74.json
[2022-01-24 04:25:27,093] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-73.json
[2022-01-24 04:25:27,093] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-69.json
[2022-01-24 04:25:27,093] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-46.json
[2022-01-24 04:25:27,093] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-38.json
[2022-01-24 04:25:27,093] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-1.json
[2022-01-24 04:25:27,093] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-19.json
[2022-01-24 04:25:27,094] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-26.json
[2022-01-24 04:25:27,094] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-21.json
[2022-01-24 04:25:27,094] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-20.json
[2022-01-24 04:25:27,094] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-65.json
[2022-01-24 04:25:27,094] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-60.json
[2022-01-24 04:25:27,094] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-17.json
[2022-01-24 04:25:27,094] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-64.json
[2022-01-24 04:25:27,094] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-25.json
[2022-01-24 04:25:27,094] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-50.json
[2022-01-24 04:25:27,094] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-75.json
[2022-01-24 04:25:27,094] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-41.json
[2022-01-24 04:25:27,094] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-61.json
[2022-01-24 04:25:27,095] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-24.json
[2022-01-24 04:25:27,095] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-39.json
[2022-01-24 04:25:27,097] {logging_mixin.py:109} INFO - 77
[2022-01-24 04:25:27,113] {logging_mixin.py:109} INFO -      invoice_id    invoice_timestamp  customer_id  ...  qty is_discount      price
0   20220104-39  2022-01-04T00:49:41  mjbhujn4102  ...  164           0  6692.8400
1   20220104-45  2022-01-04T05:00:49  epybnes3286  ...  259           0  2478.6300
2    20220104-3  2022-01-04T16:45:42  yyymlnv2864  ...  182           1  5528.9962
3    20220104-7  2022-01-04T11:23:17  svphxxg5796  ...  124           1  6975.5952
4   20220104-35  2022-01-04T05:27:40  yadoags1019  ...  270           1  8984.3850
..          ...                  ...          ...  ...  ...         ...        ...
72   20220104-8  2022-01-04T14:53:17  lzoimgb3646  ...   55           1  1621.0810
73  20220104-46  2022-01-04T13:36:40  zeytfvk2553  ...   44           1   227.8804
74  20220104-64  2022-01-04T10:42:21  yadoags1019  ...  210           1  3861.6900
75  20220104-30  2022-01-04T07:13:05  codpbua4340  ...  268           1  9648.8040
76  20220104-44  2022-01-04T14:47:09  sexnidd1428  ...   54           0  2879.2800

[77 rows x 8 columns]
[2022-01-24 04:25:27,122] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: sales_dw, Login: awsuser, Password: ***, extra: {}
[2022-01-24 04:25:27,128] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: sales_dw, Login: awsuser, Password: ***, extra: {}
[2022-01-24 04:25:39,501] {python.py:175} INFO - Done. Returned value was: None
[2022-01-24 04:25:39,514] {taskinstance.py:1277} INFO - Marking task as SUCCESS. dag_id=datawarehouse_etl, task_id=load_invoices, execution_date=20220104T000000, start_date=20220124T042526, end_date=20220124T042539
[2022-01-24 04:25:39,568] {local_task_job.py:154} INFO - Task exited with return code 0
[2022-01-24 04:25:39,595] {local_task_job.py:264} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2022-01-24 05:19:48,472] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [queued]>
[2022-01-24 05:19:48,483] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [queued]>
[2022-01-24 05:19:48,483] {taskinstance.py:1238} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 05:19:48,483] {taskinstance.py:1239} INFO - Starting attempt 1 of 1
[2022-01-24 05:19:48,483] {taskinstance.py:1240} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 05:19:48,495] {taskinstance.py:1259} INFO - Executing <Task(PythonOperator): load_invoices> on 2022-01-04 00:00:00+00:00
[2022-01-24 05:19:48,502] {standard_task_runner.py:52} INFO - Started process 10077 to run task
[2022-01-24 05:19:48,505] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'datawarehouse_etl', 'load_invoices', 'scheduled__2022-01-04T00:00:00+00:00', '--job-id', '85', '--raw', '--subdir', 'DAGS_FOLDER/datawarehouse_***.py', '--cfg-path', '/tmp/tmpz9euamgz', '--error-file', '/tmp/tmp5ya4y604']
[2022-01-24 05:19:48,505] {standard_task_runner.py:77} INFO - Job 85: Subtask load_invoices
[2022-01-24 05:19:48,559] {logging_mixin.py:109} INFO - Running <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [running]> on host cd9bb47288d1
[2022-01-24 05:19:48,608] {taskinstance.py:1426} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=datawarehouse_etl
AIRFLOW_CTX_TASK_ID=load_invoices
AIRFLOW_CTX_EXECUTION_DATE=2022-01-04T00:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-01-04T00:00:00+00:00
[2022-01-24 05:19:48,610] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 05:19:48,611] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 05:19:48,611] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds_nodash' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds_nodash }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 05:19:48,611] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_end' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 05:19:48,612] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 05:19:48,612] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 05:19:48,612] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 05:19:48,612] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date_success' from the template is deprecated and will be removed in a future version. Please use 'prev_data_interval_start_success' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 05:19:48,613] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 05:19:48,613] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 05:19:48,613] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 05:19:48,613] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 05:19:48,614] {logging_mixin.py:109} INFO - {'conf': <***.configuration.AirflowConfigParser object at 0x7f1e4dfc6a10>, 'dag': <DAG: datawarehouse_etl>, 'dag_run': <DagRun datawarehouse_etl @ 2022-01-04 00:00:00+00:00: scheduled__2022-01-04T00:00:00+00:00, externally triggered: False>, 'data_interval_end': DateTime(2022, 1, 5, 0, 0, 0, tzinfo=Timezone('UTC')), 'data_interval_start': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'ds': '2022-01-04', 'ds_nodash': '20220104', 'execution_date': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'inlets': [], 'logical_date': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'macros': <module '***.macros' from '/home/***/.local/lib/python3.7/site-packages/***/macros/__init__.py'>, 'next_ds': '2022-01-05', 'next_ds_nodash': '20220105', 'next_execution_date': DateTime(2022, 1, 5, 0, 0, 0, tzinfo=Timezone('UTC')), 'outlets': [], 'params': {}, 'prev_data_interval_start_success': None, 'prev_data_interval_end_success': None, 'prev_ds': '2022-01-03', 'prev_ds_nodash': '20220103', 'prev_execution_date': datetime.datetime(2022, 1, 3, 0, 0, tzinfo=Timezone('UTC')), 'prev_execution_date_success': None, 'prev_start_date_success': None, 'run_id': 'scheduled__2022-01-04T00:00:00+00:00', 'task': <Task(PythonOperator): load_invoices>, 'task_instance': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [running]>, 'task_instance_key_str': 'datawarehouse_etl__load_invoices__20220104', 'test_mode': False, 'ti': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [running]>, 'tomorrow_ds': '2022-01-05', 'tomorrow_ds_nodash': '20220105', 'ts': '2022-01-04T00:00:00+00:00', 'ts_nodash': '20220104T000000', 'ts_nodash_with_tz': '20220104T000000+0000', 'var': {'json': None, 'value': None}, 'conn': None, 'yesterday_ds': '2022-01-03', 'yesterday_ds_nodash': '20220103', 'key': 'value', 'ts_var': '2022-01-04T00:00:00+00:00', 'tsnodash_var': '20220104T000000', 'templates_dict': None}
[2022-01-24 05:19:48,616] {logging_mixin.py:109} INFO - ts:  2022-01-04 00:00:00+00:00
[2022-01-24 05:19:48,617] {logging_mixin.py:109} INFO - <class 'pandas._libs.tslibs.timestamps.Timestamp'>
[2022-01-24 05:19:48,617] {logging_mixin.py:109} INFO - Object created.
[2022-01-24 05:19:48,618] {logging_mixin.py:109} INFO - 2022 1 4
[2022-01-24 05:19:48,619] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-33.json
[2022-01-24 05:19:48,620] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-40.json
[2022-01-24 05:19:48,620] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-23.json
[2022-01-24 05:19:48,621] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-67.json
[2022-01-24 05:19:48,621] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-29.json
[2022-01-24 05:19:48,621] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-63.json
[2022-01-24 05:19:48,621] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-37.json
[2022-01-24 05:19:48,622] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-28.json
[2022-01-24 05:19:48,622] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-45.json
[2022-01-24 05:19:48,622] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-11.json
[2022-01-24 05:19:48,623] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-51.json
[2022-01-24 05:19:48,623] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-30.json
[2022-01-24 05:19:48,623] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-71.json
[2022-01-24 05:19:48,623] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-8.json
[2022-01-24 05:19:48,624] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-32.json
[2022-01-24 05:19:48,624] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-47.json
[2022-01-24 05:19:48,624] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-5.json
[2022-01-24 05:19:48,624] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-44.json
[2022-01-24 05:19:48,625] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-55.json
[2022-01-24 05:19:48,625] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-4.json
[2022-01-24 05:19:48,625] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-57.json
[2022-01-24 05:19:48,626] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-72.json
[2022-01-24 05:19:48,626] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-9.json
[2022-01-24 05:19:48,626] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-3.json
[2022-01-24 05:19:48,626] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-16.json
[2022-01-24 05:19:48,627] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-66.json
[2022-01-24 05:19:48,627] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-14.json
[2022-01-24 05:19:48,628] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-35.json
[2022-01-24 05:19:48,628] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-13.json
[2022-01-24 05:19:48,628] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-58.json
[2022-01-24 05:19:48,628] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-31.json
[2022-01-24 05:19:48,629] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-12.json
[2022-01-24 05:19:48,629] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-68.json
[2022-01-24 05:19:48,629] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-10.json
[2022-01-24 05:19:48,629] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-34.json
[2022-01-24 05:19:48,630] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-2.json
[2022-01-24 05:19:48,630] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-36.json
[2022-01-24 05:19:48,630] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-56.json
[2022-01-24 05:19:48,630] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-76.json
[2022-01-24 05:19:48,630] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-6.json
[2022-01-24 05:19:48,631] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-7.json
[2022-01-24 05:19:48,631] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-54.json
[2022-01-24 05:19:48,631] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-48.json
[2022-01-24 05:19:48,632] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-59.json
[2022-01-24 05:19:48,632] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-53.json
[2022-01-24 05:19:48,632] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-70.json
[2022-01-24 05:19:48,633] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-22.json
[2022-01-24 05:19:48,633] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-42.json
[2022-01-24 05:19:48,633] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-43.json
[2022-01-24 05:19:48,634] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-18.json
[2022-01-24 05:19:48,634] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-62.json
[2022-01-24 05:19:48,634] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-52.json
[2022-01-24 05:19:48,634] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-49.json
[2022-01-24 05:19:48,635] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-27.json
[2022-01-24 05:19:48,635] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-0.json
[2022-01-24 05:19:48,635] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-15.json
[2022-01-24 05:19:48,635] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-74.json
[2022-01-24 05:19:48,636] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-73.json
[2022-01-24 05:19:48,636] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-69.json
[2022-01-24 05:19:48,636] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-46.json
[2022-01-24 05:19:48,636] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-38.json
[2022-01-24 05:19:48,636] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-1.json
[2022-01-24 05:19:48,637] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-19.json
[2022-01-24 05:19:48,637] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-26.json
[2022-01-24 05:19:48,637] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-21.json
[2022-01-24 05:19:48,637] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-20.json
[2022-01-24 05:19:48,638] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-65.json
[2022-01-24 05:19:48,638] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-60.json
[2022-01-24 05:19:48,638] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-17.json
[2022-01-24 05:19:48,638] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-64.json
[2022-01-24 05:19:48,638] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-25.json
[2022-01-24 05:19:48,639] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-50.json
[2022-01-24 05:19:48,639] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-75.json
[2022-01-24 05:19:48,639] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-41.json
[2022-01-24 05:19:48,639] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-61.json
[2022-01-24 05:19:48,640] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-24.json
[2022-01-24 05:19:48,640] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-39.json
[2022-01-24 05:19:48,642] {logging_mixin.py:109} INFO - 77
[2022-01-24 05:19:48,664] {logging_mixin.py:109} INFO -      invoice_id    invoice_timestamp  customer_id  ...  qty is_discount      price
0   20220104-39  2022-01-04T00:49:41  mjbhujn4102  ...  164           0  6692.8400
1   20220104-45  2022-01-04T05:00:49  epybnes3286  ...  259           0  2478.6300
2    20220104-3  2022-01-04T16:45:42  yyymlnv2864  ...  182           1  5528.9962
3    20220104-7  2022-01-04T11:23:17  svphxxg5796  ...  124           1  6975.5952
4   20220104-35  2022-01-04T05:27:40  yadoags1019  ...  270           1  8984.3850
..          ...                  ...          ...  ...  ...         ...        ...
72   20220104-8  2022-01-04T14:53:17  lzoimgb3646  ...   55           1  1621.0810
73  20220104-46  2022-01-04T13:36:40  zeytfvk2553  ...   44           1   227.8804
74  20220104-64  2022-01-04T10:42:21  yadoags1019  ...  210           1  3861.6900
75  20220104-30  2022-01-04T07:13:05  codpbua4340  ...  268           1  9648.8040
76  20220104-44  2022-01-04T14:47:09  sexnidd1428  ...   54           0  2879.2800

[77 rows x 8 columns]
[2022-01-24 05:19:48,673] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: sales_dw, Login: awsuser, Password: ***, extra: {}
[2022-01-24 05:19:48,682] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: sales_dw, Login: awsuser, Password: ***, extra: {}
[2022-01-24 05:20:01,589] {python.py:175} INFO - Done. Returned value was: None
[2022-01-24 05:20:01,599] {taskinstance.py:1277} INFO - Marking task as SUCCESS. dag_id=datawarehouse_etl, task_id=load_invoices, execution_date=20220104T000000, start_date=20220124T051948, end_date=20220124T052001
[2022-01-24 05:20:01,641] {local_task_job.py:154} INFO - Task exited with return code 0
[2022-01-24 05:20:01,693] {local_task_job.py:264} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2022-01-24 05:22:42,449] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [queued]>
[2022-01-24 05:22:42,457] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [queued]>
[2022-01-24 05:22:42,457] {taskinstance.py:1238} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 05:22:42,458] {taskinstance.py:1239} INFO - Starting attempt 1 of 1
[2022-01-24 05:22:42,458] {taskinstance.py:1240} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 05:22:42,468] {taskinstance.py:1259} INFO - Executing <Task(PythonOperator): load_invoices> on 2022-01-04 00:00:00+00:00
[2022-01-24 05:22:42,472] {standard_task_runner.py:52} INFO - Started process 10223 to run task
[2022-01-24 05:22:42,474] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'datawarehouse_etl', 'load_invoices', 'scheduled__2022-01-04T00:00:00+00:00', '--job-id', '91', '--raw', '--subdir', 'DAGS_FOLDER/datawarehouse_***.py', '--cfg-path', '/tmp/tmpdbrksn2m', '--error-file', '/tmp/tmpzly2u5dc']
[2022-01-24 05:22:42,475] {standard_task_runner.py:77} INFO - Job 91: Subtask load_invoices
[2022-01-24 05:22:42,510] {logging_mixin.py:109} INFO - Running <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [running]> on host cd9bb47288d1
[2022-01-24 05:22:42,546] {taskinstance.py:1426} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=datawarehouse_etl
AIRFLOW_CTX_TASK_ID=load_invoices
AIRFLOW_CTX_EXECUTION_DATE=2022-01-04T00:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-01-04T00:00:00+00:00
[2022-01-24 05:22:42,547] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 05:22:42,547] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 05:22:42,547] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds_nodash' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds_nodash }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 05:22:42,547] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_end' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 05:22:42,548] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 05:22:42,548] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 05:22:42,548] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 05:22:42,548] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date_success' from the template is deprecated and will be removed in a future version. Please use 'prev_data_interval_start_success' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 05:22:42,548] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 05:22:42,548] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 05:22:42,548] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 05:22:42,548] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 05:22:42,548] {logging_mixin.py:109} INFO - {'conf': <***.configuration.AirflowConfigParser object at 0x7f1e4dfc6a10>, 'dag': <DAG: datawarehouse_etl>, 'dag_run': <DagRun datawarehouse_etl @ 2022-01-04 00:00:00+00:00: scheduled__2022-01-04T00:00:00+00:00, externally triggered: False>, 'data_interval_end': DateTime(2022, 1, 5, 0, 0, 0, tzinfo=Timezone('UTC')), 'data_interval_start': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'ds': '2022-01-04', 'ds_nodash': '20220104', 'execution_date': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'inlets': [], 'logical_date': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'macros': <module '***.macros' from '/home/***/.local/lib/python3.7/site-packages/***/macros/__init__.py'>, 'next_ds': '2022-01-05', 'next_ds_nodash': '20220105', 'next_execution_date': DateTime(2022, 1, 5, 0, 0, 0, tzinfo=Timezone('UTC')), 'outlets': [], 'params': {}, 'prev_data_interval_start_success': None, 'prev_data_interval_end_success': None, 'prev_ds': '2022-01-03', 'prev_ds_nodash': '20220103', 'prev_execution_date': datetime.datetime(2022, 1, 3, 0, 0, tzinfo=Timezone('UTC')), 'prev_execution_date_success': None, 'prev_start_date_success': None, 'run_id': 'scheduled__2022-01-04T00:00:00+00:00', 'task': <Task(PythonOperator): load_invoices>, 'task_instance': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [running]>, 'task_instance_key_str': 'datawarehouse_etl__load_invoices__20220104', 'test_mode': False, 'ti': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [running]>, 'tomorrow_ds': '2022-01-05', 'tomorrow_ds_nodash': '20220105', 'ts': '2022-01-04T00:00:00+00:00', 'ts_nodash': '20220104T000000', 'ts_nodash_with_tz': '20220104T000000+0000', 'var': {'json': None, 'value': None}, 'conn': None, 'yesterday_ds': '2022-01-03', 'yesterday_ds_nodash': '20220103', 'key': 'value', 'ts_var': '2022-01-04T00:00:00+00:00', 'tsnodash_var': '20220104T000000', 'templates_dict': None}
[2022-01-24 05:22:42,550] {logging_mixin.py:109} INFO - ts:  2022-01-04 00:00:00+00:00
[2022-01-24 05:22:42,550] {logging_mixin.py:109} INFO - <class 'pandas._libs.tslibs.timestamps.Timestamp'>
[2022-01-24 05:22:42,550] {logging_mixin.py:109} INFO - Object created.
[2022-01-24 05:22:42,550] {logging_mixin.py:109} INFO - 2022 1 4
[2022-01-24 05:22:42,550] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-33.json
[2022-01-24 05:22:42,550] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-40.json
[2022-01-24 05:22:42,551] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-23.json
[2022-01-24 05:22:42,551] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-67.json
[2022-01-24 05:22:42,551] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-29.json
[2022-01-24 05:22:42,551] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-63.json
[2022-01-24 05:22:42,551] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-37.json
[2022-01-24 05:22:42,551] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-28.json
[2022-01-24 05:22:42,551] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-45.json
[2022-01-24 05:22:42,551] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-11.json
[2022-01-24 05:22:42,551] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-51.json
[2022-01-24 05:22:42,551] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-30.json
[2022-01-24 05:22:42,551] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-71.json
[2022-01-24 05:22:42,551] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-8.json
[2022-01-24 05:22:42,552] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-32.json
[2022-01-24 05:22:42,552] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-47.json
[2022-01-24 05:22:42,552] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-5.json
[2022-01-24 05:22:42,552] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-44.json
[2022-01-24 05:22:42,552] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-55.json
[2022-01-24 05:22:42,552] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-4.json
[2022-01-24 05:22:42,552] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-57.json
[2022-01-24 05:22:42,552] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-72.json
[2022-01-24 05:22:42,552] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-9.json
[2022-01-24 05:22:42,552] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-3.json
[2022-01-24 05:22:42,553] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-16.json
[2022-01-24 05:22:42,553] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-66.json
[2022-01-24 05:22:42,553] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-14.json
[2022-01-24 05:22:42,553] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-35.json
[2022-01-24 05:22:42,553] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-13.json
[2022-01-24 05:22:42,553] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-58.json
[2022-01-24 05:22:42,553] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-31.json
[2022-01-24 05:22:42,553] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-12.json
[2022-01-24 05:22:42,553] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-68.json
[2022-01-24 05:22:42,553] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-10.json
[2022-01-24 05:22:42,554] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-34.json
[2022-01-24 05:22:42,554] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-2.json
[2022-01-24 05:22:42,554] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-36.json
[2022-01-24 05:22:42,554] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-56.json
[2022-01-24 05:22:42,554] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-76.json
[2022-01-24 05:22:42,554] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-6.json
[2022-01-24 05:22:42,554] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-7.json
[2022-01-24 05:22:42,554] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-54.json
[2022-01-24 05:22:42,554] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-48.json
[2022-01-24 05:22:42,554] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-59.json
[2022-01-24 05:22:42,554] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-53.json
[2022-01-24 05:22:42,554] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-70.json
[2022-01-24 05:22:42,555] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-22.json
[2022-01-24 05:22:42,555] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-42.json
[2022-01-24 05:22:42,555] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-43.json
[2022-01-24 05:22:42,555] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-18.json
[2022-01-24 05:22:42,555] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-62.json
[2022-01-24 05:22:42,555] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-52.json
[2022-01-24 05:22:42,555] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-49.json
[2022-01-24 05:22:42,555] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-27.json
[2022-01-24 05:22:42,555] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-0.json
[2022-01-24 05:22:42,555] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-15.json
[2022-01-24 05:22:42,555] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-74.json
[2022-01-24 05:22:42,555] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-73.json
[2022-01-24 05:22:42,556] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-69.json
[2022-01-24 05:22:42,556] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-46.json
[2022-01-24 05:22:42,556] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-38.json
[2022-01-24 05:22:42,556] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-1.json
[2022-01-24 05:22:42,556] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-19.json
[2022-01-24 05:22:42,556] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-26.json
[2022-01-24 05:22:42,556] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-21.json
[2022-01-24 05:22:42,556] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-20.json
[2022-01-24 05:22:42,556] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-65.json
[2022-01-24 05:22:42,556] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-60.json
[2022-01-24 05:22:42,556] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-17.json
[2022-01-24 05:22:42,556] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-64.json
[2022-01-24 05:22:42,557] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-25.json
[2022-01-24 05:22:42,557] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-50.json
[2022-01-24 05:22:42,557] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-75.json
[2022-01-24 05:22:42,557] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-41.json
[2022-01-24 05:22:42,557] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-61.json
[2022-01-24 05:22:42,557] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-24.json
[2022-01-24 05:22:42,557] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-39.json
[2022-01-24 05:22:42,559] {logging_mixin.py:109} INFO - 77
[2022-01-24 05:22:42,573] {logging_mixin.py:109} INFO -      invoice_id    invoice_timestamp  customer_id  ...  qty is_discount      price
0   20220104-39  2022-01-04T00:49:41  mjbhujn4102  ...  164           0  6692.8400
1   20220104-45  2022-01-04T05:00:49  epybnes3286  ...  259           0  2478.6300
2    20220104-3  2022-01-04T16:45:42  yyymlnv2864  ...  182           1  5528.9962
3    20220104-7  2022-01-04T11:23:17  svphxxg5796  ...  124           1  6975.5952
4   20220104-35  2022-01-04T05:27:40  yadoags1019  ...  270           1  8984.3850
..          ...                  ...          ...  ...  ...         ...        ...
72   20220104-8  2022-01-04T14:53:17  lzoimgb3646  ...   55           1  1621.0810
73  20220104-46  2022-01-04T13:36:40  zeytfvk2553  ...   44           1   227.8804
74  20220104-64  2022-01-04T10:42:21  yadoags1019  ...  210           1  3861.6900
75  20220104-30  2022-01-04T07:13:05  codpbua4340  ...  268           1  9648.8040
76  20220104-44  2022-01-04T14:47:09  sexnidd1428  ...   54           0  2879.2800

[77 rows x 8 columns]
[2022-01-24 05:22:42,580] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: sales_dw, Login: awsuser, Password: ***, extra: {}
[2022-01-24 05:22:42,585] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: sales_dw, Login: awsuser, Password: ***, extra: {}
[2022-01-24 05:22:55,936] {python.py:175} INFO - Done. Returned value was: None
[2022-01-24 05:22:55,944] {taskinstance.py:1277} INFO - Marking task as SUCCESS. dag_id=datawarehouse_etl, task_id=load_invoices, execution_date=20220104T000000, start_date=20220124T052242, end_date=20220124T052255
[2022-01-24 05:22:55,970] {local_task_job.py:154} INFO - Task exited with return code 0
[2022-01-24 05:22:55,997] {local_task_job.py:264} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2022-01-24 18:00:53,280] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [queued]>
[2022-01-24 18:00:53,288] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [queued]>
[2022-01-24 18:00:53,288] {taskinstance.py:1238} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 18:00:53,288] {taskinstance.py:1239} INFO - Starting attempt 1 of 1
[2022-01-24 18:00:53,289] {taskinstance.py:1240} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 18:00:53,298] {taskinstance.py:1259} INFO - Executing <Task(PythonOperator): load_invoices> on 2022-01-04 00:00:00+00:00
[2022-01-24 18:00:53,302] {standard_task_runner.py:52} INFO - Started process 1600 to run task
[2022-01-24 18:00:53,305] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'datawarehouse_etl', 'load_invoices', 'scheduled__2022-01-04T00:00:00+00:00', '--job-id', '99', '--raw', '--subdir', 'DAGS_FOLDER/datawarehouse_***.py', '--cfg-path', '/tmp/tmphvpp3j_0', '--error-file', '/tmp/tmp3r50o088']
[2022-01-24 18:00:53,305] {standard_task_runner.py:77} INFO - Job 99: Subtask load_invoices
[2022-01-24 18:00:53,343] {logging_mixin.py:109} INFO - Running <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [running]> on host cd9bb47288d1
[2022-01-24 18:00:53,386] {taskinstance.py:1426} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=datawarehouse_etl
AIRFLOW_CTX_TASK_ID=load_invoices
AIRFLOW_CTX_EXECUTION_DATE=2022-01-04T00:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-01-04T00:00:00+00:00
[2022-01-24 18:00:53,387] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:00:53,388] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:00:53,388] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds_nodash' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds_nodash }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:00:53,388] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_end' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:00:53,388] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:00:53,388] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:00:53,388] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:00:53,388] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date_success' from the template is deprecated and will be removed in a future version. Please use 'prev_data_interval_start_success' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:00:53,388] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:00:53,388] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:00:53,388] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:00:53,388] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:00:53,389] {logging_mixin.py:109} INFO - {'conf': <***.configuration.AirflowConfigParser object at 0x7f76fb23ca90>, 'dag': <DAG: datawarehouse_etl>, 'dag_run': <DagRun datawarehouse_etl @ 2022-01-04 00:00:00+00:00: scheduled__2022-01-04T00:00:00+00:00, externally triggered: False>, 'data_interval_end': DateTime(2022, 1, 5, 0, 0, 0, tzinfo=Timezone('UTC')), 'data_interval_start': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'ds': '2022-01-04', 'ds_nodash': '20220104', 'execution_date': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'inlets': [], 'logical_date': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'macros': <module '***.macros' from '/home/***/.local/lib/python3.7/site-packages/***/macros/__init__.py'>, 'next_ds': '2022-01-05', 'next_ds_nodash': '20220105', 'next_execution_date': DateTime(2022, 1, 5, 0, 0, 0, tzinfo=Timezone('UTC')), 'outlets': [], 'params': {}, 'prev_data_interval_start_success': None, 'prev_data_interval_end_success': None, 'prev_ds': '2022-01-03', 'prev_ds_nodash': '20220103', 'prev_execution_date': datetime.datetime(2022, 1, 3, 0, 0, tzinfo=Timezone('UTC')), 'prev_execution_date_success': None, 'prev_start_date_success': None, 'run_id': 'scheduled__2022-01-04T00:00:00+00:00', 'task': <Task(PythonOperator): load_invoices>, 'task_instance': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [running]>, 'task_instance_key_str': 'datawarehouse_etl__load_invoices__20220104', 'test_mode': False, 'ti': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [running]>, 'tomorrow_ds': '2022-01-05', 'tomorrow_ds_nodash': '20220105', 'ts': '2022-01-04T00:00:00+00:00', 'ts_nodash': '20220104T000000', 'ts_nodash_with_tz': '20220104T000000+0000', 'var': {'json': None, 'value': None}, 'conn': None, 'yesterday_ds': '2022-01-03', 'yesterday_ds_nodash': '20220103', 'key': 'value', 'ts_var': '2022-01-04T00:00:00+00:00', 'tsnodash_var': '20220104T000000', 'templates_dict': None}
[2022-01-24 18:00:53,390] {logging_mixin.py:109} INFO - ts:  2022-01-04 00:00:00+00:00
[2022-01-24 18:00:53,390] {logging_mixin.py:109} INFO - <class 'pandas._libs.tslibs.timestamps.Timestamp'>
[2022-01-24 18:00:53,390] {logging_mixin.py:109} INFO - Object created.
[2022-01-24 18:00:53,390] {logging_mixin.py:109} INFO - 2022 1 4
[2022-01-24 18:00:53,391] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-33.json
[2022-01-24 18:00:53,392] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-40.json
[2022-01-24 18:00:53,392] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-23.json
[2022-01-24 18:00:53,393] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-67.json
[2022-01-24 18:00:53,393] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-29.json
[2022-01-24 18:00:53,393] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-63.json
[2022-01-24 18:00:53,394] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-81.json
[2022-01-24 18:00:53,394] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-37.json
[2022-01-24 18:00:53,394] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-28.json
[2022-01-24 18:00:53,395] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-45.json
[2022-01-24 18:00:53,395] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-86.json
[2022-01-24 18:00:53,395] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-11.json
[2022-01-24 18:00:53,395] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-51.json
[2022-01-24 18:00:53,396] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-30.json
[2022-01-24 18:00:53,396] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-78.json
[2022-01-24 18:00:53,396] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-71.json
[2022-01-24 18:00:53,396] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-90.json
[2022-01-24 18:00:53,397] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-8.json
[2022-01-24 18:00:53,397] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-32.json
[2022-01-24 18:00:53,397] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-47.json
[2022-01-24 18:00:53,397] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-89.json
[2022-01-24 18:00:53,398] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-5.json
[2022-01-24 18:00:53,398] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-44.json
[2022-01-24 18:00:53,398] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-55.json
[2022-01-24 18:00:53,398] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-4.json
[2022-01-24 18:00:53,399] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-57.json
[2022-01-24 18:00:53,399] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-72.json
[2022-01-24 18:00:53,399] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-82.json
[2022-01-24 18:00:53,399] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-9.json
[2022-01-24 18:00:53,400] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-3.json
[2022-01-24 18:00:53,400] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-16.json
[2022-01-24 18:00:53,400] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-66.json
[2022-01-24 18:00:53,400] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-14.json
[2022-01-24 18:00:53,401] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-35.json
[2022-01-24 18:00:53,401] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-13.json
[2022-01-24 18:00:53,401] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-80.json
[2022-01-24 18:00:53,401] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-77.json
[2022-01-24 18:00:53,402] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-58.json
[2022-01-24 18:00:53,402] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-31.json
[2022-01-24 18:00:53,402] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-12.json
[2022-01-24 18:00:53,402] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-68.json
[2022-01-24 18:00:53,403] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-10.json
[2022-01-24 18:00:53,403] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-34.json
[2022-01-24 18:00:53,403] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-2.json
[2022-01-24 18:00:53,403] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-36.json
[2022-01-24 18:00:53,404] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-56.json
[2022-01-24 18:00:53,404] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-76.json
[2022-01-24 18:00:53,404] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-6.json
[2022-01-24 18:00:53,404] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-84.json
[2022-01-24 18:00:53,405] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-7.json
[2022-01-24 18:00:53,405] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-54.json
[2022-01-24 18:00:53,405] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-83.json
[2022-01-24 18:00:53,405] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-48.json
[2022-01-24 18:00:53,405] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-59.json
[2022-01-24 18:00:53,406] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-53.json
[2022-01-24 18:00:53,406] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-70.json
[2022-01-24 18:00:53,406] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-22.json
[2022-01-24 18:00:53,406] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-42.json
[2022-01-24 18:00:53,406] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-43.json
[2022-01-24 18:00:53,407] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-88.json
[2022-01-24 18:00:53,407] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-18.json
[2022-01-24 18:00:53,407] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-62.json
[2022-01-24 18:00:53,407] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-52.json
[2022-01-24 18:00:53,407] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-49.json
[2022-01-24 18:00:53,407] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-27.json
[2022-01-24 18:00:53,408] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-0.json
[2022-01-24 18:00:53,408] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-15.json
[2022-01-24 18:00:53,408] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-74.json
[2022-01-24 18:00:53,408] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-73.json
[2022-01-24 18:00:53,409] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-69.json
[2022-01-24 18:00:53,409] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-46.json
[2022-01-24 18:00:53,409] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-38.json
[2022-01-24 18:00:53,409] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-1.json
[2022-01-24 18:00:53,409] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-19.json
[2022-01-24 18:00:53,409] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-26.json
[2022-01-24 18:00:53,410] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-21.json
[2022-01-24 18:00:53,410] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-20.json
[2022-01-24 18:00:53,410] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-65.json
[2022-01-24 18:00:53,410] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-60.json
[2022-01-24 18:00:53,410] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-17.json
[2022-01-24 18:00:53,410] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-64.json
[2022-01-24 18:00:53,411] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-25.json
[2022-01-24 18:00:53,411] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-50.json
[2022-01-24 18:00:53,411] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-85.json
[2022-01-24 18:00:53,411] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-79.json
[2022-01-24 18:00:53,411] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-75.json
[2022-01-24 18:00:53,412] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-41.json
[2022-01-24 18:00:53,412] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-87.json
[2022-01-24 18:00:53,412] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-61.json
[2022-01-24 18:00:53,412] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-24.json
[2022-01-24 18:00:53,412] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-39.json
[2022-01-24 18:00:53,414] {logging_mixin.py:109} INFO - 91
[2022-01-24 18:00:53,429] {logging_mixin.py:109} INFO -      invoice_id    invoice_timestamp  customer_id  ...  qty is_discount       price
0   20220104-39  2022-01-04T08:54:57  fhezien2176  ...  189           0   2398.4100
1   20220104-45  2022-01-04T07:32:24  ihqdpfs5379  ...   77           0   5610.2200
2    20220104-3  2022-01-04T06:39:29  ireyhsa2211  ...  129           0   1637.0100
3    20220104-7  2022-01-04T08:01:40  vrjdfgn4812  ...  178           0  13243.2000
4   20220104-35  2022-01-04T12:06:26  eiayzov4180  ...  250           0  15542.5000
..          ...                  ...          ...  ...  ...         ...         ...
86  20220104-46  2022-01-04T20:49:57  uhbbqdu3616  ...  295           1   3106.7925
87  20220104-88  2022-01-04T05:53:23  xucbtnx4900  ...  175           1    847.8750
88  20220104-64  2022-01-04T03:52:40  ryxuuem2023  ...   78           1   5704.3350
89  20220104-30  2022-01-04T00:21:37  okntscm4980  ...  112           1   6909.3024
90  20220104-44  2022-01-04T19:35:15  xqfhyna2212  ...  115           1   7454.8175

[91 rows x 8 columns]
[2022-01-24 18:00:53,436] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: sales_dw, Login: awsuser, Password: ***, extra: {}
[2022-01-24 18:00:53,443] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: sales_dw, Login: awsuser, Password: ***, extra: {}
[2022-01-24 18:01:08,395] {python.py:175} INFO - Done. Returned value was: None
[2022-01-24 18:01:08,412] {taskinstance.py:1277} INFO - Marking task as SUCCESS. dag_id=datawarehouse_etl, task_id=load_invoices, execution_date=20220104T000000, start_date=20220124T180053, end_date=20220124T180108
[2022-01-24 18:01:08,466] {local_task_job.py:154} INFO - Task exited with return code 0
[2022-01-24 18:01:08,517] {local_task_job.py:264} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2022-01-24 18:02:56,956] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [queued]>
[2022-01-24 18:02:56,965] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [queued]>
[2022-01-24 18:02:56,965] {taskinstance.py:1238} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 18:02:56,965] {taskinstance.py:1239} INFO - Starting attempt 1 of 1
[2022-01-24 18:02:56,965] {taskinstance.py:1240} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 18:02:56,973] {taskinstance.py:1259} INFO - Executing <Task(PythonOperator): load_invoices> on 2022-01-04 00:00:00+00:00
[2022-01-24 18:02:56,978] {standard_task_runner.py:52} INFO - Started process 1710 to run task
[2022-01-24 18:02:56,980] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'datawarehouse_etl', 'load_invoices', 'scheduled__2022-01-04T00:00:00+00:00', '--job-id', '105', '--raw', '--subdir', 'DAGS_FOLDER/datawarehouse_***.py', '--cfg-path', '/tmp/tmpp506w1jc', '--error-file', '/tmp/tmptjc_odb5']
[2022-01-24 18:02:56,981] {standard_task_runner.py:77} INFO - Job 105: Subtask load_invoices
[2022-01-24 18:02:57,015] {logging_mixin.py:109} INFO - Running <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [running]> on host cd9bb47288d1
[2022-01-24 18:02:57,050] {taskinstance.py:1426} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=datawarehouse_etl
AIRFLOW_CTX_TASK_ID=load_invoices
AIRFLOW_CTX_EXECUTION_DATE=2022-01-04T00:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-01-04T00:00:00+00:00
[2022-01-24 18:02:57,051] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:02:57,051] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:02:57,051] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds_nodash' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds_nodash }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:02:57,051] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_end' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:02:57,051] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:02:57,052] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:02:57,052] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:02:57,052] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date_success' from the template is deprecated and will be removed in a future version. Please use 'prev_data_interval_start_success' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:02:57,052] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:02:57,052] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:02:57,052] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:02:57,052] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:02:57,053] {logging_mixin.py:109} INFO - {'conf': <***.configuration.AirflowConfigParser object at 0x7f76fb23ca90>, 'dag': <DAG: datawarehouse_etl>, 'dag_run': <DagRun datawarehouse_etl @ 2022-01-04 00:00:00+00:00: scheduled__2022-01-04T00:00:00+00:00, externally triggered: False>, 'data_interval_end': DateTime(2022, 1, 5, 0, 0, 0, tzinfo=Timezone('UTC')), 'data_interval_start': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'ds': '2022-01-04', 'ds_nodash': '20220104', 'execution_date': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'inlets': [], 'logical_date': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'macros': <module '***.macros' from '/home/***/.local/lib/python3.7/site-packages/***/macros/__init__.py'>, 'next_ds': '2022-01-05', 'next_ds_nodash': '20220105', 'next_execution_date': DateTime(2022, 1, 5, 0, 0, 0, tzinfo=Timezone('UTC')), 'outlets': [], 'params': {}, 'prev_data_interval_start_success': None, 'prev_data_interval_end_success': None, 'prev_ds': '2022-01-03', 'prev_ds_nodash': '20220103', 'prev_execution_date': datetime.datetime(2022, 1, 3, 0, 0, tzinfo=Timezone('UTC')), 'prev_execution_date_success': None, 'prev_start_date_success': None, 'run_id': 'scheduled__2022-01-04T00:00:00+00:00', 'task': <Task(PythonOperator): load_invoices>, 'task_instance': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [running]>, 'task_instance_key_str': 'datawarehouse_etl__load_invoices__20220104', 'test_mode': False, 'ti': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [running]>, 'tomorrow_ds': '2022-01-05', 'tomorrow_ds_nodash': '20220105', 'ts': '2022-01-04T00:00:00+00:00', 'ts_nodash': '20220104T000000', 'ts_nodash_with_tz': '20220104T000000+0000', 'var': {'json': None, 'value': None}, 'conn': None, 'yesterday_ds': '2022-01-03', 'yesterday_ds_nodash': '20220103', 'key': 'value', 'ts_var': '2022-01-04T00:00:00+00:00', 'tsnodash_var': '20220104T000000', 'templates_dict': None}
[2022-01-24 18:02:57,054] {logging_mixin.py:109} INFO - ts:  2022-01-04 00:00:00+00:00
[2022-01-24 18:02:57,054] {logging_mixin.py:109} INFO - <class 'pandas._libs.tslibs.timestamps.Timestamp'>
[2022-01-24 18:02:57,054] {logging_mixin.py:109} INFO - Object created.
[2022-01-24 18:02:57,054] {logging_mixin.py:109} INFO - 2022 1 4
[2022-01-24 18:02:57,055] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-33.json
[2022-01-24 18:02:57,055] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-40.json
[2022-01-24 18:02:57,055] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-23.json
[2022-01-24 18:02:57,055] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-67.json
[2022-01-24 18:02:57,056] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-29.json
[2022-01-24 18:02:57,056] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-63.json
[2022-01-24 18:02:57,056] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-81.json
[2022-01-24 18:02:57,056] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-37.json
[2022-01-24 18:02:57,056] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-28.json
[2022-01-24 18:02:57,056] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-45.json
[2022-01-24 18:02:57,056] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-86.json
[2022-01-24 18:02:57,056] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-11.json
[2022-01-24 18:02:57,056] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-51.json
[2022-01-24 18:02:57,057] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-30.json
[2022-01-24 18:02:57,057] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-78.json
[2022-01-24 18:02:57,057] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-71.json
[2022-01-24 18:02:57,057] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-90.json
[2022-01-24 18:02:57,057] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-8.json
[2022-01-24 18:02:57,057] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-32.json
[2022-01-24 18:02:57,058] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-47.json
[2022-01-24 18:02:57,058] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-89.json
[2022-01-24 18:02:57,058] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-5.json
[2022-01-24 18:02:57,058] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-44.json
[2022-01-24 18:02:57,058] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-55.json
[2022-01-24 18:02:57,058] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-4.json
[2022-01-24 18:02:57,058] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-57.json
[2022-01-24 18:02:57,058] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-72.json
[2022-01-24 18:02:57,059] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-82.json
[2022-01-24 18:02:57,059] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-9.json
[2022-01-24 18:02:57,059] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-3.json
[2022-01-24 18:02:57,059] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-16.json
[2022-01-24 18:02:57,059] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-66.json
[2022-01-24 18:02:57,059] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-14.json
[2022-01-24 18:02:57,059] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-35.json
[2022-01-24 18:02:57,059] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-13.json
[2022-01-24 18:02:57,060] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-80.json
[2022-01-24 18:02:57,060] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-77.json
[2022-01-24 18:02:57,060] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-58.json
[2022-01-24 18:02:57,060] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-31.json
[2022-01-24 18:02:57,060] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-12.json
[2022-01-24 18:02:57,060] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-68.json
[2022-01-24 18:02:57,060] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-10.json
[2022-01-24 18:02:57,060] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-34.json
[2022-01-24 18:02:57,061] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-2.json
[2022-01-24 18:02:57,061] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-36.json
[2022-01-24 18:02:57,061] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-56.json
[2022-01-24 18:02:57,061] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-76.json
[2022-01-24 18:02:57,061] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-6.json
[2022-01-24 18:02:57,061] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-84.json
[2022-01-24 18:02:57,061] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-7.json
[2022-01-24 18:02:57,061] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-54.json
[2022-01-24 18:02:57,062] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-83.json
[2022-01-24 18:02:57,062] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-48.json
[2022-01-24 18:02:57,062] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-59.json
[2022-01-24 18:02:57,062] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-53.json
[2022-01-24 18:02:57,062] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-70.json
[2022-01-24 18:02:57,062] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-22.json
[2022-01-24 18:02:57,062] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-42.json
[2022-01-24 18:02:57,062] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-43.json
[2022-01-24 18:02:57,063] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-88.json
[2022-01-24 18:02:57,063] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-18.json
[2022-01-24 18:02:57,063] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-62.json
[2022-01-24 18:02:57,063] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-52.json
[2022-01-24 18:02:57,063] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-49.json
[2022-01-24 18:02:57,063] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-27.json
[2022-01-24 18:02:57,063] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-0.json
[2022-01-24 18:02:57,063] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-15.json
[2022-01-24 18:02:57,064] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-74.json
[2022-01-24 18:02:57,064] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-73.json
[2022-01-24 18:02:57,064] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-69.json
[2022-01-24 18:02:57,064] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-46.json
[2022-01-24 18:02:57,064] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-38.json
[2022-01-24 18:02:57,064] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-1.json
[2022-01-24 18:02:57,064] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-19.json
[2022-01-24 18:02:57,064] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-26.json
[2022-01-24 18:02:57,065] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-21.json
[2022-01-24 18:02:57,065] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-20.json
[2022-01-24 18:02:57,065] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-65.json
[2022-01-24 18:02:57,065] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-60.json
[2022-01-24 18:02:57,065] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-17.json
[2022-01-24 18:02:57,065] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-64.json
[2022-01-24 18:02:57,065] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-25.json
[2022-01-24 18:02:57,066] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-50.json
[2022-01-24 18:02:57,066] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-85.json
[2022-01-24 18:02:57,066] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-79.json
[2022-01-24 18:02:57,066] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-75.json
[2022-01-24 18:02:57,066] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-41.json
[2022-01-24 18:02:57,066] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-87.json
[2022-01-24 18:02:57,066] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-61.json
[2022-01-24 18:02:57,066] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-24.json
[2022-01-24 18:02:57,067] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-39.json
[2022-01-24 18:02:57,068] {logging_mixin.py:109} INFO - 91
[2022-01-24 18:02:57,081] {logging_mixin.py:109} INFO -      invoice_id    invoice_timestamp  customer_id  ...  qty is_discount       price
0   20220104-39  2022-01-04T08:54:57  fhezien2176  ...  189           0   2398.4100
1   20220104-45  2022-01-04T07:32:24  ihqdpfs5379  ...   77           0   5610.2200
2    20220104-3  2022-01-04T06:39:29  ireyhsa2211  ...  129           0   1637.0100
3    20220104-7  2022-01-04T08:01:40  vrjdfgn4812  ...  178           0  13243.2000
4   20220104-35  2022-01-04T12:06:26  eiayzov4180  ...  250           0  15542.5000
..          ...                  ...          ...  ...  ...         ...         ...
86  20220104-46  2022-01-04T20:49:57  uhbbqdu3616  ...  295           1   3106.7925
87  20220104-88  2022-01-04T05:53:23  xucbtnx4900  ...  175           1    847.8750
88  20220104-64  2022-01-04T03:52:40  ryxuuem2023  ...   78           1   5704.3350
89  20220104-30  2022-01-04T00:21:37  okntscm4980  ...  112           1   6909.3024
90  20220104-44  2022-01-04T19:35:15  xqfhyna2212  ...  115           1   7454.8175

[91 rows x 8 columns]
[2022-01-24 18:02:57,088] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: sales_dw, Login: awsuser, Password: ***, extra: {}
[2022-01-24 18:02:57,093] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: sales_dw, Login: awsuser, Password: ***, extra: {}
[2022-01-24 18:03:11,672] {python.py:175} INFO - Done. Returned value was: None
[2022-01-24 18:03:11,689] {taskinstance.py:1277} INFO - Marking task as SUCCESS. dag_id=datawarehouse_etl, task_id=load_invoices, execution_date=20220104T000000, start_date=20220124T180256, end_date=20220124T180311
[2022-01-24 18:03:11,732] {local_task_job.py:154} INFO - Task exited with return code 0
[2022-01-24 18:03:11,762] {local_task_job.py:264} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2022-01-24 18:10:36,299] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [queued]>
[2022-01-24 18:10:36,308] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [queued]>
[2022-01-24 18:10:36,308] {taskinstance.py:1238} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 18:10:36,308] {taskinstance.py:1239} INFO - Starting attempt 1 of 1
[2022-01-24 18:10:36,308] {taskinstance.py:1240} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 18:10:36,318] {taskinstance.py:1259} INFO - Executing <Task(PythonOperator): load_invoices> on 2022-01-04 00:00:00+00:00
[2022-01-24 18:10:36,324] {standard_task_runner.py:52} INFO - Started process 2065 to run task
[2022-01-24 18:10:36,326] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'datawarehouse_etl', 'load_invoices', 'scheduled__2022-01-04T00:00:00+00:00', '--job-id', '111', '--raw', '--subdir', 'DAGS_FOLDER/datawarehouse_***.py', '--cfg-path', '/tmp/tmph9odyfxk', '--error-file', '/tmp/tmpn62_8k1i']
[2022-01-24 18:10:36,327] {standard_task_runner.py:77} INFO - Job 111: Subtask load_invoices
[2022-01-24 18:10:36,365] {logging_mixin.py:109} INFO - Running <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [running]> on host cd9bb47288d1
[2022-01-24 18:10:36,441] {taskinstance.py:1426} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=datawarehouse_etl
AIRFLOW_CTX_TASK_ID=load_invoices
AIRFLOW_CTX_EXECUTION_DATE=2022-01-04T00:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-01-04T00:00:00+00:00
[2022-01-24 18:10:36,442] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:10:36,443] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:10:36,443] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds_nodash' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds_nodash }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:10:36,443] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_end' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:10:36,443] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:10:36,443] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:10:36,443] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:10:36,443] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date_success' from the template is deprecated and will be removed in a future version. Please use 'prev_data_interval_start_success' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:10:36,443] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:10:36,443] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:10:36,443] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:10:36,443] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:10:36,444] {logging_mixin.py:109} INFO - {'conf': <***.configuration.AirflowConfigParser object at 0x7f76fb23ca90>, 'dag': <DAG: datawarehouse_etl>, 'dag_run': <DagRun datawarehouse_etl @ 2022-01-04 00:00:00+00:00: scheduled__2022-01-04T00:00:00+00:00, externally triggered: False>, 'data_interval_end': DateTime(2022, 1, 5, 0, 0, 0, tzinfo=Timezone('UTC')), 'data_interval_start': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'ds': '2022-01-04', 'ds_nodash': '20220104', 'execution_date': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'inlets': [], 'logical_date': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'macros': <module '***.macros' from '/home/***/.local/lib/python3.7/site-packages/***/macros/__init__.py'>, 'next_ds': '2022-01-05', 'next_ds_nodash': '20220105', 'next_execution_date': DateTime(2022, 1, 5, 0, 0, 0, tzinfo=Timezone('UTC')), 'outlets': [], 'params': {}, 'prev_data_interval_start_success': None, 'prev_data_interval_end_success': None, 'prev_ds': '2022-01-03', 'prev_ds_nodash': '20220103', 'prev_execution_date': datetime.datetime(2022, 1, 3, 0, 0, tzinfo=Timezone('UTC')), 'prev_execution_date_success': None, 'prev_start_date_success': None, 'run_id': 'scheduled__2022-01-04T00:00:00+00:00', 'task': <Task(PythonOperator): load_invoices>, 'task_instance': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [running]>, 'task_instance_key_str': 'datawarehouse_etl__load_invoices__20220104', 'test_mode': False, 'ti': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [running]>, 'tomorrow_ds': '2022-01-05', 'tomorrow_ds_nodash': '20220105', 'ts': '2022-01-04T00:00:00+00:00', 'ts_nodash': '20220104T000000', 'ts_nodash_with_tz': '20220104T000000+0000', 'var': {'json': None, 'value': None}, 'conn': None, 'yesterday_ds': '2022-01-03', 'yesterday_ds_nodash': '20220103', 'key': 'value', 'ts_var': '2022-01-04T00:00:00+00:00', 'tsnodash_var': '20220104T000000', 'templates_dict': None}
[2022-01-24 18:10:36,445] {logging_mixin.py:109} INFO - ts:  2022-01-04 00:00:00+00:00
[2022-01-24 18:10:36,445] {logging_mixin.py:109} INFO - <class 'pandas._libs.tslibs.timestamps.Timestamp'>
[2022-01-24 18:10:36,445] {logging_mixin.py:109} INFO - Object created.
[2022-01-24 18:10:36,445] {logging_mixin.py:109} INFO - 2022 1 4
[2022-01-24 18:10:36,446] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-33.json
[2022-01-24 18:10:36,446] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-40.json
[2022-01-24 18:10:36,446] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-23.json
[2022-01-24 18:10:36,446] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-67.json
[2022-01-24 18:10:36,447] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-29.json
[2022-01-24 18:10:36,447] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-63.json
[2022-01-24 18:10:36,447] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-81.json
[2022-01-24 18:10:36,447] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-37.json
[2022-01-24 18:10:36,447] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-28.json
[2022-01-24 18:10:36,447] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-45.json
[2022-01-24 18:10:36,448] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-86.json
[2022-01-24 18:10:36,448] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-11.json
[2022-01-24 18:10:36,448] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-51.json
[2022-01-24 18:10:36,448] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-30.json
[2022-01-24 18:10:36,448] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-78.json
[2022-01-24 18:10:36,449] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-71.json
[2022-01-24 18:10:36,449] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-90.json
[2022-01-24 18:10:36,449] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-8.json
[2022-01-24 18:10:36,449] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-32.json
[2022-01-24 18:10:36,449] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-47.json
[2022-01-24 18:10:36,450] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-89.json
[2022-01-24 18:10:36,450] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-5.json
[2022-01-24 18:10:36,450] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-44.json
[2022-01-24 18:10:36,450] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-55.json
[2022-01-24 18:10:36,450] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-4.json
[2022-01-24 18:10:36,451] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-57.json
[2022-01-24 18:10:36,451] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-72.json
[2022-01-24 18:10:36,451] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-82.json
[2022-01-24 18:10:36,451] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-9.json
[2022-01-24 18:10:36,451] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-3.json
[2022-01-24 18:10:36,452] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-16.json
[2022-01-24 18:10:36,452] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-66.json
[2022-01-24 18:10:36,452] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-14.json
[2022-01-24 18:10:36,452] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-35.json
[2022-01-24 18:10:36,452] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-13.json
[2022-01-24 18:10:36,453] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-80.json
[2022-01-24 18:10:36,453] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-77.json
[2022-01-24 18:10:36,453] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-58.json
[2022-01-24 18:10:36,453] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-31.json
[2022-01-24 18:10:36,453] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-12.json
[2022-01-24 18:10:36,454] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-68.json
[2022-01-24 18:10:36,454] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-10.json
[2022-01-24 18:10:36,454] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-34.json
[2022-01-24 18:10:36,454] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-2.json
[2022-01-24 18:10:36,454] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-36.json
[2022-01-24 18:10:36,454] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-56.json
[2022-01-24 18:10:36,455] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-76.json
[2022-01-24 18:10:36,455] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-6.json
[2022-01-24 18:10:36,455] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-84.json
[2022-01-24 18:10:36,455] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-7.json
[2022-01-24 18:10:36,455] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-54.json
[2022-01-24 18:10:36,455] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-83.json
[2022-01-24 18:10:36,456] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-48.json
[2022-01-24 18:10:36,456] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-59.json
[2022-01-24 18:10:36,456] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-53.json
[2022-01-24 18:10:36,456] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-70.json
[2022-01-24 18:10:36,456] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-22.json
[2022-01-24 18:10:36,456] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-42.json
[2022-01-24 18:10:36,457] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-43.json
[2022-01-24 18:10:36,457] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-88.json
[2022-01-24 18:10:36,457] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-18.json
[2022-01-24 18:10:36,457] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-62.json
[2022-01-24 18:10:36,457] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-52.json
[2022-01-24 18:10:36,458] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-49.json
[2022-01-24 18:10:36,458] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-27.json
[2022-01-24 18:10:36,458] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-0.json
[2022-01-24 18:10:36,458] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-15.json
[2022-01-24 18:10:36,458] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-74.json
[2022-01-24 18:10:36,458] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-73.json
[2022-01-24 18:10:36,459] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-69.json
[2022-01-24 18:10:36,459] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-46.json
[2022-01-24 18:10:36,459] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-38.json
[2022-01-24 18:10:36,459] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-1.json
[2022-01-24 18:10:36,459] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-19.json
[2022-01-24 18:10:36,460] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-26.json
[2022-01-24 18:10:36,460] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-21.json
[2022-01-24 18:10:36,460] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-20.json
[2022-01-24 18:10:36,460] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-65.json
[2022-01-24 18:10:36,460] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-60.json
[2022-01-24 18:10:36,460] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-17.json
[2022-01-24 18:10:36,461] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-64.json
[2022-01-24 18:10:36,461] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-25.json
[2022-01-24 18:10:36,461] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-50.json
[2022-01-24 18:10:36,461] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-85.json
[2022-01-24 18:10:36,461] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-79.json
[2022-01-24 18:10:36,461] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-75.json
[2022-01-24 18:10:36,462] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-41.json
[2022-01-24 18:10:36,462] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-87.json
[2022-01-24 18:10:36,462] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-61.json
[2022-01-24 18:10:36,462] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-24.json
[2022-01-24 18:10:36,462] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-39.json
[2022-01-24 18:10:36,464] {logging_mixin.py:109} INFO - 91
[2022-01-24 18:10:36,479] {logging_mixin.py:109} INFO -      invoice_id    invoice_timestamp  customer_id  ...  qty is_discount       price
0   20220104-39  2022-01-04T08:54:57  fhezien2176  ...  189           0   2398.4100
1   20220104-45  2022-01-04T07:32:24  ihqdpfs5379  ...   77           0   5610.2200
2    20220104-3  2022-01-04T06:39:29  ireyhsa2211  ...  129           0   1637.0100
3    20220104-7  2022-01-04T08:01:40  vrjdfgn4812  ...  178           0  13243.2000
4   20220104-35  2022-01-04T12:06:26  eiayzov4180  ...  250           0  15542.5000
..          ...                  ...          ...  ...  ...         ...         ...
86  20220104-46  2022-01-04T20:49:57  uhbbqdu3616  ...  295           1   3106.7925
87  20220104-88  2022-01-04T05:53:23  xucbtnx4900  ...  175           1    847.8750
88  20220104-64  2022-01-04T03:52:40  ryxuuem2023  ...   78           1   5704.3350
89  20220104-30  2022-01-04T00:21:37  okntscm4980  ...  112           1   6909.3024
90  20220104-44  2022-01-04T19:35:15  xqfhyna2212  ...  115           1   7454.8175

[91 rows x 8 columns]
[2022-01-24 18:10:36,487] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: sales_dw, Login: awsuser, Password: ***, extra: {}
[2022-01-24 18:10:36,493] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: sales_dw, Login: awsuser, Password: ***, extra: {}
[2022-01-24 18:10:51,351] {python.py:175} INFO - Done. Returned value was: None
[2022-01-24 18:10:51,365] {taskinstance.py:1277} INFO - Marking task as SUCCESS. dag_id=datawarehouse_etl, task_id=load_invoices, execution_date=20220104T000000, start_date=20220124T181036, end_date=20220124T181051
[2022-01-24 18:10:51,414] {local_task_job.py:154} INFO - Task exited with return code 0
[2022-01-24 18:10:51,459] {local_task_job.py:264} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2022-01-24 18:11:06,318] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [queued]>
[2022-01-24 18:11:06,328] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [queued]>
[2022-01-24 18:11:06,328] {taskinstance.py:1238} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 18:11:06,328] {taskinstance.py:1239} INFO - Starting attempt 1 of 1
[2022-01-24 18:11:06,328] {taskinstance.py:1240} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 18:11:06,337] {taskinstance.py:1259} INFO - Executing <Task(PythonOperator): load_invoices> on 2022-01-04 00:00:00+00:00
[2022-01-24 18:11:06,352] {standard_task_runner.py:52} INFO - Started process 2102 to run task
[2022-01-24 18:11:06,355] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'datawarehouse_etl', 'load_invoices', 'scheduled__2022-01-04T00:00:00+00:00', '--job-id', '117', '--raw', '--subdir', 'DAGS_FOLDER/datawarehouse_***.py', '--cfg-path', '/tmp/tmpfr4pt8je', '--error-file', '/tmp/tmpppm_jlnn']
[2022-01-24 18:11:06,356] {standard_task_runner.py:77} INFO - Job 117: Subtask load_invoices
[2022-01-24 18:11:06,401] {logging_mixin.py:109} INFO - Running <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [running]> on host cd9bb47288d1
[2022-01-24 18:11:06,448] {taskinstance.py:1426} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=datawarehouse_etl
AIRFLOW_CTX_TASK_ID=load_invoices
AIRFLOW_CTX_EXECUTION_DATE=2022-01-04T00:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-01-04T00:00:00+00:00
[2022-01-24 18:11:06,449] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:11:06,450] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:11:06,450] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds_nodash' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds_nodash }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:11:06,450] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_end' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:11:06,450] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:11:06,450] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:11:06,450] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:11:06,450] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date_success' from the template is deprecated and will be removed in a future version. Please use 'prev_data_interval_start_success' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:11:06,450] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:11:06,450] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:11:06,450] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:11:06,450] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:11:06,451] {logging_mixin.py:109} INFO - {'conf': <***.configuration.AirflowConfigParser object at 0x7f76fb23ca90>, 'dag': <DAG: datawarehouse_etl>, 'dag_run': <DagRun datawarehouse_etl @ 2022-01-04 00:00:00+00:00: scheduled__2022-01-04T00:00:00+00:00, externally triggered: False>, 'data_interval_end': DateTime(2022, 1, 5, 0, 0, 0, tzinfo=Timezone('UTC')), 'data_interval_start': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'ds': '2022-01-04', 'ds_nodash': '20220104', 'execution_date': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'inlets': [], 'logical_date': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'macros': <module '***.macros' from '/home/***/.local/lib/python3.7/site-packages/***/macros/__init__.py'>, 'next_ds': '2022-01-05', 'next_ds_nodash': '20220105', 'next_execution_date': DateTime(2022, 1, 5, 0, 0, 0, tzinfo=Timezone('UTC')), 'outlets': [], 'params': {}, 'prev_data_interval_start_success': None, 'prev_data_interval_end_success': None, 'prev_ds': '2022-01-03', 'prev_ds_nodash': '20220103', 'prev_execution_date': datetime.datetime(2022, 1, 3, 0, 0, tzinfo=Timezone('UTC')), 'prev_execution_date_success': None, 'prev_start_date_success': None, 'run_id': 'scheduled__2022-01-04T00:00:00+00:00', 'task': <Task(PythonOperator): load_invoices>, 'task_instance': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [running]>, 'task_instance_key_str': 'datawarehouse_etl__load_invoices__20220104', 'test_mode': False, 'ti': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [running]>, 'tomorrow_ds': '2022-01-05', 'tomorrow_ds_nodash': '20220105', 'ts': '2022-01-04T00:00:00+00:00', 'ts_nodash': '20220104T000000', 'ts_nodash_with_tz': '20220104T000000+0000', 'var': {'json': None, 'value': None}, 'conn': None, 'yesterday_ds': '2022-01-03', 'yesterday_ds_nodash': '20220103', 'key': 'value', 'ts_var': '2022-01-04T00:00:00+00:00', 'tsnodash_var': '20220104T000000', 'templates_dict': None}
[2022-01-24 18:11:06,452] {logging_mixin.py:109} INFO - ts:  2022-01-04 00:00:00+00:00
[2022-01-24 18:11:06,452] {logging_mixin.py:109} INFO - <class 'pandas._libs.tslibs.timestamps.Timestamp'>
[2022-01-24 18:11:06,452] {logging_mixin.py:109} INFO - Object created.
[2022-01-24 18:11:06,452] {logging_mixin.py:109} INFO - 2022 1 4
[2022-01-24 18:11:06,453] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-33.json
[2022-01-24 18:11:06,453] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-40.json
[2022-01-24 18:11:06,453] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-23.json
[2022-01-24 18:11:06,453] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-67.json
[2022-01-24 18:11:06,453] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-29.json
[2022-01-24 18:11:06,453] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-63.json
[2022-01-24 18:11:06,453] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-81.json
[2022-01-24 18:11:06,453] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-37.json
[2022-01-24 18:11:06,453] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-28.json
[2022-01-24 18:11:06,453] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-45.json
[2022-01-24 18:11:06,454] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-86.json
[2022-01-24 18:11:06,454] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-11.json
[2022-01-24 18:11:06,454] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-51.json
[2022-01-24 18:11:06,454] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-30.json
[2022-01-24 18:11:06,454] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-78.json
[2022-01-24 18:11:06,454] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-71.json
[2022-01-24 18:11:06,454] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-90.json
[2022-01-24 18:11:06,454] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-8.json
[2022-01-24 18:11:06,454] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-32.json
[2022-01-24 18:11:06,454] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-47.json
[2022-01-24 18:11:06,454] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-89.json
[2022-01-24 18:11:06,455] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-5.json
[2022-01-24 18:11:06,455] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-44.json
[2022-01-24 18:11:06,455] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-55.json
[2022-01-24 18:11:06,455] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-4.json
[2022-01-24 18:11:06,455] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-57.json
[2022-01-24 18:11:06,455] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-72.json
[2022-01-24 18:11:06,455] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-82.json
[2022-01-24 18:11:06,455] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-9.json
[2022-01-24 18:11:06,455] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-3.json
[2022-01-24 18:11:06,455] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-16.json
[2022-01-24 18:11:06,455] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-66.json
[2022-01-24 18:11:06,456] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-14.json
[2022-01-24 18:11:06,456] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-35.json
[2022-01-24 18:11:06,456] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-13.json
[2022-01-24 18:11:06,456] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-80.json
[2022-01-24 18:11:06,456] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-77.json
[2022-01-24 18:11:06,456] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-58.json
[2022-01-24 18:11:06,456] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-31.json
[2022-01-24 18:11:06,456] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-12.json
[2022-01-24 18:11:06,456] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-68.json
[2022-01-24 18:11:06,457] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-10.json
[2022-01-24 18:11:06,457] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-34.json
[2022-01-24 18:11:06,457] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-2.json
[2022-01-24 18:11:06,457] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-36.json
[2022-01-24 18:11:06,457] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-56.json
[2022-01-24 18:11:06,457] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-76.json
[2022-01-24 18:11:06,457] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-6.json
[2022-01-24 18:11:06,457] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-84.json
[2022-01-24 18:11:06,458] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-7.json
[2022-01-24 18:11:06,458] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-54.json
[2022-01-24 18:11:06,458] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-83.json
[2022-01-24 18:11:06,458] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-48.json
[2022-01-24 18:11:06,458] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-59.json
[2022-01-24 18:11:06,458] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-53.json
[2022-01-24 18:11:06,458] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-70.json
[2022-01-24 18:11:06,458] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-22.json
[2022-01-24 18:11:06,459] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-42.json
[2022-01-24 18:11:06,459] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-43.json
[2022-01-24 18:11:06,459] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-88.json
[2022-01-24 18:11:06,459] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-18.json
[2022-01-24 18:11:06,459] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-62.json
[2022-01-24 18:11:06,459] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-52.json
[2022-01-24 18:11:06,459] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-49.json
[2022-01-24 18:11:06,459] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-27.json
[2022-01-24 18:11:06,459] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-0.json
[2022-01-24 18:11:06,459] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-15.json
[2022-01-24 18:11:06,459] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-74.json
[2022-01-24 18:11:06,460] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-73.json
[2022-01-24 18:11:06,460] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-69.json
[2022-01-24 18:11:06,460] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-46.json
[2022-01-24 18:11:06,460] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-38.json
[2022-01-24 18:11:06,460] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-1.json
[2022-01-24 18:11:06,460] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-19.json
[2022-01-24 18:11:06,460] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-26.json
[2022-01-24 18:11:06,460] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-21.json
[2022-01-24 18:11:06,460] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-20.json
[2022-01-24 18:11:06,460] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-65.json
[2022-01-24 18:11:06,461] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-60.json
[2022-01-24 18:11:06,461] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-17.json
[2022-01-24 18:11:06,461] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-64.json
[2022-01-24 18:11:06,461] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-25.json
[2022-01-24 18:11:06,461] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-50.json
[2022-01-24 18:11:06,461] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-85.json
[2022-01-24 18:11:06,461] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-79.json
[2022-01-24 18:11:06,461] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-75.json
[2022-01-24 18:11:06,461] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-41.json
[2022-01-24 18:11:06,461] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-87.json
[2022-01-24 18:11:06,461] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-61.json
[2022-01-24 18:11:06,461] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-24.json
[2022-01-24 18:11:06,462] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-39.json
[2022-01-24 18:11:06,464] {logging_mixin.py:109} INFO - 91
[2022-01-24 18:11:06,481] {logging_mixin.py:109} INFO -      invoice_id    invoice_timestamp  customer_id  ...  qty is_discount       price
0   20220104-39  2022-01-04T08:54:57  fhezien2176  ...  189           0   2398.4100
1   20220104-45  2022-01-04T07:32:24  ihqdpfs5379  ...   77           0   5610.2200
2    20220104-3  2022-01-04T06:39:29  ireyhsa2211  ...  129           0   1637.0100
3    20220104-7  2022-01-04T08:01:40  vrjdfgn4812  ...  178           0  13243.2000
4   20220104-35  2022-01-04T12:06:26  eiayzov4180  ...  250           0  15542.5000
..          ...                  ...          ...  ...  ...         ...         ...
86  20220104-46  2022-01-04T20:49:57  uhbbqdu3616  ...  295           1   3106.7925
87  20220104-88  2022-01-04T05:53:23  xucbtnx4900  ...  175           1    847.8750
88  20220104-64  2022-01-04T03:52:40  ryxuuem2023  ...   78           1   5704.3350
89  20220104-30  2022-01-04T00:21:37  okntscm4980  ...  112           1   6909.3024
90  20220104-44  2022-01-04T19:35:15  xqfhyna2212  ...  115           1   7454.8175

[91 rows x 8 columns]
[2022-01-24 18:11:06,488] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: sales_dw, Login: awsuser, Password: ***, extra: {}
[2022-01-24 18:11:06,496] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: sales_dw, Login: awsuser, Password: ***, extra: {}
[2022-01-24 18:11:21,763] {python.py:175} INFO - Done. Returned value was: None
[2022-01-24 18:11:21,797] {taskinstance.py:1277} INFO - Marking task as SUCCESS. dag_id=datawarehouse_etl, task_id=load_invoices, execution_date=20220104T000000, start_date=20220124T181106, end_date=20220124T181121
[2022-01-24 18:11:21,847] {local_task_job.py:154} INFO - Task exited with return code 0
[2022-01-24 18:11:21,874] {local_task_job.py:264} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2022-01-24 18:16:58,155] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [queued]>
[2022-01-24 18:16:58,162] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [queued]>
[2022-01-24 18:16:58,162] {taskinstance.py:1238} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 18:16:58,163] {taskinstance.py:1239} INFO - Starting attempt 1 of 1
[2022-01-24 18:16:58,163] {taskinstance.py:1240} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 18:16:58,171] {taskinstance.py:1259} INFO - Executing <Task(PythonOperator): load_invoices> on 2022-01-04 00:00:00+00:00
[2022-01-24 18:16:58,175] {standard_task_runner.py:52} INFO - Started process 2394 to run task
[2022-01-24 18:16:58,177] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'datawarehouse_etl', 'load_invoices', 'scheduled__2022-01-04T00:00:00+00:00', '--job-id', '124', '--raw', '--subdir', 'DAGS_FOLDER/datawarehouse_***.py', '--cfg-path', '/tmp/tmpi1ndksff', '--error-file', '/tmp/tmp_zvh1kn8']
[2022-01-24 18:16:58,178] {standard_task_runner.py:77} INFO - Job 124: Subtask load_invoices
[2022-01-24 18:16:58,212] {logging_mixin.py:109} INFO - Running <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [running]> on host cd9bb47288d1
[2022-01-24 18:16:58,254] {taskinstance.py:1426} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=datawarehouse_etl
AIRFLOW_CTX_TASK_ID=load_invoices
AIRFLOW_CTX_EXECUTION_DATE=2022-01-04T00:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-01-04T00:00:00+00:00
[2022-01-24 18:16:58,255] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:16:58,256] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:16:58,256] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds_nodash' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds_nodash }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:16:58,256] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_end' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:16:58,256] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:16:58,256] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:16:58,257] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:16:58,257] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date_success' from the template is deprecated and will be removed in a future version. Please use 'prev_data_interval_start_success' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:16:58,257] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:16:58,258] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:16:58,258] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:16:58,258] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:16:58,258] {logging_mixin.py:109} INFO - {'conf': <***.configuration.AirflowConfigParser object at 0x7f76fb23ca90>, 'dag': <DAG: datawarehouse_etl>, 'dag_run': <DagRun datawarehouse_etl @ 2022-01-04 00:00:00+00:00: scheduled__2022-01-04T00:00:00+00:00, externally triggered: False>, 'data_interval_end': DateTime(2022, 1, 5, 0, 0, 0, tzinfo=Timezone('UTC')), 'data_interval_start': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'ds': '2022-01-04', 'ds_nodash': '20220104', 'execution_date': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'inlets': [], 'logical_date': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'macros': <module '***.macros' from '/home/***/.local/lib/python3.7/site-packages/***/macros/__init__.py'>, 'next_ds': '2022-01-05', 'next_ds_nodash': '20220105', 'next_execution_date': DateTime(2022, 1, 5, 0, 0, 0, tzinfo=Timezone('UTC')), 'outlets': [], 'params': {}, 'prev_data_interval_start_success': None, 'prev_data_interval_end_success': None, 'prev_ds': '2022-01-03', 'prev_ds_nodash': '20220103', 'prev_execution_date': datetime.datetime(2022, 1, 3, 0, 0, tzinfo=Timezone('UTC')), 'prev_execution_date_success': None, 'prev_start_date_success': None, 'run_id': 'scheduled__2022-01-04T00:00:00+00:00', 'task': <Task(PythonOperator): load_invoices>, 'task_instance': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [running]>, 'task_instance_key_str': 'datawarehouse_etl__load_invoices__20220104', 'test_mode': False, 'ti': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [running]>, 'tomorrow_ds': '2022-01-05', 'tomorrow_ds_nodash': '20220105', 'ts': '2022-01-04T00:00:00+00:00', 'ts_nodash': '20220104T000000', 'ts_nodash_with_tz': '20220104T000000+0000', 'var': {'json': None, 'value': None}, 'conn': None, 'yesterday_ds': '2022-01-03', 'yesterday_ds_nodash': '20220103', 'key': 'value', 'ts_var': '2022-01-04T00:00:00+00:00', 'tsnodash_var': '20220104T000000', 'templates_dict': None}
[2022-01-24 18:16:58,259] {logging_mixin.py:109} INFO - ts:  2022-01-04 00:00:00+00:00
[2022-01-24 18:16:58,259] {logging_mixin.py:109} INFO - <class 'pandas._libs.tslibs.timestamps.Timestamp'>
[2022-01-24 18:16:58,260] {logging_mixin.py:109} INFO - Object created.
[2022-01-24 18:16:58,260] {logging_mixin.py:109} INFO - 2022 1 4
[2022-01-24 18:16:58,261] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-33.json
[2022-01-24 18:16:58,261] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-40.json
[2022-01-24 18:16:58,261] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-23.json
[2022-01-24 18:16:58,261] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-67.json
[2022-01-24 18:16:58,261] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-29.json
[2022-01-24 18:16:58,261] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-63.json
[2022-01-24 18:16:58,261] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-81.json
[2022-01-24 18:16:58,262] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-37.json
[2022-01-24 18:16:58,262] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-28.json
[2022-01-24 18:16:58,262] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-45.json
[2022-01-24 18:16:58,262] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-86.json
[2022-01-24 18:16:58,262] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-11.json
[2022-01-24 18:16:58,262] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-51.json
[2022-01-24 18:16:58,262] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-30.json
[2022-01-24 18:16:58,262] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-78.json
[2022-01-24 18:16:58,262] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-71.json
[2022-01-24 18:16:58,262] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-90.json
[2022-01-24 18:16:58,262] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-8.json
[2022-01-24 18:16:58,263] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-32.json
[2022-01-24 18:16:58,263] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-47.json
[2022-01-24 18:16:58,263] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-89.json
[2022-01-24 18:16:58,263] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-5.json
[2022-01-24 18:16:58,263] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-44.json
[2022-01-24 18:16:58,263] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-55.json
[2022-01-24 18:16:58,263] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-4.json
[2022-01-24 18:16:58,263] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-57.json
[2022-01-24 18:16:58,263] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-72.json
[2022-01-24 18:16:58,263] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-82.json
[2022-01-24 18:16:58,264] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-9.json
[2022-01-24 18:16:58,264] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-3.json
[2022-01-24 18:16:58,264] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-16.json
[2022-01-24 18:16:58,264] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-66.json
[2022-01-24 18:16:58,264] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-14.json
[2022-01-24 18:16:58,264] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-35.json
[2022-01-24 18:16:58,264] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-13.json
[2022-01-24 18:16:58,264] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-80.json
[2022-01-24 18:16:58,264] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-77.json
[2022-01-24 18:16:58,265] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-58.json
[2022-01-24 18:16:58,265] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-31.json
[2022-01-24 18:16:58,265] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-12.json
[2022-01-24 18:16:58,265] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-68.json
[2022-01-24 18:16:58,265] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-10.json
[2022-01-24 18:16:58,265] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-34.json
[2022-01-24 18:16:58,265] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-2.json
[2022-01-24 18:16:58,265] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-36.json
[2022-01-24 18:16:58,265] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-56.json
[2022-01-24 18:16:58,265] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-76.json
[2022-01-24 18:16:58,265] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-6.json
[2022-01-24 18:16:58,266] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-84.json
[2022-01-24 18:16:58,266] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-7.json
[2022-01-24 18:16:58,266] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-54.json
[2022-01-24 18:16:58,266] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-83.json
[2022-01-24 18:16:58,266] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-48.json
[2022-01-24 18:16:58,266] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-59.json
[2022-01-24 18:16:58,266] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-53.json
[2022-01-24 18:16:58,266] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-70.json
[2022-01-24 18:16:58,266] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-22.json
[2022-01-24 18:16:58,266] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-42.json
[2022-01-24 18:16:58,266] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-43.json
[2022-01-24 18:16:58,266] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-88.json
[2022-01-24 18:16:58,266] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-18.json
[2022-01-24 18:16:58,267] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-62.json
[2022-01-24 18:16:58,267] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-52.json
[2022-01-24 18:16:58,267] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-49.json
[2022-01-24 18:16:58,267] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-27.json
[2022-01-24 18:16:58,267] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-0.json
[2022-01-24 18:16:58,267] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-15.json
[2022-01-24 18:16:58,267] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-74.json
[2022-01-24 18:16:58,267] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-73.json
[2022-01-24 18:16:58,267] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-69.json
[2022-01-24 18:16:58,267] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-46.json
[2022-01-24 18:16:58,267] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-38.json
[2022-01-24 18:16:58,267] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-1.json
[2022-01-24 18:16:58,267] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-19.json
[2022-01-24 18:16:58,268] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-26.json
[2022-01-24 18:16:58,268] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-21.json
[2022-01-24 18:16:58,268] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-20.json
[2022-01-24 18:16:58,268] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-65.json
[2022-01-24 18:16:58,268] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-60.json
[2022-01-24 18:16:58,268] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-17.json
[2022-01-24 18:16:58,268] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-64.json
[2022-01-24 18:16:58,268] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-25.json
[2022-01-24 18:16:58,268] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-50.json
[2022-01-24 18:16:58,268] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-85.json
[2022-01-24 18:16:58,268] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-79.json
[2022-01-24 18:16:58,269] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-75.json
[2022-01-24 18:16:58,269] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-41.json
[2022-01-24 18:16:58,269] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-87.json
[2022-01-24 18:16:58,269] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-61.json
[2022-01-24 18:16:58,269] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-24.json
[2022-01-24 18:16:58,269] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-39.json
[2022-01-24 18:16:58,271] {logging_mixin.py:109} INFO - 91
[2022-01-24 18:16:58,284] {logging_mixin.py:109} INFO -      invoice_id    invoice_timestamp  customer_id  ...  qty is_discount       price
0   20220104-39  2022-01-04T08:54:57  fhezien2176  ...  189           0   2398.4100
1   20220104-45  2022-01-04T07:32:24  ihqdpfs5379  ...   77           0   5610.2200
2    20220104-3  2022-01-04T06:39:29  ireyhsa2211  ...  129           0   1637.0100
3    20220104-7  2022-01-04T08:01:40  vrjdfgn4812  ...  178           0  13243.2000
4   20220104-35  2022-01-04T12:06:26  eiayzov4180  ...  250           0  15542.5000
..          ...                  ...          ...  ...  ...         ...         ...
86  20220104-46  2022-01-04T20:49:57  uhbbqdu3616  ...  295           1   3106.7925
87  20220104-88  2022-01-04T05:53:23  xucbtnx4900  ...  175           1    847.8750
88  20220104-64  2022-01-04T03:52:40  ryxuuem2023  ...   78           1   5704.3350
89  20220104-30  2022-01-04T00:21:37  okntscm4980  ...  112           1   6909.3024
90  20220104-44  2022-01-04T19:35:15  xqfhyna2212  ...  115           1   7454.8175

[91 rows x 8 columns]
[2022-01-24 18:16:58,292] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: sales_dw, Login: awsuser, Password: ***, extra: {}
[2022-01-24 18:16:58,297] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: sales_dw, Login: awsuser, Password: ***, extra: {}
[2022-01-24 18:17:16,738] {python.py:175} INFO - Done. Returned value was: None
[2022-01-24 18:17:16,755] {taskinstance.py:1277} INFO - Marking task as SUCCESS. dag_id=datawarehouse_etl, task_id=load_invoices, execution_date=20220104T000000, start_date=20220124T181658, end_date=20220124T181716
[2022-01-24 18:17:16,790] {local_task_job.py:154} INFO - Task exited with return code 0
[2022-01-24 18:17:16,830] {local_task_job.py:264} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2022-01-24 18:40:51,619] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [queued]>
[2022-01-24 18:40:51,630] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [queued]>
[2022-01-24 18:40:51,630] {taskinstance.py:1238} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 18:40:51,630] {taskinstance.py:1239} INFO - Starting attempt 1 of 1
[2022-01-24 18:40:51,630] {taskinstance.py:1240} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 18:40:51,654] {taskinstance.py:1259} INFO - Executing <Task(PythonOperator): load_invoices> on 2022-01-04 00:00:00+00:00
[2022-01-24 18:40:51,661] {standard_task_runner.py:52} INFO - Started process 3501 to run task
[2022-01-24 18:40:51,665] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'datawarehouse_etl', 'load_invoices', 'scheduled__2022-01-04T00:00:00+00:00', '--job-id', '132', '--raw', '--subdir', 'DAGS_FOLDER/datawarehouse_***.py', '--cfg-path', '/tmp/tmpp3juu3q3', '--error-file', '/tmp/tmp0ego3j3v']
[2022-01-24 18:40:51,667] {standard_task_runner.py:77} INFO - Job 132: Subtask load_invoices
[2022-01-24 18:40:51,750] {logging_mixin.py:109} INFO - Running <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [running]> on host cd9bb47288d1
[2022-01-24 18:40:51,914] {taskinstance.py:1426} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=datawarehouse_etl
AIRFLOW_CTX_TASK_ID=load_invoices
AIRFLOW_CTX_EXECUTION_DATE=2022-01-04T00:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-01-04T00:00:00+00:00
[2022-01-24 18:40:51,921] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:40:51,922] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:40:51,923] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds_nodash' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds_nodash }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:40:51,925] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_end' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:40:51,925] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:40:51,926] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:40:51,926] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:40:51,926] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date_success' from the template is deprecated and will be removed in a future version. Please use 'prev_data_interval_start_success' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:40:51,927] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:40:51,927] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:40:51,927] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:40:51,927] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:40:51,928] {logging_mixin.py:109} INFO - {'conf': <***.configuration.AirflowConfigParser object at 0x7f76fb23ca90>, 'dag': <DAG: datawarehouse_etl>, 'dag_run': <DagRun datawarehouse_etl @ 2022-01-04 00:00:00+00:00: scheduled__2022-01-04T00:00:00+00:00, externally triggered: False>, 'data_interval_end': DateTime(2022, 1, 5, 0, 0, 0, tzinfo=Timezone('UTC')), 'data_interval_start': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'ds': '2022-01-04', 'ds_nodash': '20220104', 'execution_date': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'inlets': [], 'logical_date': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'macros': <module '***.macros' from '/home/***/.local/lib/python3.7/site-packages/***/macros/__init__.py'>, 'next_ds': '2022-01-05', 'next_ds_nodash': '20220105', 'next_execution_date': DateTime(2022, 1, 5, 0, 0, 0, tzinfo=Timezone('UTC')), 'outlets': [], 'params': {}, 'prev_data_interval_start_success': None, 'prev_data_interval_end_success': None, 'prev_ds': '2022-01-03', 'prev_ds_nodash': '20220103', 'prev_execution_date': datetime.datetime(2022, 1, 3, 0, 0, tzinfo=Timezone('UTC')), 'prev_execution_date_success': None, 'prev_start_date_success': None, 'run_id': 'scheduled__2022-01-04T00:00:00+00:00', 'task': <Task(PythonOperator): load_invoices>, 'task_instance': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [running]>, 'task_instance_key_str': 'datawarehouse_etl__load_invoices__20220104', 'test_mode': False, 'ti': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [running]>, 'tomorrow_ds': '2022-01-05', 'tomorrow_ds_nodash': '20220105', 'ts': '2022-01-04T00:00:00+00:00', 'ts_nodash': '20220104T000000', 'ts_nodash_with_tz': '20220104T000000+0000', 'var': {'json': None, 'value': None}, 'conn': None, 'yesterday_ds': '2022-01-03', 'yesterday_ds_nodash': '20220103', 'key': 'value', 'ts_var': '2022-01-04T00:00:00+00:00', 'tsnodash_var': '20220104T000000', 'templates_dict': None}
[2022-01-24 18:40:51,933] {logging_mixin.py:109} INFO - ts:  2022-01-04 00:00:00+00:00
[2022-01-24 18:40:51,933] {logging_mixin.py:109} INFO - <class 'pandas._libs.tslibs.timestamps.Timestamp'>
[2022-01-24 18:40:51,934] {logging_mixin.py:109} INFO - Object created.
[2022-01-24 18:40:51,935] {logging_mixin.py:109} INFO - 2022 1 4
[2022-01-24 18:40:51,938] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-33.json
[2022-01-24 18:40:51,939] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-40.json
[2022-01-24 18:40:51,940] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-23.json
[2022-01-24 18:40:51,941] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-67.json
[2022-01-24 18:40:51,944] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-29.json
[2022-01-24 18:40:51,945] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-63.json
[2022-01-24 18:40:51,945] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-81.json
[2022-01-24 18:40:51,948] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-37.json
[2022-01-24 18:40:51,949] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-28.json
[2022-01-24 18:40:51,950] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-45.json
[2022-01-24 18:40:51,950] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-86.json
[2022-01-24 18:40:51,951] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-11.json
[2022-01-24 18:40:51,951] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-51.json
[2022-01-24 18:40:51,952] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-30.json
[2022-01-24 18:40:51,953] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-78.json
[2022-01-24 18:40:51,956] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-71.json
[2022-01-24 18:40:51,958] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-90.json
[2022-01-24 18:40:51,959] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-8.json
[2022-01-24 18:40:51,961] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-32.json
[2022-01-24 18:40:51,962] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-47.json
[2022-01-24 18:40:51,963] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-89.json
[2022-01-24 18:40:51,963] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-5.json
[2022-01-24 18:40:51,964] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-44.json
[2022-01-24 18:40:51,964] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-55.json
[2022-01-24 18:40:51,965] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-4.json
[2022-01-24 18:40:51,966] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-57.json
[2022-01-24 18:40:51,966] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-72.json
[2022-01-24 18:40:51,966] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-82.json
[2022-01-24 18:40:51,967] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-9.json
[2022-01-24 18:40:51,967] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-3.json
[2022-01-24 18:40:51,968] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-16.json
[2022-01-24 18:40:51,969] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-66.json
[2022-01-24 18:40:51,970] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-14.json
[2022-01-24 18:40:51,971] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-35.json
[2022-01-24 18:40:51,972] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-13.json
[2022-01-24 18:40:51,974] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-80.json
[2022-01-24 18:40:51,975] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-77.json
[2022-01-24 18:40:51,977] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-58.json
[2022-01-24 18:40:51,978] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-31.json
[2022-01-24 18:40:51,979] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-12.json
[2022-01-24 18:40:51,979] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-68.json
[2022-01-24 18:40:51,980] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-10.json
[2022-01-24 18:40:51,982] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-34.json
[2022-01-24 18:40:51,982] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-2.json
[2022-01-24 18:40:51,983] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-36.json
[2022-01-24 18:40:51,983] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-56.json
[2022-01-24 18:40:51,984] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-76.json
[2022-01-24 18:40:51,985] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-6.json
[2022-01-24 18:40:51,986] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-84.json
[2022-01-24 18:40:51,987] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-7.json
[2022-01-24 18:40:51,988] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-54.json
[2022-01-24 18:40:51,988] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-83.json
[2022-01-24 18:40:51,989] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-48.json
[2022-01-24 18:40:51,989] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-59.json
[2022-01-24 18:40:51,989] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-53.json
[2022-01-24 18:40:51,989] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-70.json
[2022-01-24 18:40:51,990] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-22.json
[2022-01-24 18:40:51,991] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-42.json
[2022-01-24 18:40:51,992] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-43.json
[2022-01-24 18:40:51,994] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-88.json
[2022-01-24 18:40:51,995] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-18.json
[2022-01-24 18:40:51,995] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-62.json
[2022-01-24 18:40:51,996] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-52.json
[2022-01-24 18:40:51,996] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-49.json
[2022-01-24 18:40:51,997] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-27.json
[2022-01-24 18:40:51,997] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-0.json
[2022-01-24 18:40:51,997] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-15.json
[2022-01-24 18:40:51,998] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-74.json
[2022-01-24 18:40:51,998] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-73.json
[2022-01-24 18:40:51,998] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-69.json
[2022-01-24 18:40:51,998] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-46.json
[2022-01-24 18:40:51,999] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-38.json
[2022-01-24 18:40:52,000] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-1.json
[2022-01-24 18:40:52,000] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-19.json
[2022-01-24 18:40:52,001] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-26.json
[2022-01-24 18:40:52,002] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-21.json
[2022-01-24 18:40:52,003] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-20.json
[2022-01-24 18:40:52,004] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-65.json
[2022-01-24 18:40:52,004] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-60.json
[2022-01-24 18:40:52,005] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-17.json
[2022-01-24 18:40:52,006] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-64.json
[2022-01-24 18:40:52,006] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-25.json
[2022-01-24 18:40:52,007] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-50.json
[2022-01-24 18:40:52,008] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-85.json
[2022-01-24 18:40:52,009] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-79.json
[2022-01-24 18:40:52,010] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-75.json
[2022-01-24 18:40:52,010] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-41.json
[2022-01-24 18:40:52,011] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-87.json
[2022-01-24 18:40:52,011] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-61.json
[2022-01-24 18:40:52,011] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-24.json
[2022-01-24 18:40:52,012] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-39.json
[2022-01-24 18:40:52,015] {logging_mixin.py:109} INFO - 91
[2022-01-24 18:40:52,055] {logging_mixin.py:109} INFO -      invoice_id    invoice_timestamp  customer_id  ...  qty is_discount       price
0   20220104-39  2022-01-04T08:54:57  fhezien2176  ...  189           0   2398.4100
1   20220104-45  2022-01-04T07:32:24  ihqdpfs5379  ...   77           0   5610.2200
2    20220104-3  2022-01-04T06:39:29  ireyhsa2211  ...  129           0   1637.0100
3    20220104-7  2022-01-04T08:01:40  vrjdfgn4812  ...  178           0  13243.2000
4   20220104-35  2022-01-04T12:06:26  eiayzov4180  ...  250           0  15542.5000
..          ...                  ...          ...  ...  ...         ...         ...
86  20220104-46  2022-01-04T20:49:57  uhbbqdu3616  ...  295           1   3106.7925
87  20220104-88  2022-01-04T05:53:23  xucbtnx4900  ...  175           1    847.8750
88  20220104-64  2022-01-04T03:52:40  ryxuuem2023  ...   78           1   5704.3350
89  20220104-30  2022-01-04T00:21:37  okntscm4980  ...  112           1   6909.3024
90  20220104-44  2022-01-04T19:35:15  xqfhyna2212  ...  115           1   7454.8175

[91 rows x 8 columns]
[2022-01-24 18:40:52,068] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: sales_dw, Login: awsuser, Password: ***, extra: {}
[2022-01-24 18:40:52,079] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: sales_dw, Login: awsuser, Password: ***, extra: {}
[2022-01-24 18:41:11,904] {local_task_job.py:212} WARNING - State of this instance has been externally set to None. Terminating instance.
[2022-01-24 18:41:11,908] {process_utils.py:124} INFO - Sending Signals.SIGTERM to group 3501. PIDs of all processes in the group: [3501]
[2022-01-24 18:41:11,909] {process_utils.py:75} INFO - Sending the signal Signals.SIGTERM to group 3501
[2022-01-24 18:41:12,017] {taskinstance.py:1408} ERROR - Received SIGTERM. Terminating subprocesses.
[2022-01-24 18:41:12,098] {taskinstance.py:1700} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1329, in _run_raw_task
    self._execute_task_with_callbacks(context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1455, in _execute_task_with_callbacks
    result = self._execute_task(context, self.task)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1511, in _execute_task
    result = execute_callable(context=context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 174, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 185, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/datawarehouse_airflow.py", line 57, in load_invoice_staging
    invoice_df.to_sql('invoice_staging_{}_{}_{}'.format(ts.year, ts.month, ts.day), redshift_hook.get_sqlalchemy_engine(), if_exists='replace', index=False)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/core/generic.py", line 2882, in to_sql
    method=method,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 728, in to_sql
    **engine_kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1770, in to_sql
    **engine_kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1340, in insert_records
    table.insert(chunksize=chunksize, method=method)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 967, in insert
    exec_insert(conn, keys, chunk_iter)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 882, in _execute_insert
    conn.execute(self.table.insert(), data)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1011, in execute
    return meth(self, multiparams, params)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/sql/elements.py", line 298, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1130, in _execute_clauseelement
    distilled_params,
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1317, in _execute_context
    e, statement, parameters, cursor, context
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1514, in _handle_dbapi_exception
    util.raise_(exc_info[1], with_traceback=exc_info[2])
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 182, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1257, in _execute_context
    cursor, statement, parameters, context
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 912, in do_executemany
    cursor.executemany(statement, parameters)
  File "/usr/local/lib/python3.7/encodings/utf_8.py", line 15, in decode
    def decode(input, errors='strict'):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1410, in signal_handler
    raise AirflowException("Task received SIGTERM signal")
airflow.exceptions.AirflowException: Task received SIGTERM signal
[2022-01-24 18:41:12,119] {taskinstance.py:1277} INFO - Marking task as FAILED. dag_id=datawarehouse_etl, task_id=load_invoices, execution_date=20220104T000000, start_date=20220124T184051, end_date=20220124T184112
[2022-01-24 18:41:12,166] {standard_task_runner.py:92} ERROR - Failed to execute job 132 for task load_invoices
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/task/task_runner/standard_task_runner.py", line 85, in _start_by_fork
    args.func(args, dag=self.dag)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/cli_parser.py", line 48, in command
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/cli.py", line 92, in wrapper
    return f(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/commands/task_command.py", line 298, in task_run
    _run_task_by_selected_method(args, dag, ti)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/commands/task_command.py", line 107, in _run_task_by_selected_method
    _run_raw_task(args, ti)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/commands/task_command.py", line 184, in _run_raw_task
    error_file=args.error_file,
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/session.py", line 70, in wrapper
    return func(*args, session=session, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1329, in _run_raw_task
    self._execute_task_with_callbacks(context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1455, in _execute_task_with_callbacks
    result = self._execute_task(context, self.task)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1511, in _execute_task
    result = execute_callable(context=context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 174, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 185, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/datawarehouse_airflow.py", line 57, in load_invoice_staging
    invoice_df.to_sql('invoice_staging_{}_{}_{}'.format(ts.year, ts.month, ts.day), redshift_hook.get_sqlalchemy_engine(), if_exists='replace', index=False)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/core/generic.py", line 2882, in to_sql
    method=method,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 728, in to_sql
    **engine_kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1770, in to_sql
    **engine_kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1340, in insert_records
    table.insert(chunksize=chunksize, method=method)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 967, in insert
    exec_insert(conn, keys, chunk_iter)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 882, in _execute_insert
    conn.execute(self.table.insert(), data)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1011, in execute
    return meth(self, multiparams, params)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/sql/elements.py", line 298, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1130, in _execute_clauseelement
    distilled_params,
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1317, in _execute_context
    e, statement, parameters, cursor, context
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1514, in _handle_dbapi_exception
    util.raise_(exc_info[1], with_traceback=exc_info[2])
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 182, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1257, in _execute_context
    cursor, statement, parameters, context
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 912, in do_executemany
    cursor.executemany(statement, parameters)
  File "/usr/local/lib/python3.7/encodings/utf_8.py", line 15, in decode
    def decode(input, errors='strict'):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1410, in signal_handler
    raise AirflowException("Task received SIGTERM signal")
airflow.exceptions.AirflowException: Task received SIGTERM signal
[2022-01-24 18:41:12,207] {process_utils.py:70} INFO - Process psutil.Process(pid=3501, status='terminated', exitcode=1, started='18:40:51') (3501) terminated with exit code 1
[2022-01-24 18:41:53,161] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [queued]>
[2022-01-24 18:41:53,170] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [queued]>
[2022-01-24 18:41:53,170] {taskinstance.py:1238} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 18:41:53,170] {taskinstance.py:1239} INFO - Starting attempt 1 of 1
[2022-01-24 18:41:53,170] {taskinstance.py:1240} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 18:41:53,180] {taskinstance.py:1259} INFO - Executing <Task(PythonOperator): load_invoices> on 2022-01-04 00:00:00+00:00
[2022-01-24 18:41:53,184] {standard_task_runner.py:52} INFO - Started process 3565 to run task
[2022-01-24 18:41:53,186] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'datawarehouse_etl', 'load_invoices', 'scheduled__2022-01-04T00:00:00+00:00', '--job-id', '138', '--raw', '--subdir', 'DAGS_FOLDER/datawarehouse_***.py', '--cfg-path', '/tmp/tmpjgj2n9hy', '--error-file', '/tmp/tmprigl8r1h']
[2022-01-24 18:41:53,187] {standard_task_runner.py:77} INFO - Job 138: Subtask load_invoices
[2022-01-24 18:41:53,233] {logging_mixin.py:109} INFO - Running <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [running]> on host cd9bb47288d1
[2022-01-24 18:41:53,274] {taskinstance.py:1426} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=datawarehouse_etl
AIRFLOW_CTX_TASK_ID=load_invoices
AIRFLOW_CTX_EXECUTION_DATE=2022-01-04T00:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-01-04T00:00:00+00:00
[2022-01-24 18:41:53,276] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:41:53,276] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:41:53,276] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds_nodash' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds_nodash }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:41:53,276] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_end' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:41:53,276] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:41:53,277] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:41:53,277] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:41:53,277] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date_success' from the template is deprecated and will be removed in a future version. Please use 'prev_data_interval_start_success' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:41:53,277] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:41:53,277] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:41:53,277] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:41:53,277] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:41:53,278] {logging_mixin.py:109} INFO - {'conf': <***.configuration.AirflowConfigParser object at 0x7f76fb23ca90>, 'dag': <DAG: datawarehouse_etl>, 'dag_run': <DagRun datawarehouse_etl @ 2022-01-04 00:00:00+00:00: scheduled__2022-01-04T00:00:00+00:00, externally triggered: False>, 'data_interval_end': DateTime(2022, 1, 5, 0, 0, 0, tzinfo=Timezone('UTC')), 'data_interval_start': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'ds': '2022-01-04', 'ds_nodash': '20220104', 'execution_date': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'inlets': [], 'logical_date': DateTime(2022, 1, 4, 0, 0, 0, tzinfo=Timezone('UTC')), 'macros': <module '***.macros' from '/home/***/.local/lib/python3.7/site-packages/***/macros/__init__.py'>, 'next_ds': '2022-01-05', 'next_ds_nodash': '20220105', 'next_execution_date': DateTime(2022, 1, 5, 0, 0, 0, tzinfo=Timezone('UTC')), 'outlets': [], 'params': {}, 'prev_data_interval_start_success': None, 'prev_data_interval_end_success': None, 'prev_ds': '2022-01-03', 'prev_ds_nodash': '20220103', 'prev_execution_date': datetime.datetime(2022, 1, 3, 0, 0, tzinfo=Timezone('UTC')), 'prev_execution_date_success': None, 'prev_start_date_success': None, 'run_id': 'scheduled__2022-01-04T00:00:00+00:00', 'task': <Task(PythonOperator): load_invoices>, 'task_instance': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [running]>, 'task_instance_key_str': 'datawarehouse_etl__load_invoices__20220104', 'test_mode': False, 'ti': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-04T00:00:00+00:00 [running]>, 'tomorrow_ds': '2022-01-05', 'tomorrow_ds_nodash': '20220105', 'ts': '2022-01-04T00:00:00+00:00', 'ts_nodash': '20220104T000000', 'ts_nodash_with_tz': '20220104T000000+0000', 'var': {'json': None, 'value': None}, 'conn': None, 'yesterday_ds': '2022-01-03', 'yesterday_ds_nodash': '20220103', 'key': 'value', 'ts_var': '2022-01-04T00:00:00+00:00', 'tsnodash_var': '20220104T000000', 'templates_dict': None}
[2022-01-24 18:41:53,279] {logging_mixin.py:109} INFO - ts:  2022-01-04 00:00:00+00:00
[2022-01-24 18:41:53,279] {logging_mixin.py:109} INFO - <class 'pandas._libs.tslibs.timestamps.Timestamp'>
[2022-01-24 18:41:53,279] {logging_mixin.py:109} INFO - Object created.
[2022-01-24 18:41:53,279] {logging_mixin.py:109} INFO - 2022 1 4
[2022-01-24 18:41:53,280] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-33.json
[2022-01-24 18:41:53,281] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-40.json
[2022-01-24 18:41:53,281] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-23.json
[2022-01-24 18:41:53,281] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-67.json
[2022-01-24 18:41:53,281] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-29.json
[2022-01-24 18:41:53,282] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-63.json
[2022-01-24 18:41:53,282] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-81.json
[2022-01-24 18:41:53,282] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-37.json
[2022-01-24 18:41:53,282] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-28.json
[2022-01-24 18:41:53,282] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-45.json
[2022-01-24 18:41:53,282] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-86.json
[2022-01-24 18:41:53,282] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-11.json
[2022-01-24 18:41:53,283] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-51.json
[2022-01-24 18:41:53,283] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-30.json
[2022-01-24 18:41:53,283] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-78.json
[2022-01-24 18:41:53,283] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-71.json
[2022-01-24 18:41:53,283] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-90.json
[2022-01-24 18:41:53,284] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-8.json
[2022-01-24 18:41:53,284] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-32.json
[2022-01-24 18:41:53,284] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-47.json
[2022-01-24 18:41:53,284] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-89.json
[2022-01-24 18:41:53,284] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-5.json
[2022-01-24 18:41:53,285] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-44.json
[2022-01-24 18:41:53,285] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-55.json
[2022-01-24 18:41:53,285] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-4.json
[2022-01-24 18:41:53,285] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-57.json
[2022-01-24 18:41:53,285] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-72.json
[2022-01-24 18:41:53,285] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-82.json
[2022-01-24 18:41:53,285] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-9.json
[2022-01-24 18:41:53,285] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-3.json
[2022-01-24 18:41:53,285] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-16.json
[2022-01-24 18:41:53,286] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-66.json
[2022-01-24 18:41:53,286] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-14.json
[2022-01-24 18:41:53,286] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-35.json
[2022-01-24 18:41:53,286] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-13.json
[2022-01-24 18:41:53,286] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-80.json
[2022-01-24 18:41:53,286] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-77.json
[2022-01-24 18:41:53,286] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-58.json
[2022-01-24 18:41:53,286] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-31.json
[2022-01-24 18:41:53,287] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-12.json
[2022-01-24 18:41:53,287] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-68.json
[2022-01-24 18:41:53,287] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-10.json
[2022-01-24 18:41:53,287] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-34.json
[2022-01-24 18:41:53,287] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-2.json
[2022-01-24 18:41:53,287] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-36.json
[2022-01-24 18:41:53,287] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-56.json
[2022-01-24 18:41:53,287] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-76.json
[2022-01-24 18:41:53,288] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-6.json
[2022-01-24 18:41:53,288] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-84.json
[2022-01-24 18:41:53,288] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-7.json
[2022-01-24 18:41:53,288] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-54.json
[2022-01-24 18:41:53,288] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-83.json
[2022-01-24 18:41:53,288] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-48.json
[2022-01-24 18:41:53,288] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-59.json
[2022-01-24 18:41:53,288] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-53.json
[2022-01-24 18:41:53,288] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-70.json
[2022-01-24 18:41:53,289] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-22.json
[2022-01-24 18:41:53,289] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-42.json
[2022-01-24 18:41:53,289] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-43.json
[2022-01-24 18:41:53,289] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-88.json
[2022-01-24 18:41:53,289] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-18.json
[2022-01-24 18:41:53,289] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-62.json
[2022-01-24 18:41:53,289] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-52.json
[2022-01-24 18:41:53,289] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-49.json
[2022-01-24 18:41:53,290] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-27.json
[2022-01-24 18:41:53,290] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-0.json
[2022-01-24 18:41:53,290] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-15.json
[2022-01-24 18:41:53,290] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-74.json
[2022-01-24 18:41:53,290] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-73.json
[2022-01-24 18:41:53,290] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-69.json
[2022-01-24 18:41:53,290] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-46.json
[2022-01-24 18:41:53,290] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-38.json
[2022-01-24 18:41:53,291] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-1.json
[2022-01-24 18:41:53,291] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-19.json
[2022-01-24 18:41:53,291] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-26.json
[2022-01-24 18:41:53,291] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-21.json
[2022-01-24 18:41:53,291] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-20.json
[2022-01-24 18:41:53,291] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-65.json
[2022-01-24 18:41:53,291] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-60.json
[2022-01-24 18:41:53,291] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-17.json
[2022-01-24 18:41:53,292] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-64.json
[2022-01-24 18:41:53,292] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-25.json
[2022-01-24 18:41:53,292] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-50.json
[2022-01-24 18:41:53,292] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-85.json
[2022-01-24 18:41:53,292] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-79.json
[2022-01-24 18:41:53,292] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-75.json
[2022-01-24 18:41:53,292] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-41.json
[2022-01-24 18:41:53,293] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-87.json
[2022-01-24 18:41:53,293] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-61.json
[2022-01-24 18:41:53,293] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-24.json
[2022-01-24 18:41:53,293] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-4/invoice_2022-1-4-39.json
[2022-01-24 18:41:53,296] {logging_mixin.py:109} INFO - 91
[2022-01-24 18:41:53,319] {logging_mixin.py:109} INFO -      invoice_id    invoice_timestamp  customer_id  ...  qty is_discount       price
0   20220104-39  2022-01-04T08:54:57  fhezien2176  ...  189           0   2398.4100
1   20220104-45  2022-01-04T07:32:24  ihqdpfs5379  ...   77           0   5610.2200
2    20220104-3  2022-01-04T06:39:29  ireyhsa2211  ...  129           0   1637.0100
3    20220104-7  2022-01-04T08:01:40  vrjdfgn4812  ...  178           0  13243.2000
4   20220104-35  2022-01-04T12:06:26  eiayzov4180  ...  250           0  15542.5000
..          ...                  ...          ...  ...  ...         ...         ...
86  20220104-46  2022-01-04T20:49:57  uhbbqdu3616  ...  295           1   3106.7925
87  20220104-88  2022-01-04T05:53:23  xucbtnx4900  ...  175           1    847.8750
88  20220104-64  2022-01-04T03:52:40  ryxuuem2023  ...   78           1   5704.3350
89  20220104-30  2022-01-04T00:21:37  okntscm4980  ...  112           1   6909.3024
90  20220104-44  2022-01-04T19:35:15  xqfhyna2212  ...  115           1   7454.8175

[91 rows x 8 columns]
[2022-01-24 18:41:53,328] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: sales_dw, Login: awsuser, Password: ***, extra: {}
[2022-01-24 18:41:53,338] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: sales_dw, Login: awsuser, Password: ***, extra: {}
[2022-01-24 18:42:15,020] {python.py:175} INFO - Done. Returned value was: None
[2022-01-24 18:42:15,034] {taskinstance.py:1277} INFO - Marking task as SUCCESS. dag_id=datawarehouse_etl, task_id=load_invoices, execution_date=20220104T000000, start_date=20220124T184153, end_date=20220124T184215
[2022-01-24 18:42:15,089] {local_task_job.py:154} INFO - Task exited with return code 0
[2022-01-24 18:42:15,148] {local_task_job.py:264} INFO - 1 downstream tasks scheduled from follow-on schedule check
