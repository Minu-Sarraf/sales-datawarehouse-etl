[2022-01-24 02:21:05,769] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-01T00:00:00+00:00 [queued]>
[2022-01-24 02:21:05,789] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-01T00:00:00+00:00 [queued]>
[2022-01-24 02:21:05,790] {taskinstance.py:1238} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 02:21:05,790] {taskinstance.py:1239} INFO - Starting attempt 1 of 1
[2022-01-24 02:21:05,790] {taskinstance.py:1240} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 02:21:05,817] {taskinstance.py:1259} INFO - Executing <Task(PythonOperator): load_invoices> on 2022-01-01 00:00:00+00:00
[2022-01-24 02:21:05,826] {standard_task_runner.py:52} INFO - Started process 1826 to run task
[2022-01-24 02:21:05,846] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'datawarehouse_etl', 'load_invoices', 'scheduled__2022-01-01T00:00:00+00:00', '--job-id', '16', '--raw', '--subdir', 'DAGS_FOLDER/datawarehouse_***.py', '--cfg-path', '/tmp/tmpwlbs5uk2', '--error-file', '/tmp/tmp3diehznj']
[2022-01-24 02:21:05,848] {standard_task_runner.py:77} INFO - Job 16: Subtask load_invoices
[2022-01-24 02:21:05,953] {logging_mixin.py:109} INFO - Running <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-01T00:00:00+00:00 [running]> on host cd9bb47288d1
[2022-01-24 02:21:06,036] {taskinstance.py:1426} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=datawarehouse_etl
AIRFLOW_CTX_TASK_ID=load_invoices
AIRFLOW_CTX_EXECUTION_DATE=2022-01-01T00:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-01-01T00:00:00+00:00
[2022-01-24 02:21:06,039] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:21:06,039] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:21:06,039] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds_nodash' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds_nodash }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:21:06,039] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_end' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:21:06,040] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:21:06,040] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:21:06,040] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:21:06,040] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date_success' from the template is deprecated and will be removed in a future version. Please use 'prev_data_interval_start_success' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:21:06,040] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:21:06,040] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:21:06,040] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:21:06,040] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:21:06,041] {logging_mixin.py:109} INFO - {'conf': <***.configuration.AirflowConfigParser object at 0x7f1e4dfc6a10>, 'dag': <DAG: datawarehouse_etl>, 'dag_run': <DagRun datawarehouse_etl @ 2022-01-01 00:00:00+00:00: scheduled__2022-01-01T00:00:00+00:00, externally triggered: False>, 'data_interval_end': DateTime(2022, 1, 2, 0, 0, 0, tzinfo=Timezone('UTC')), 'data_interval_start': DateTime(2022, 1, 1, 0, 0, 0, tzinfo=Timezone('UTC')), 'ds': '2022-01-01', 'ds_nodash': '20220101', 'execution_date': DateTime(2022, 1, 1, 0, 0, 0, tzinfo=Timezone('UTC')), 'inlets': [], 'logical_date': DateTime(2022, 1, 1, 0, 0, 0, tzinfo=Timezone('UTC')), 'macros': <module '***.macros' from '/home/***/.local/lib/python3.7/site-packages/***/macros/__init__.py'>, 'next_ds': '2022-01-02', 'next_ds_nodash': '20220102', 'next_execution_date': DateTime(2022, 1, 2, 0, 0, 0, tzinfo=Timezone('UTC')), 'outlets': [], 'params': {}, 'prev_data_interval_start_success': None, 'prev_data_interval_end_success': None, 'prev_ds': '2021-12-31', 'prev_ds_nodash': '20211231', 'prev_execution_date': datetime.datetime(2021, 12, 31, 0, 0, tzinfo=Timezone('UTC')), 'prev_execution_date_success': None, 'prev_start_date_success': None, 'run_id': 'scheduled__2022-01-01T00:00:00+00:00', 'task': <Task(PythonOperator): load_invoices>, 'task_instance': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-01T00:00:00+00:00 [running]>, 'task_instance_key_str': 'datawarehouse_etl__load_invoices__20220101', 'test_mode': False, 'ti': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-01T00:00:00+00:00 [running]>, 'tomorrow_ds': '2022-01-02', 'tomorrow_ds_nodash': '20220102', 'ts': '2022-01-01T00:00:00+00:00', 'ts_nodash': '20220101T000000', 'ts_nodash_with_tz': '20220101T000000+0000', 'var': {'json': None, 'value': None}, 'conn': None, 'yesterday_ds': '2021-12-31', 'yesterday_ds_nodash': '20211231', 'key': 'value', 'ts_var': '2022-01-01T00:00:00+00:00', 'tsnodash_var': '20220101T000000', 'templates_dict': None}
[2022-01-24 02:21:06,041] {logging_mixin.py:109} INFO - 2022-01-01T00:00:00+00:00
[2022-01-24 02:21:06,041] {logging_mixin.py:109} INFO - Object created.
[2022-01-24 02:21:06,041] {python.py:175} INFO - Done. Returned value was: None
[2022-01-24 02:21:06,064] {taskinstance.py:1277} INFO - Marking task as SUCCESS. dag_id=datawarehouse_etl, task_id=load_invoices, execution_date=20220101T000000, start_date=20220124T022105, end_date=20220124T022106
[2022-01-24 02:21:06,096] {local_task_job.py:154} INFO - Task exited with return code 0
[2022-01-24 02:21:06,195] {local_task_job.py:264} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2022-01-24 02:24:53,367] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-01T00:00:00+00:00 [queued]>
[2022-01-24 02:24:53,377] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-01T00:00:00+00:00 [queued]>
[2022-01-24 02:24:53,378] {taskinstance.py:1238} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 02:24:53,378] {taskinstance.py:1239} INFO - Starting attempt 1 of 1
[2022-01-24 02:24:53,378] {taskinstance.py:1240} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 02:24:53,391] {taskinstance.py:1259} INFO - Executing <Task(PythonOperator): load_invoices> on 2022-01-01 00:00:00+00:00
[2022-01-24 02:24:53,397] {standard_task_runner.py:52} INFO - Started process 2012 to run task
[2022-01-24 02:24:53,401] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'datawarehouse_etl', 'load_invoices', 'scheduled__2022-01-01T00:00:00+00:00', '--job-id', '21', '--raw', '--subdir', 'DAGS_FOLDER/datawarehouse_***.py', '--cfg-path', '/tmp/tmp66m9z6n5', '--error-file', '/tmp/tmpgsv7pkx9']
[2022-01-24 02:24:53,402] {standard_task_runner.py:77} INFO - Job 21: Subtask load_invoices
[2022-01-24 02:24:53,470] {logging_mixin.py:109} INFO - Running <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-01T00:00:00+00:00 [running]> on host cd9bb47288d1
[2022-01-24 02:24:53,532] {taskinstance.py:1426} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=datawarehouse_etl
AIRFLOW_CTX_TASK_ID=load_invoices
AIRFLOW_CTX_EXECUTION_DATE=2022-01-01T00:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-01-01T00:00:00+00:00
[2022-01-24 02:24:53,533] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:24:53,533] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:24:53,533] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds_nodash' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds_nodash }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:24:53,534] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_end' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:24:53,534] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:24:53,534] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:24:53,534] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:24:53,534] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date_success' from the template is deprecated and will be removed in a future version. Please use 'prev_data_interval_start_success' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:24:53,534] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:24:53,534] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:24:53,535] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:24:53,535] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:24:53,535] {logging_mixin.py:109} INFO - {'conf': <***.configuration.AirflowConfigParser object at 0x7f1e4dfc6a10>, 'dag': <DAG: datawarehouse_etl>, 'dag_run': <DagRun datawarehouse_etl @ 2022-01-01 00:00:00+00:00: scheduled__2022-01-01T00:00:00+00:00, externally triggered: False>, 'data_interval_end': DateTime(2022, 1, 2, 0, 0, 0, tzinfo=Timezone('UTC')), 'data_interval_start': DateTime(2022, 1, 1, 0, 0, 0, tzinfo=Timezone('UTC')), 'ds': '2022-01-01', 'ds_nodash': '20220101', 'execution_date': DateTime(2022, 1, 1, 0, 0, 0, tzinfo=Timezone('UTC')), 'inlets': [], 'logical_date': DateTime(2022, 1, 1, 0, 0, 0, tzinfo=Timezone('UTC')), 'macros': <module '***.macros' from '/home/***/.local/lib/python3.7/site-packages/***/macros/__init__.py'>, 'next_ds': '2022-01-02', 'next_ds_nodash': '20220102', 'next_execution_date': DateTime(2022, 1, 2, 0, 0, 0, tzinfo=Timezone('UTC')), 'outlets': [], 'params': {}, 'prev_data_interval_start_success': None, 'prev_data_interval_end_success': None, 'prev_ds': '2021-12-31', 'prev_ds_nodash': '20211231', 'prev_execution_date': datetime.datetime(2021, 12, 31, 0, 0, tzinfo=Timezone('UTC')), 'prev_execution_date_success': None, 'prev_start_date_success': None, 'run_id': 'scheduled__2022-01-01T00:00:00+00:00', 'task': <Task(PythonOperator): load_invoices>, 'task_instance': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-01T00:00:00+00:00 [running]>, 'task_instance_key_str': 'datawarehouse_etl__load_invoices__20220101', 'test_mode': False, 'ti': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-01T00:00:00+00:00 [running]>, 'tomorrow_ds': '2022-01-02', 'tomorrow_ds_nodash': '20220102', 'ts': '2022-01-01T00:00:00+00:00', 'ts_nodash': '20220101T000000', 'ts_nodash_with_tz': '20220101T000000+0000', 'var': {'json': None, 'value': None}, 'conn': None, 'yesterday_ds': '2021-12-31', 'yesterday_ds_nodash': '20211231', 'key': 'value', 'ts_var': '2022-01-01T00:00:00+00:00', 'tsnodash_var': '20220101T000000', 'templates_dict': None}
[2022-01-24 02:24:53,535] {logging_mixin.py:109} INFO - 2022-01-01T00:00:00+00:00
[2022-01-24 02:24:53,536] {logging_mixin.py:109} INFO - 2022-01-01
[2022-01-24 02:24:53,537] {logging_mixin.py:109} INFO - Object created.
[2022-01-24 02:24:53,537] {python.py:175} INFO - Done. Returned value was: None
[2022-01-24 02:24:53,596] {taskinstance.py:1277} INFO - Marking task as SUCCESS. dag_id=datawarehouse_etl, task_id=load_invoices, execution_date=20220101T000000, start_date=20220124T022453, end_date=20220124T022453
[2022-01-24 02:24:53,652] {local_task_job.py:154} INFO - Task exited with return code 0
[2022-01-24 02:24:53,697] {local_task_job.py:264} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2022-01-24 02:30:02,983] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-01T00:00:00+00:00 [queued]>
[2022-01-24 02:30:02,995] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-01T00:00:00+00:00 [queued]>
[2022-01-24 02:30:02,995] {taskinstance.py:1238} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 02:30:02,995] {taskinstance.py:1239} INFO - Starting attempt 1 of 1
[2022-01-24 02:30:02,995] {taskinstance.py:1240} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 02:30:03,011] {taskinstance.py:1259} INFO - Executing <Task(PythonOperator): load_invoices> on 2022-01-01 00:00:00+00:00
[2022-01-24 02:30:03,018] {standard_task_runner.py:52} INFO - Started process 2260 to run task
[2022-01-24 02:30:03,022] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'datawarehouse_etl', 'load_invoices', 'scheduled__2022-01-01T00:00:00+00:00', '--job-id', '26', '--raw', '--subdir', 'DAGS_FOLDER/datawarehouse_***.py', '--cfg-path', '/tmp/tmpzrx2i8pm', '--error-file', '/tmp/tmpekv3s1r_']
[2022-01-24 02:30:03,023] {standard_task_runner.py:77} INFO - Job 26: Subtask load_invoices
[2022-01-24 02:30:03,075] {logging_mixin.py:109} INFO - Running <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-01T00:00:00+00:00 [running]> on host cd9bb47288d1
[2022-01-24 02:30:03,145] {taskinstance.py:1426} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=datawarehouse_etl
AIRFLOW_CTX_TASK_ID=load_invoices
AIRFLOW_CTX_EXECUTION_DATE=2022-01-01T00:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-01-01T00:00:00+00:00
[2022-01-24 02:30:03,148] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:30:03,149] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:30:03,149] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds_nodash' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds_nodash }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:30:03,149] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_end' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:30:03,149] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:30:03,150] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:30:03,150] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:30:03,150] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date_success' from the template is deprecated and will be removed in a future version. Please use 'prev_data_interval_start_success' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:30:03,150] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:30:03,150] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:30:03,150] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:30:03,150] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:30:03,151] {logging_mixin.py:109} INFO - {'conf': <***.configuration.AirflowConfigParser object at 0x7f1e4dfc6a10>, 'dag': <DAG: datawarehouse_etl>, 'dag_run': <DagRun datawarehouse_etl @ 2022-01-01 00:00:00+00:00: scheduled__2022-01-01T00:00:00+00:00, externally triggered: False>, 'data_interval_end': DateTime(2022, 1, 2, 0, 0, 0, tzinfo=Timezone('UTC')), 'data_interval_start': DateTime(2022, 1, 1, 0, 0, 0, tzinfo=Timezone('UTC')), 'ds': '2022-01-01', 'ds_nodash': '20220101', 'execution_date': DateTime(2022, 1, 1, 0, 0, 0, tzinfo=Timezone('UTC')), 'inlets': [], 'logical_date': DateTime(2022, 1, 1, 0, 0, 0, tzinfo=Timezone('UTC')), 'macros': <module '***.macros' from '/home/***/.local/lib/python3.7/site-packages/***/macros/__init__.py'>, 'next_ds': '2022-01-02', 'next_ds_nodash': '20220102', 'next_execution_date': DateTime(2022, 1, 2, 0, 0, 0, tzinfo=Timezone('UTC')), 'outlets': [], 'params': {}, 'prev_data_interval_start_success': None, 'prev_data_interval_end_success': None, 'prev_ds': '2021-12-31', 'prev_ds_nodash': '20211231', 'prev_execution_date': datetime.datetime(2021, 12, 31, 0, 0, tzinfo=Timezone('UTC')), 'prev_execution_date_success': None, 'prev_start_date_success': None, 'run_id': 'scheduled__2022-01-01T00:00:00+00:00', 'task': <Task(PythonOperator): load_invoices>, 'task_instance': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-01T00:00:00+00:00 [running]>, 'task_instance_key_str': 'datawarehouse_etl__load_invoices__20220101', 'test_mode': False, 'ti': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-01T00:00:00+00:00 [running]>, 'tomorrow_ds': '2022-01-02', 'tomorrow_ds_nodash': '20220102', 'ts': '2022-01-01T00:00:00+00:00', 'ts_nodash': '20220101T000000', 'ts_nodash_with_tz': '20220101T000000+0000', 'var': {'json': None, 'value': None}, 'conn': None, 'yesterday_ds': '2021-12-31', 'yesterday_ds_nodash': '20211231', 'key': 'value', 'ts_var': '2022-01-01T00:00:00+00:00', 'tsnodash_var': '20220101T000000', 'templates_dict': None}
[2022-01-24 02:30:03,151] {logging_mixin.py:109} INFO - 2022-01-01T00:00:00+00:00
[2022-01-24 02:30:03,153] {logging_mixin.py:109} INFO - 2022-01-01
[2022-01-24 02:30:03,153] {logging_mixin.py:109} INFO - Object created.
[2022-01-24 02:30:03,153] {python.py:175} INFO - Done. Returned value was: None
[2022-01-24 02:30:03,224] {taskinstance.py:1277} INFO - Marking task as SUCCESS. dag_id=datawarehouse_etl, task_id=load_invoices, execution_date=20220101T000000, start_date=20220124T023002, end_date=20220124T023003
[2022-01-24 02:30:03,274] {local_task_job.py:154} INFO - Task exited with return code 0
[2022-01-24 02:30:03,328] {local_task_job.py:264} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2022-01-24 02:31:43,266] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-01T00:00:00+00:00 [queued]>
[2022-01-24 02:31:43,281] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-01T00:00:00+00:00 [queued]>
[2022-01-24 02:31:43,281] {taskinstance.py:1238} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 02:31:43,281] {taskinstance.py:1239} INFO - Starting attempt 1 of 1
[2022-01-24 02:31:43,281] {taskinstance.py:1240} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 02:31:43,296] {taskinstance.py:1259} INFO - Executing <Task(PythonOperator): load_invoices> on 2022-01-01 00:00:00+00:00
[2022-01-24 02:31:43,301] {standard_task_runner.py:52} INFO - Started process 2348 to run task
[2022-01-24 02:31:43,305] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'datawarehouse_etl', 'load_invoices', 'scheduled__2022-01-01T00:00:00+00:00', '--job-id', '31', '--raw', '--subdir', 'DAGS_FOLDER/datawarehouse_***.py', '--cfg-path', '/tmp/tmpvjzrd83b', '--error-file', '/tmp/tmpcwo_q86b']
[2022-01-24 02:31:43,306] {standard_task_runner.py:77} INFO - Job 31: Subtask load_invoices
[2022-01-24 02:31:43,362] {logging_mixin.py:109} INFO - Running <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-01T00:00:00+00:00 [running]> on host cd9bb47288d1
[2022-01-24 02:31:43,483] {taskinstance.py:1426} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=datawarehouse_etl
AIRFLOW_CTX_TASK_ID=load_invoices
AIRFLOW_CTX_EXECUTION_DATE=2022-01-01T00:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-01-01T00:00:00+00:00
[2022-01-24 02:31:43,487] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:31:43,487] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:31:43,487] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds_nodash' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds_nodash }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:31:43,488] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_end' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:31:43,488] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:31:43,488] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:31:43,488] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:31:43,488] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date_success' from the template is deprecated and will be removed in a future version. Please use 'prev_data_interval_start_success' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:31:43,488] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:31:43,489] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:31:43,489] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:31:43,489] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:31:43,489] {logging_mixin.py:109} INFO - {'conf': <***.configuration.AirflowConfigParser object at 0x7f1e4dfc6a10>, 'dag': <DAG: datawarehouse_etl>, 'dag_run': <DagRun datawarehouse_etl @ 2022-01-01 00:00:00+00:00: scheduled__2022-01-01T00:00:00+00:00, externally triggered: False>, 'data_interval_end': DateTime(2022, 1, 2, 0, 0, 0, tzinfo=Timezone('UTC')), 'data_interval_start': DateTime(2022, 1, 1, 0, 0, 0, tzinfo=Timezone('UTC')), 'ds': '2022-01-01', 'ds_nodash': '20220101', 'execution_date': DateTime(2022, 1, 1, 0, 0, 0, tzinfo=Timezone('UTC')), 'inlets': [], 'logical_date': DateTime(2022, 1, 1, 0, 0, 0, tzinfo=Timezone('UTC')), 'macros': <module '***.macros' from '/home/***/.local/lib/python3.7/site-packages/***/macros/__init__.py'>, 'next_ds': '2022-01-02', 'next_ds_nodash': '20220102', 'next_execution_date': DateTime(2022, 1, 2, 0, 0, 0, tzinfo=Timezone('UTC')), 'outlets': [], 'params': {}, 'prev_data_interval_start_success': None, 'prev_data_interval_end_success': None, 'prev_ds': '2021-12-31', 'prev_ds_nodash': '20211231', 'prev_execution_date': datetime.datetime(2021, 12, 31, 0, 0, tzinfo=Timezone('UTC')), 'prev_execution_date_success': None, 'prev_start_date_success': None, 'run_id': 'scheduled__2022-01-01T00:00:00+00:00', 'task': <Task(PythonOperator): load_invoices>, 'task_instance': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-01T00:00:00+00:00 [running]>, 'task_instance_key_str': 'datawarehouse_etl__load_invoices__20220101', 'test_mode': False, 'ti': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-01T00:00:00+00:00 [running]>, 'tomorrow_ds': '2022-01-02', 'tomorrow_ds_nodash': '20220102', 'ts': '2022-01-01T00:00:00+00:00', 'ts_nodash': '20220101T000000', 'ts_nodash_with_tz': '20220101T000000+0000', 'var': {'json': None, 'value': None}, 'conn': None, 'yesterday_ds': '2021-12-31', 'yesterday_ds_nodash': '20211231', 'key': 'value', 'ts_var': '2022-01-01T00:00:00+00:00', 'tsnodash_var': '20220101T000000', 'templates_dict': None}
[2022-01-24 02:31:43,490] {logging_mixin.py:109} INFO - 2022-01-01T00:00:00+00:00
[2022-01-24 02:31:43,490] {taskinstance.py:1700} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1329, in _run_raw_task
    self._execute_task_with_callbacks(context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1455, in _execute_task_with_callbacks
    result = self._execute_task(context, self.task)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1511, in _execute_task
    result = execute_callable(context=context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 174, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 185, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/datawarehouse_airflow.py", line 45, in load_invoices
    print(ts.year())
AttributeError: 'str' object has no attribute 'year'
[2022-01-24 02:31:43,566] {taskinstance.py:1277} INFO - Marking task as FAILED. dag_id=datawarehouse_etl, task_id=load_invoices, execution_date=20220101T000000, start_date=20220124T023143, end_date=20220124T023143
[2022-01-24 02:31:43,597] {standard_task_runner.py:92} ERROR - Failed to execute job 31 for task load_invoices
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/task/task_runner/standard_task_runner.py", line 85, in _start_by_fork
    args.func(args, dag=self.dag)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/cli_parser.py", line 48, in command
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/cli.py", line 92, in wrapper
    return f(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/commands/task_command.py", line 298, in task_run
    _run_task_by_selected_method(args, dag, ti)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/commands/task_command.py", line 107, in _run_task_by_selected_method
    _run_raw_task(args, ti)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/commands/task_command.py", line 184, in _run_raw_task
    error_file=args.error_file,
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/session.py", line 70, in wrapper
    return func(*args, session=session, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1329, in _run_raw_task
    self._execute_task_with_callbacks(context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1455, in _execute_task_with_callbacks
    result = self._execute_task(context, self.task)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1511, in _execute_task
    result = execute_callable(context=context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 174, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 185, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/datawarehouse_airflow.py", line 45, in load_invoices
    print(ts.year())
AttributeError: 'str' object has no attribute 'year'
[2022-01-24 02:31:43,646] {local_task_job.py:154} INFO - Task exited with return code 1
[2022-01-24 02:31:43,727] {local_task_job.py:264} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-01-24 02:33:04,697] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-01T00:00:00+00:00 [queued]>
[2022-01-24 02:33:04,712] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-01T00:00:00+00:00 [queued]>
[2022-01-24 02:33:04,712] {taskinstance.py:1238} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 02:33:04,712] {taskinstance.py:1239} INFO - Starting attempt 1 of 1
[2022-01-24 02:33:04,712] {taskinstance.py:1240} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 02:33:04,732] {taskinstance.py:1259} INFO - Executing <Task(PythonOperator): load_invoices> on 2022-01-01 00:00:00+00:00
[2022-01-24 02:33:04,737] {standard_task_runner.py:52} INFO - Started process 2417 to run task
[2022-01-24 02:33:04,740] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'datawarehouse_etl', 'load_invoices', 'scheduled__2022-01-01T00:00:00+00:00', '--job-id', '36', '--raw', '--subdir', 'DAGS_FOLDER/datawarehouse_***.py', '--cfg-path', '/tmp/tmpk46na1nc', '--error-file', '/tmp/tmpk69zph25']
[2022-01-24 02:33:04,741] {standard_task_runner.py:77} INFO - Job 36: Subtask load_invoices
[2022-01-24 02:33:04,801] {logging_mixin.py:109} INFO - Running <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-01T00:00:00+00:00 [running]> on host cd9bb47288d1
[2022-01-24 02:33:04,856] {taskinstance.py:1426} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=datawarehouse_etl
AIRFLOW_CTX_TASK_ID=load_invoices
AIRFLOW_CTX_EXECUTION_DATE=2022-01-01T00:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-01-01T00:00:00+00:00
[2022-01-24 02:33:04,858] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:33:04,858] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:33:04,858] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds_nodash' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds_nodash }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:33:04,858] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_end' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:33:04,858] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:33:04,859] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:33:04,859] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:33:04,859] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date_success' from the template is deprecated and will be removed in a future version. Please use 'prev_data_interval_start_success' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:33:04,859] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:33:04,859] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:33:04,859] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:33:04,859] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:33:04,860] {logging_mixin.py:109} INFO - {'conf': <***.configuration.AirflowConfigParser object at 0x7f1e4dfc6a10>, 'dag': <DAG: datawarehouse_etl>, 'dag_run': <DagRun datawarehouse_etl @ 2022-01-01 00:00:00+00:00: scheduled__2022-01-01T00:00:00+00:00, externally triggered: False>, 'data_interval_end': DateTime(2022, 1, 2, 0, 0, 0, tzinfo=Timezone('UTC')), 'data_interval_start': DateTime(2022, 1, 1, 0, 0, 0, tzinfo=Timezone('UTC')), 'ds': '2022-01-01', 'ds_nodash': '20220101', 'execution_date': DateTime(2022, 1, 1, 0, 0, 0, tzinfo=Timezone('UTC')), 'inlets': [], 'logical_date': DateTime(2022, 1, 1, 0, 0, 0, tzinfo=Timezone('UTC')), 'macros': <module '***.macros' from '/home/***/.local/lib/python3.7/site-packages/***/macros/__init__.py'>, 'next_ds': '2022-01-02', 'next_ds_nodash': '20220102', 'next_execution_date': DateTime(2022, 1, 2, 0, 0, 0, tzinfo=Timezone('UTC')), 'outlets': [], 'params': {}, 'prev_data_interval_start_success': None, 'prev_data_interval_end_success': None, 'prev_ds': '2021-12-31', 'prev_ds_nodash': '20211231', 'prev_execution_date': datetime.datetime(2021, 12, 31, 0, 0, tzinfo=Timezone('UTC')), 'prev_execution_date_success': None, 'prev_start_date_success': None, 'run_id': 'scheduled__2022-01-01T00:00:00+00:00', 'task': <Task(PythonOperator): load_invoices>, 'task_instance': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-01T00:00:00+00:00 [running]>, 'task_instance_key_str': 'datawarehouse_etl__load_invoices__20220101', 'test_mode': False, 'ti': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-01T00:00:00+00:00 [running]>, 'tomorrow_ds': '2022-01-02', 'tomorrow_ds_nodash': '20220102', 'ts': '2022-01-01T00:00:00+00:00', 'ts_nodash': '20220101T000000', 'ts_nodash_with_tz': '20220101T000000+0000', 'var': {'json': None, 'value': None}, 'conn': None, 'yesterday_ds': '2021-12-31', 'yesterday_ds_nodash': '20211231', 'key': 'value', 'ts_var': '2022-01-01T00:00:00+00:00', 'tsnodash_var': '20220101T000000', 'templates_dict': None}
[2022-01-24 02:33:04,861] {logging_mixin.py:109} INFO - 2022-01-01 00:00:00+00:00
[2022-01-24 02:33:04,861] {taskinstance.py:1700} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1329, in _run_raw_task
    self._execute_task_with_callbacks(context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1455, in _execute_task_with_callbacks
    result = self._execute_task(context, self.task)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1511, in _execute_task
    result = execute_callable(context=context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 174, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 185, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/datawarehouse_airflow.py", line 45, in load_invoices
    print(ts.year())
TypeError: 'int' object is not callable
[2022-01-24 02:33:04,875] {taskinstance.py:1277} INFO - Marking task as FAILED. dag_id=datawarehouse_etl, task_id=load_invoices, execution_date=20220101T000000, start_date=20220124T023304, end_date=20220124T023304
[2022-01-24 02:33:04,888] {standard_task_runner.py:92} ERROR - Failed to execute job 36 for task load_invoices
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/task/task_runner/standard_task_runner.py", line 85, in _start_by_fork
    args.func(args, dag=self.dag)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/cli_parser.py", line 48, in command
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/cli.py", line 92, in wrapper
    return f(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/commands/task_command.py", line 298, in task_run
    _run_task_by_selected_method(args, dag, ti)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/commands/task_command.py", line 107, in _run_task_by_selected_method
    _run_raw_task(args, ti)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/commands/task_command.py", line 184, in _run_raw_task
    error_file=args.error_file,
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/session.py", line 70, in wrapper
    return func(*args, session=session, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1329, in _run_raw_task
    self._execute_task_with_callbacks(context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1455, in _execute_task_with_callbacks
    result = self._execute_task(context, self.task)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1511, in _execute_task
    result = execute_callable(context=context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 174, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 185, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/datawarehouse_airflow.py", line 45, in load_invoices
    print(ts.year())
TypeError: 'int' object is not callable
[2022-01-24 02:33:04,912] {local_task_job.py:154} INFO - Task exited with return code 1
[2022-01-24 02:33:04,970] {local_task_job.py:264} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-01-24 02:34:33,853] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-01T00:00:00+00:00 [queued]>
[2022-01-24 02:34:33,880] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-01T00:00:00+00:00 [queued]>
[2022-01-24 02:34:33,880] {taskinstance.py:1238} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 02:34:33,880] {taskinstance.py:1239} INFO - Starting attempt 1 of 1
[2022-01-24 02:34:33,880] {taskinstance.py:1240} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 02:34:33,915] {taskinstance.py:1259} INFO - Executing <Task(PythonOperator): load_invoices> on 2022-01-01 00:00:00+00:00
[2022-01-24 02:34:33,925] {standard_task_runner.py:52} INFO - Started process 2508 to run task
[2022-01-24 02:34:33,942] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'datawarehouse_etl', 'load_invoices', 'scheduled__2022-01-01T00:00:00+00:00', '--job-id', '41', '--raw', '--subdir', 'DAGS_FOLDER/datawarehouse_***.py', '--cfg-path', '/tmp/tmp_6hm0jy2', '--error-file', '/tmp/tmpm76ri4ar']
[2022-01-24 02:34:33,944] {standard_task_runner.py:77} INFO - Job 41: Subtask load_invoices
[2022-01-24 02:34:34,089] {logging_mixin.py:109} INFO - Running <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-01T00:00:00+00:00 [running]> on host cd9bb47288d1
[2022-01-24 02:34:34,243] {taskinstance.py:1426} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=datawarehouse_etl
AIRFLOW_CTX_TASK_ID=load_invoices
AIRFLOW_CTX_EXECUTION_DATE=2022-01-01T00:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-01-01T00:00:00+00:00
[2022-01-24 02:34:34,247] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:34:34,247] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:34:34,247] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds_nodash' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds_nodash }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:34:34,248] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_end' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:34:34,249] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:34:34,249] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:34:34,253] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:34:34,254] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date_success' from the template is deprecated and will be removed in a future version. Please use 'prev_data_interval_start_success' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:34:34,254] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:34:34,255] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:34:34,255] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:34:34,255] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:34:34,259] {logging_mixin.py:109} INFO - {'conf': <***.configuration.AirflowConfigParser object at 0x7f1e4dfc6a10>, 'dag': <DAG: datawarehouse_etl>, 'dag_run': <DagRun datawarehouse_etl @ 2022-01-01 00:00:00+00:00: scheduled__2022-01-01T00:00:00+00:00, externally triggered: False>, 'data_interval_end': DateTime(2022, 1, 2, 0, 0, 0, tzinfo=Timezone('UTC')), 'data_interval_start': DateTime(2022, 1, 1, 0, 0, 0, tzinfo=Timezone('UTC')), 'ds': '2022-01-01', 'ds_nodash': '20220101', 'execution_date': DateTime(2022, 1, 1, 0, 0, 0, tzinfo=Timezone('UTC')), 'inlets': [], 'logical_date': DateTime(2022, 1, 1, 0, 0, 0, tzinfo=Timezone('UTC')), 'macros': <module '***.macros' from '/home/***/.local/lib/python3.7/site-packages/***/macros/__init__.py'>, 'next_ds': '2022-01-02', 'next_ds_nodash': '20220102', 'next_execution_date': DateTime(2022, 1, 2, 0, 0, 0, tzinfo=Timezone('UTC')), 'outlets': [], 'params': {}, 'prev_data_interval_start_success': None, 'prev_data_interval_end_success': None, 'prev_ds': '2021-12-31', 'prev_ds_nodash': '20211231', 'prev_execution_date': datetime.datetime(2021, 12, 31, 0, 0, tzinfo=Timezone('UTC')), 'prev_execution_date_success': None, 'prev_start_date_success': None, 'run_id': 'scheduled__2022-01-01T00:00:00+00:00', 'task': <Task(PythonOperator): load_invoices>, 'task_instance': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-01T00:00:00+00:00 [running]>, 'task_instance_key_str': 'datawarehouse_etl__load_invoices__20220101', 'test_mode': False, 'ti': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-01T00:00:00+00:00 [running]>, 'tomorrow_ds': '2022-01-02', 'tomorrow_ds_nodash': '20220102', 'ts': '2022-01-01T00:00:00+00:00', 'ts_nodash': '20220101T000000', 'ts_nodash_with_tz': '20220101T000000+0000', 'var': {'json': None, 'value': None}, 'conn': None, 'yesterday_ds': '2021-12-31', 'yesterday_ds_nodash': '20211231', 'key': 'value', 'ts_var': '2022-01-01T00:00:00+00:00', 'tsnodash_var': '20220101T000000', 'templates_dict': None}
[2022-01-24 02:34:34,262] {logging_mixin.py:109} INFO - ts:  2022-01-01 00:00:00+00:00
[2022-01-24 02:34:34,263] {taskinstance.py:1700} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1329, in _run_raw_task
    self._execute_task_with_callbacks(context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1455, in _execute_task_with_callbacks
    result = self._execute_task(context, self.task)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1511, in _execute_task
    result = execute_callable(context=context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 174, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 185, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/datawarehouse_airflow.py", line 45, in load_invoices
    print(ts.year())
TypeError: 'int' object is not callable
[2022-01-24 02:34:34,301] {taskinstance.py:1277} INFO - Marking task as FAILED. dag_id=datawarehouse_etl, task_id=load_invoices, execution_date=20220101T000000, start_date=20220124T023433, end_date=20220124T023434
[2022-01-24 02:34:34,332] {standard_task_runner.py:92} ERROR - Failed to execute job 41 for task load_invoices
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/task/task_runner/standard_task_runner.py", line 85, in _start_by_fork
    args.func(args, dag=self.dag)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/cli_parser.py", line 48, in command
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/cli.py", line 92, in wrapper
    return f(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/commands/task_command.py", line 298, in task_run
    _run_task_by_selected_method(args, dag, ti)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/commands/task_command.py", line 107, in _run_task_by_selected_method
    _run_raw_task(args, ti)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/commands/task_command.py", line 184, in _run_raw_task
    error_file=args.error_file,
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/session.py", line 70, in wrapper
    return func(*args, session=session, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1329, in _run_raw_task
    self._execute_task_with_callbacks(context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1455, in _execute_task_with_callbacks
    result = self._execute_task(context, self.task)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1511, in _execute_task
    result = execute_callable(context=context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 174, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 185, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/datawarehouse_airflow.py", line 45, in load_invoices
    print(ts.year())
TypeError: 'int' object is not callable
[2022-01-24 02:34:34,361] {local_task_job.py:154} INFO - Task exited with return code 1
[2022-01-24 02:34:34,467] {local_task_job.py:264} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-01-24 02:39:35,310] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-01T00:00:00+00:00 [queued]>
[2022-01-24 02:39:35,324] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-01T00:00:00+00:00 [queued]>
[2022-01-24 02:39:35,325] {taskinstance.py:1238} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 02:39:35,325] {taskinstance.py:1239} INFO - Starting attempt 1 of 1
[2022-01-24 02:39:35,325] {taskinstance.py:1240} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 02:39:35,349] {taskinstance.py:1259} INFO - Executing <Task(PythonOperator): load_invoices> on 2022-01-01 00:00:00+00:00
[2022-01-24 02:39:35,355] {standard_task_runner.py:52} INFO - Started process 2755 to run task
[2022-01-24 02:39:35,359] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'datawarehouse_etl', 'load_invoices', 'scheduled__2022-01-01T00:00:00+00:00', '--job-id', '51', '--raw', '--subdir', 'DAGS_FOLDER/datawarehouse_***.py', '--cfg-path', '/tmp/tmp9tl1roqg', '--error-file', '/tmp/tmp6pq02b6k']
[2022-01-24 02:39:35,360] {standard_task_runner.py:77} INFO - Job 51: Subtask load_invoices
[2022-01-24 02:39:35,416] {logging_mixin.py:109} INFO - Running <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-01T00:00:00+00:00 [running]> on host cd9bb47288d1
[2022-01-24 02:39:35,475] {taskinstance.py:1426} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=datawarehouse_etl
AIRFLOW_CTX_TASK_ID=load_invoices
AIRFLOW_CTX_EXECUTION_DATE=2022-01-01T00:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-01-01T00:00:00+00:00
[2022-01-24 02:39:35,476] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:39:35,477] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:39:35,477] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds_nodash' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds_nodash }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:39:35,477] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_end' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:39:35,477] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:39:35,477] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:39:35,477] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:39:35,477] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date_success' from the template is deprecated and will be removed in a future version. Please use 'prev_data_interval_start_success' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:39:35,477] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:39:35,478] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:39:35,478] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:39:35,478] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:39:35,478] {logging_mixin.py:109} INFO - {'conf': <***.configuration.AirflowConfigParser object at 0x7f1e4dfc6a10>, 'dag': <DAG: datawarehouse_etl>, 'dag_run': <DagRun datawarehouse_etl @ 2022-01-01 00:00:00+00:00: scheduled__2022-01-01T00:00:00+00:00, externally triggered: False>, 'data_interval_end': DateTime(2022, 1, 2, 0, 0, 0, tzinfo=Timezone('UTC')), 'data_interval_start': DateTime(2022, 1, 1, 0, 0, 0, tzinfo=Timezone('UTC')), 'ds': '2022-01-01', 'ds_nodash': '20220101', 'execution_date': DateTime(2022, 1, 1, 0, 0, 0, tzinfo=Timezone('UTC')), 'inlets': [], 'logical_date': DateTime(2022, 1, 1, 0, 0, 0, tzinfo=Timezone('UTC')), 'macros': <module '***.macros' from '/home/***/.local/lib/python3.7/site-packages/***/macros/__init__.py'>, 'next_ds': '2022-01-02', 'next_ds_nodash': '20220102', 'next_execution_date': DateTime(2022, 1, 2, 0, 0, 0, tzinfo=Timezone('UTC')), 'outlets': [], 'params': {}, 'prev_data_interval_start_success': None, 'prev_data_interval_end_success': None, 'prev_ds': '2021-12-31', 'prev_ds_nodash': '20211231', 'prev_execution_date': datetime.datetime(2021, 12, 31, 0, 0, tzinfo=Timezone('UTC')), 'prev_execution_date_success': None, 'prev_start_date_success': None, 'run_id': 'scheduled__2022-01-01T00:00:00+00:00', 'task': <Task(PythonOperator): load_invoices>, 'task_instance': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-01T00:00:00+00:00 [running]>, 'task_instance_key_str': 'datawarehouse_etl__load_invoices__20220101', 'test_mode': False, 'ti': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-01T00:00:00+00:00 [running]>, 'tomorrow_ds': '2022-01-02', 'tomorrow_ds_nodash': '20220102', 'ts': '2022-01-01T00:00:00+00:00', 'ts_nodash': '20220101T000000', 'ts_nodash_with_tz': '20220101T000000+0000', 'var': {'json': None, 'value': None}, 'conn': None, 'yesterday_ds': '2021-12-31', 'yesterday_ds_nodash': '20211231', 'key': 'value', 'ts_var': '2022-01-01T00:00:00+00:00', 'tsnodash_var': '20220101T000000', 'templates_dict': None}
[2022-01-24 02:39:35,480] {logging_mixin.py:109} INFO - ts:  2022-01-01 00:00:00+00:00
[2022-01-24 02:39:35,480] {logging_mixin.py:109} INFO - <class 'pandas._libs.tslibs.timestamps.Timestamp'>
[2022-01-24 02:39:35,480] {logging_mixin.py:109} INFO - Object created.
[2022-01-24 02:39:35,481] {logging_mixin.py:109} INFO - 2022 1 1
[2022-01-24 02:39:35,482] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-12.json
[2022-01-24 02:39:35,482] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-47.json
[2022-01-24 02:39:35,482] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-11.json
[2022-01-24 02:39:35,482] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-24.json
[2022-01-24 02:39:35,483] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-41.json
[2022-01-24 02:39:35,483] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-29.json
[2022-01-24 02:39:35,483] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-37.json
[2022-01-24 02:39:35,483] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-14.json
[2022-01-24 02:39:35,483] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-82.json
[2022-01-24 02:39:35,483] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-85.json
[2022-01-24 02:39:35,484] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-72.json
[2022-01-24 02:39:35,484] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-18.json
[2022-01-24 02:39:35,484] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-17.json
[2022-01-24 02:39:35,484] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-66.json
[2022-01-24 02:39:35,484] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-30.json
[2022-01-24 02:39:35,484] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-31.json
[2022-01-24 02:39:35,484] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-70.json
[2022-01-24 02:39:35,485] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-57.json
[2022-01-24 02:39:35,485] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-10.json
[2022-01-24 02:39:35,485] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-54.json
[2022-01-24 02:39:35,485] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-7.json
[2022-01-24 02:39:35,485] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-0.json
[2022-01-24 02:39:35,485] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-74.json
[2022-01-24 02:39:35,485] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-19.json
[2022-01-24 02:39:35,485] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-43.json
[2022-01-24 02:39:35,485] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-27.json
[2022-01-24 02:39:35,486] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-76.json
[2022-01-24 02:39:35,486] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-2.json
[2022-01-24 02:39:35,486] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-73.json
[2022-01-24 02:39:35,486] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-34.json
[2022-01-24 02:39:35,486] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-28.json
[2022-01-24 02:39:35,486] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-20.json
[2022-01-24 02:39:35,486] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-44.json
[2022-01-24 02:39:35,486] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-63.json
[2022-01-24 02:39:35,487] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-1.json
[2022-01-24 02:39:35,487] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-91.json
[2022-01-24 02:39:35,487] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-89.json
[2022-01-24 02:39:35,487] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-75.json
[2022-01-24 02:39:35,487] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-16.json
[2022-01-24 02:39:35,487] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-5.json
[2022-01-24 02:39:35,487] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-65.json
[2022-01-24 02:39:35,487] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-33.json
[2022-01-24 02:39:35,487] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-15.json
[2022-01-24 02:39:35,488] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-42.json
[2022-01-24 02:39:35,488] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-79.json
[2022-01-24 02:39:35,488] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-32.json
[2022-01-24 02:39:35,488] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-62.json
[2022-01-24 02:39:35,488] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-21.json
[2022-01-24 02:39:35,488] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-35.json
[2022-01-24 02:39:35,488] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-4.json
[2022-01-24 02:39:35,488] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-81.json
[2022-01-24 02:39:35,488] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-52.json
[2022-01-24 02:39:35,489] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-60.json
[2022-01-24 02:39:35,489] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-46.json
[2022-01-24 02:39:35,489] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-83.json
[2022-01-24 02:39:35,489] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-92.json
[2022-01-24 02:39:35,489] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-71.json
[2022-01-24 02:39:35,489] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-48.json
[2022-01-24 02:39:35,490] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-22.json
[2022-01-24 02:39:35,490] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-55.json
[2022-01-24 02:39:35,490] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-64.json
[2022-01-24 02:39:35,490] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-23.json
[2022-01-24 02:39:35,490] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-88.json
[2022-01-24 02:39:35,490] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-67.json
[2022-01-24 02:39:35,490] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-8.json
[2022-01-24 02:39:35,490] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-51.json
[2022-01-24 02:39:35,491] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-26.json
[2022-01-24 02:39:35,491] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-77.json
[2022-01-24 02:39:35,491] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-87.json
[2022-01-24 02:39:35,491] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-38.json
[2022-01-24 02:39:35,491] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-61.json
[2022-01-24 02:39:35,491] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-84.json
[2022-01-24 02:39:35,491] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-9.json
[2022-01-24 02:39:35,491] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-80.json
[2022-01-24 02:39:35,492] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-68.json
[2022-01-24 02:39:35,492] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-6.json
[2022-01-24 02:39:35,492] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-90.json
[2022-01-24 02:39:35,492] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-45.json
[2022-01-24 02:39:35,492] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-58.json
[2022-01-24 02:39:35,492] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-50.json
[2022-01-24 02:39:35,492] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-3.json
[2022-01-24 02:39:35,493] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-86.json
[2022-01-24 02:39:35,493] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-25.json
[2022-01-24 02:39:35,493] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-78.json
[2022-01-24 02:39:35,493] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-56.json
[2022-01-24 02:39:35,493] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-59.json
[2022-01-24 02:39:35,493] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-53.json
[2022-01-24 02:39:35,493] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-49.json
[2022-01-24 02:39:35,493] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-36.json
[2022-01-24 02:39:35,493] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-69.json
[2022-01-24 02:39:35,494] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-13.json
[2022-01-24 02:39:35,494] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-39.json
[2022-01-24 02:39:35,494] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-40.json
[2022-01-24 02:39:35,496] {logging_mixin.py:109} INFO - 93
[2022-01-24 02:39:35,524] {logging_mixin.py:109} INFO -      invoice_id    invoice_timestamp  customer_id  ...  qty is_discount       price
0    20220101-2  2022-01-01T10:50:31  zeytfvk2553  ...  165           1   8832.9780
1   20220101-51  2022-01-01T06:47:08  afxkwkm4444  ...  283           0  20336.3800
2   20220101-19  2022-01-01T02:05:18  kyeceqk1245  ...   35           0   2602.6000
3   20220101-30  2022-01-01T04:24:46  sexnidd1428  ...  193           0  17395.0900
4   20220101-46  2022-01-01T08:02:25  pejhuht3583  ...   37           1    169.5784
..          ...                  ...          ...  ...  ...         ...         ...
88  20220101-41  2022-01-01T11:56:00  lzoimgb3646  ...  140           1   4513.5860
89  20220101-71  2022-01-01T07:22:52  wziuxfs4826  ...  290           1  10276.2660
90  20220101-20  2022-01-01T06:48:47  ljjexgl5253  ...   31           1    627.0649
91  20220101-44  2022-01-01T15:41:47  kyeceqk1245  ...   56           0   4891.0400
92  20220101-45  2022-01-01T19:53:27  yyymlnv2864  ...   37           1    971.6163

[93 rows x 8 columns]
[2022-01-24 02:39:35,524] {python.py:175} INFO - Done. Returned value was: None
[2022-01-24 02:39:35,566] {taskinstance.py:1277} INFO - Marking task as SUCCESS. dag_id=datawarehouse_etl, task_id=load_invoices, execution_date=20220101T000000, start_date=20220124T023935, end_date=20220124T023935
[2022-01-24 02:39:35,614] {local_task_job.py:154} INFO - Task exited with return code 0
[2022-01-24 02:39:35,663] {local_task_job.py:264} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2022-01-24 02:41:48,105] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-01T00:00:00+00:00 [queued]>
[2022-01-24 02:41:48,120] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-01T00:00:00+00:00 [queued]>
[2022-01-24 02:41:48,120] {taskinstance.py:1238} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 02:41:48,120] {taskinstance.py:1239} INFO - Starting attempt 1 of 1
[2022-01-24 02:41:48,120] {taskinstance.py:1240} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 02:41:48,134] {taskinstance.py:1259} INFO - Executing <Task(PythonOperator): load_invoices> on 2022-01-01 00:00:00+00:00
[2022-01-24 02:41:48,142] {standard_task_runner.py:52} INFO - Started process 2860 to run task
[2022-01-24 02:41:48,146] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'datawarehouse_etl', 'load_invoices', 'scheduled__2022-01-01T00:00:00+00:00', '--job-id', '56', '--raw', '--subdir', 'DAGS_FOLDER/datawarehouse_***.py', '--cfg-path', '/tmp/tmpwo0lt81b', '--error-file', '/tmp/tmphs4cyd1w']
[2022-01-24 02:41:48,147] {standard_task_runner.py:77} INFO - Job 56: Subtask load_invoices
[2022-01-24 02:41:48,210] {logging_mixin.py:109} INFO - Running <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-01T00:00:00+00:00 [running]> on host cd9bb47288d1
[2022-01-24 02:41:48,272] {taskinstance.py:1426} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=datawarehouse_etl
AIRFLOW_CTX_TASK_ID=load_invoices
AIRFLOW_CTX_EXECUTION_DATE=2022-01-01T00:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-01-01T00:00:00+00:00
[2022-01-24 02:41:48,274] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:41:48,274] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:41:48,274] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds_nodash' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds_nodash }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:41:48,274] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_end' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:41:48,274] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:41:48,275] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:41:48,275] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:41:48,275] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date_success' from the template is deprecated and will be removed in a future version. Please use 'prev_data_interval_start_success' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:41:48,275] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:41:48,275] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:41:48,275] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:41:48,275] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 02:41:48,276] {logging_mixin.py:109} INFO - {'conf': <***.configuration.AirflowConfigParser object at 0x7f1e4dfc6a10>, 'dag': <DAG: datawarehouse_etl>, 'dag_run': <DagRun datawarehouse_etl @ 2022-01-01 00:00:00+00:00: scheduled__2022-01-01T00:00:00+00:00, externally triggered: False>, 'data_interval_end': DateTime(2022, 1, 2, 0, 0, 0, tzinfo=Timezone('UTC')), 'data_interval_start': DateTime(2022, 1, 1, 0, 0, 0, tzinfo=Timezone('UTC')), 'ds': '2022-01-01', 'ds_nodash': '20220101', 'execution_date': DateTime(2022, 1, 1, 0, 0, 0, tzinfo=Timezone('UTC')), 'inlets': [], 'logical_date': DateTime(2022, 1, 1, 0, 0, 0, tzinfo=Timezone('UTC')), 'macros': <module '***.macros' from '/home/***/.local/lib/python3.7/site-packages/***/macros/__init__.py'>, 'next_ds': '2022-01-02', 'next_ds_nodash': '20220102', 'next_execution_date': DateTime(2022, 1, 2, 0, 0, 0, tzinfo=Timezone('UTC')), 'outlets': [], 'params': {}, 'prev_data_interval_start_success': None, 'prev_data_interval_end_success': None, 'prev_ds': '2021-12-31', 'prev_ds_nodash': '20211231', 'prev_execution_date': datetime.datetime(2021, 12, 31, 0, 0, tzinfo=Timezone('UTC')), 'prev_execution_date_success': None, 'prev_start_date_success': None, 'run_id': 'scheduled__2022-01-01T00:00:00+00:00', 'task': <Task(PythonOperator): load_invoices>, 'task_instance': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-01T00:00:00+00:00 [running]>, 'task_instance_key_str': 'datawarehouse_etl__load_invoices__20220101', 'test_mode': False, 'ti': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-01T00:00:00+00:00 [running]>, 'tomorrow_ds': '2022-01-02', 'tomorrow_ds_nodash': '20220102', 'ts': '2022-01-01T00:00:00+00:00', 'ts_nodash': '20220101T000000', 'ts_nodash_with_tz': '20220101T000000+0000', 'var': {'json': None, 'value': None}, 'conn': None, 'yesterday_ds': '2021-12-31', 'yesterday_ds_nodash': '20211231', 'key': 'value', 'ts_var': '2022-01-01T00:00:00+00:00', 'tsnodash_var': '20220101T000000', 'templates_dict': None}
[2022-01-24 02:41:48,277] {logging_mixin.py:109} INFO - ts:  2022-01-01 00:00:00+00:00
[2022-01-24 02:41:48,277] {logging_mixin.py:109} INFO - <class 'pandas._libs.tslibs.timestamps.Timestamp'>
[2022-01-24 02:41:48,278] {logging_mixin.py:109} INFO - Object created.
[2022-01-24 02:41:48,278] {logging_mixin.py:109} INFO - 2022 1 1
[2022-01-24 02:41:48,279] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-12.json
[2022-01-24 02:41:48,279] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-47.json
[2022-01-24 02:41:48,279] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-11.json
[2022-01-24 02:41:48,279] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-24.json
[2022-01-24 02:41:48,280] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-41.json
[2022-01-24 02:41:48,280] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-29.json
[2022-01-24 02:41:48,280] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-37.json
[2022-01-24 02:41:48,280] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-14.json
[2022-01-24 02:41:48,280] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-82.json
[2022-01-24 02:41:48,280] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-85.json
[2022-01-24 02:41:48,281] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-72.json
[2022-01-24 02:41:48,281] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-18.json
[2022-01-24 02:41:48,281] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-17.json
[2022-01-24 02:41:48,281] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-66.json
[2022-01-24 02:41:48,281] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-30.json
[2022-01-24 02:41:48,281] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-31.json
[2022-01-24 02:41:48,281] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-70.json
[2022-01-24 02:41:48,282] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-57.json
[2022-01-24 02:41:48,282] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-10.json
[2022-01-24 02:41:48,282] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-54.json
[2022-01-24 02:41:48,282] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-7.json
[2022-01-24 02:41:48,282] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-0.json
[2022-01-24 02:41:48,282] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-74.json
[2022-01-24 02:41:48,283] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-19.json
[2022-01-24 02:41:48,283] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-43.json
[2022-01-24 02:41:48,283] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-27.json
[2022-01-24 02:41:48,283] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-76.json
[2022-01-24 02:41:48,283] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-2.json
[2022-01-24 02:41:48,283] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-73.json
[2022-01-24 02:41:48,284] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-34.json
[2022-01-24 02:41:48,284] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-28.json
[2022-01-24 02:41:48,285] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-20.json
[2022-01-24 02:41:48,285] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-44.json
[2022-01-24 02:41:48,285] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-63.json
[2022-01-24 02:41:48,285] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-1.json
[2022-01-24 02:41:48,285] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-91.json
[2022-01-24 02:41:48,286] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-89.json
[2022-01-24 02:41:48,286] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-75.json
[2022-01-24 02:41:48,286] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-16.json
[2022-01-24 02:41:48,286] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-5.json
[2022-01-24 02:41:48,286] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-65.json
[2022-01-24 02:41:48,286] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-33.json
[2022-01-24 02:41:48,287] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-15.json
[2022-01-24 02:41:48,287] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-42.json
[2022-01-24 02:41:48,287] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-79.json
[2022-01-24 02:41:48,287] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-32.json
[2022-01-24 02:41:48,287] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-62.json
[2022-01-24 02:41:48,287] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-21.json
[2022-01-24 02:41:48,288] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-35.json
[2022-01-24 02:41:48,288] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-4.json
[2022-01-24 02:41:48,288] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-81.json
[2022-01-24 02:41:48,288] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-52.json
[2022-01-24 02:41:48,288] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-60.json
[2022-01-24 02:41:48,289] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-46.json
[2022-01-24 02:41:48,289] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-83.json
[2022-01-24 02:41:48,289] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-92.json
[2022-01-24 02:41:48,290] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-71.json
[2022-01-24 02:41:48,290] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-48.json
[2022-01-24 02:41:48,290] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-22.json
[2022-01-24 02:41:48,291] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-55.json
[2022-01-24 02:41:48,291] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-64.json
[2022-01-24 02:41:48,291] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-23.json
[2022-01-24 02:41:48,291] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-88.json
[2022-01-24 02:41:48,292] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-67.json
[2022-01-24 02:41:48,292] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-8.json
[2022-01-24 02:41:48,292] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-51.json
[2022-01-24 02:41:48,292] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-26.json
[2022-01-24 02:41:48,292] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-77.json
[2022-01-24 02:41:48,293] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-87.json
[2022-01-24 02:41:48,293] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-38.json
[2022-01-24 02:41:48,293] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-61.json
[2022-01-24 02:41:48,293] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-84.json
[2022-01-24 02:41:48,293] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-9.json
[2022-01-24 02:41:48,293] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-80.json
[2022-01-24 02:41:48,293] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-68.json
[2022-01-24 02:41:48,294] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-6.json
[2022-01-24 02:41:48,294] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-90.json
[2022-01-24 02:41:48,294] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-45.json
[2022-01-24 02:41:48,294] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-58.json
[2022-01-24 02:41:48,294] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-50.json
[2022-01-24 02:41:48,294] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-3.json
[2022-01-24 02:41:48,295] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-86.json
[2022-01-24 02:41:48,295] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-25.json
[2022-01-24 02:41:48,295] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-78.json
[2022-01-24 02:41:48,295] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-56.json
[2022-01-24 02:41:48,295] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-59.json
[2022-01-24 02:41:48,295] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-53.json
[2022-01-24 02:41:48,295] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-49.json
[2022-01-24 02:41:48,296] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-36.json
[2022-01-24 02:41:48,296] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-69.json
[2022-01-24 02:41:48,296] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-13.json
[2022-01-24 02:41:48,296] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-39.json
[2022-01-24 02:41:48,296] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-40.json
[2022-01-24 02:41:48,299] {logging_mixin.py:109} INFO - 93
[2022-01-24 02:41:48,333] {logging_mixin.py:109} INFO -      invoice_id    invoice_timestamp  customer_id  ...  qty is_discount       price
0    20220101-2  2022-01-01T10:50:31  zeytfvk2553  ...  165           1   8832.9780
1   20220101-51  2022-01-01T06:47:08  afxkwkm4444  ...  283           0  20336.3800
2   20220101-19  2022-01-01T02:05:18  kyeceqk1245  ...   35           0   2602.6000
3   20220101-30  2022-01-01T04:24:46  sexnidd1428  ...  193           0  17395.0900
4   20220101-46  2022-01-01T08:02:25  pejhuht3583  ...   37           1    169.5784
..          ...                  ...          ...  ...  ...         ...         ...
88  20220101-41  2022-01-01T11:56:00  lzoimgb3646  ...  140           1   4513.5860
89  20220101-71  2022-01-01T07:22:52  wziuxfs4826  ...  290           1  10276.2660
90  20220101-20  2022-01-01T06:48:47  ljjexgl5253  ...   31           1    627.0649
91  20220101-44  2022-01-01T15:41:47  kyeceqk1245  ...   56           0   4891.0400
92  20220101-45  2022-01-01T19:53:27  yyymlnv2864  ...   37           1    971.6163

[93 rows x 8 columns]
[2022-01-24 02:41:48,333] {python.py:175} INFO - Done. Returned value was: None
[2022-01-24 02:41:48,361] {taskinstance.py:1277} INFO - Marking task as SUCCESS. dag_id=datawarehouse_etl, task_id=load_invoices, execution_date=20220101T000000, start_date=20220124T024148, end_date=20220124T024148
[2022-01-24 02:41:48,439] {local_task_job.py:154} INFO - Task exited with return code 0
[2022-01-24 02:41:48,482] {local_task_job.py:264} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2022-01-24 03:38:29,513] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-01T00:00:00+00:00 [queued]>
[2022-01-24 03:38:29,525] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-01T00:00:00+00:00 [queued]>
[2022-01-24 03:38:29,526] {taskinstance.py:1238} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 03:38:29,526] {taskinstance.py:1239} INFO - Starting attempt 1 of 1
[2022-01-24 03:38:29,526] {taskinstance.py:1240} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 03:38:29,537] {taskinstance.py:1259} INFO - Executing <Task(PythonOperator): load_invoices> on 2022-01-01 00:00:00+00:00
[2022-01-24 03:38:29,541] {standard_task_runner.py:52} INFO - Started process 5398 to run task
[2022-01-24 03:38:29,544] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'datawarehouse_etl', 'load_invoices', 'scheduled__2022-01-01T00:00:00+00:00', '--job-id', '57', '--raw', '--subdir', 'DAGS_FOLDER/datawarehouse_***.py', '--cfg-path', '/tmp/tmpj4gik4yv', '--error-file', '/tmp/tmp1674k5wp']
[2022-01-24 03:38:29,544] {standard_task_runner.py:77} INFO - Job 57: Subtask load_invoices
[2022-01-24 03:38:29,582] {logging_mixin.py:109} INFO - Running <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-01T00:00:00+00:00 [running]> on host cd9bb47288d1
[2022-01-24 03:38:29,625] {taskinstance.py:1426} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=datawarehouse_etl
AIRFLOW_CTX_TASK_ID=load_invoices
AIRFLOW_CTX_EXECUTION_DATE=2022-01-01T00:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-01-01T00:00:00+00:00
[2022-01-24 03:38:29,627] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:38:29,627] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:38:29,627] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds_nodash' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds_nodash }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:38:29,628] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_end' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:38:29,628] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:38:29,628] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:38:29,628] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:38:29,628] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date_success' from the template is deprecated and will be removed in a future version. Please use 'prev_data_interval_start_success' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:38:29,628] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:38:29,628] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:38:29,628] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:38:29,629] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:38:29,629] {logging_mixin.py:109} INFO - {'conf': <***.configuration.AirflowConfigParser object at 0x7f1e4dfc6a10>, 'dag': <DAG: datawarehouse_etl>, 'dag_run': <DagRun datawarehouse_etl @ 2022-01-01 00:00:00+00:00: scheduled__2022-01-01T00:00:00+00:00, externally triggered: False>, 'data_interval_end': DateTime(2022, 1, 2, 0, 0, 0, tzinfo=Timezone('UTC')), 'data_interval_start': DateTime(2022, 1, 1, 0, 0, 0, tzinfo=Timezone('UTC')), 'ds': '2022-01-01', 'ds_nodash': '20220101', 'execution_date': DateTime(2022, 1, 1, 0, 0, 0, tzinfo=Timezone('UTC')), 'inlets': [], 'logical_date': DateTime(2022, 1, 1, 0, 0, 0, tzinfo=Timezone('UTC')), 'macros': <module '***.macros' from '/home/***/.local/lib/python3.7/site-packages/***/macros/__init__.py'>, 'next_ds': '2022-01-02', 'next_ds_nodash': '20220102', 'next_execution_date': DateTime(2022, 1, 2, 0, 0, 0, tzinfo=Timezone('UTC')), 'outlets': [], 'params': {}, 'prev_data_interval_start_success': None, 'prev_data_interval_end_success': None, 'prev_ds': '2021-12-31', 'prev_ds_nodash': '20211231', 'prev_execution_date': datetime.datetime(2021, 12, 31, 0, 0, tzinfo=Timezone('UTC')), 'prev_execution_date_success': None, 'prev_start_date_success': None, 'run_id': 'scheduled__2022-01-01T00:00:00+00:00', 'task': <Task(PythonOperator): load_invoices>, 'task_instance': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-01T00:00:00+00:00 [running]>, 'task_instance_key_str': 'datawarehouse_etl__load_invoices__20220101', 'test_mode': False, 'ti': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-01T00:00:00+00:00 [running]>, 'tomorrow_ds': '2022-01-02', 'tomorrow_ds_nodash': '20220102', 'ts': '2022-01-01T00:00:00+00:00', 'ts_nodash': '20220101T000000', 'ts_nodash_with_tz': '20220101T000000+0000', 'var': {'json': None, 'value': None}, 'conn': None, 'yesterday_ds': '2021-12-31', 'yesterday_ds_nodash': '20211231', 'key': 'value', 'ts_var': '2022-01-01T00:00:00+00:00', 'tsnodash_var': '20220101T000000', 'templates_dict': None}
[2022-01-24 03:38:29,635] {logging_mixin.py:109} INFO - ts:  2022-01-01 00:00:00+00:00
[2022-01-24 03:38:29,635] {logging_mixin.py:109} INFO - <class 'pandas._libs.tslibs.timestamps.Timestamp'>
[2022-01-24 03:38:29,635] {logging_mixin.py:109} INFO - Object created.
[2022-01-24 03:38:29,635] {logging_mixin.py:109} INFO - 2022 1 1
[2022-01-24 03:38:29,636] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-12.json
[2022-01-24 03:38:29,637] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-47.json
[2022-01-24 03:38:29,637] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-11.json
[2022-01-24 03:38:29,637] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-24.json
[2022-01-24 03:38:29,638] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-41.json
[2022-01-24 03:38:29,638] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-29.json
[2022-01-24 03:38:29,638] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-37.json
[2022-01-24 03:38:29,639] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-14.json
[2022-01-24 03:38:29,639] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-82.json
[2022-01-24 03:38:29,639] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-85.json
[2022-01-24 03:38:29,640] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-72.json
[2022-01-24 03:38:29,640] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-18.json
[2022-01-24 03:38:29,640] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-17.json
[2022-01-24 03:38:29,640] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-66.json
[2022-01-24 03:38:29,641] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-30.json
[2022-01-24 03:38:29,641] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-31.json
[2022-01-24 03:38:29,642] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-70.json
[2022-01-24 03:38:29,642] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-57.json
[2022-01-24 03:38:29,643] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-10.json
[2022-01-24 03:38:29,643] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-54.json
[2022-01-24 03:38:29,646] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-7.json
[2022-01-24 03:38:29,647] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-0.json
[2022-01-24 03:38:29,647] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-74.json
[2022-01-24 03:38:29,647] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-19.json
[2022-01-24 03:38:29,648] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-43.json
[2022-01-24 03:38:29,648] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-27.json
[2022-01-24 03:38:29,649] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-76.json
[2022-01-24 03:38:29,649] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-2.json
[2022-01-24 03:38:29,649] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-73.json
[2022-01-24 03:38:29,649] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-34.json
[2022-01-24 03:38:29,649] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-28.json
[2022-01-24 03:38:29,650] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-20.json
[2022-01-24 03:38:29,650] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-44.json
[2022-01-24 03:38:29,650] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-63.json
[2022-01-24 03:38:29,651] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-1.json
[2022-01-24 03:38:29,651] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-91.json
[2022-01-24 03:38:29,651] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-89.json
[2022-01-24 03:38:29,651] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-75.json
[2022-01-24 03:38:29,653] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-16.json
[2022-01-24 03:38:29,653] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-5.json
[2022-01-24 03:38:29,654] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-65.json
[2022-01-24 03:38:29,654] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-33.json
[2022-01-24 03:38:29,654] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-15.json
[2022-01-24 03:38:29,655] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-42.json
[2022-01-24 03:38:29,655] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-79.json
[2022-01-24 03:38:29,655] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-32.json
[2022-01-24 03:38:29,655] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-62.json
[2022-01-24 03:38:29,656] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-21.json
[2022-01-24 03:38:29,656] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-35.json
[2022-01-24 03:38:29,656] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-4.json
[2022-01-24 03:38:29,657] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-81.json
[2022-01-24 03:38:29,657] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-52.json
[2022-01-24 03:38:29,657] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-60.json
[2022-01-24 03:38:29,658] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-46.json
[2022-01-24 03:38:29,658] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-83.json
[2022-01-24 03:38:29,658] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-92.json
[2022-01-24 03:38:29,659] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-71.json
[2022-01-24 03:38:29,661] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-48.json
[2022-01-24 03:38:29,661] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-22.json
[2022-01-24 03:38:29,661] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-55.json
[2022-01-24 03:38:29,662] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-64.json
[2022-01-24 03:38:29,662] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-23.json
[2022-01-24 03:38:29,662] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-88.json
[2022-01-24 03:38:29,663] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-67.json
[2022-01-24 03:38:29,663] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-8.json
[2022-01-24 03:38:29,663] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-51.json
[2022-01-24 03:38:29,663] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-26.json
[2022-01-24 03:38:29,664] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-77.json
[2022-01-24 03:38:29,664] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-87.json
[2022-01-24 03:38:29,665] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-38.json
[2022-01-24 03:38:29,666] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-61.json
[2022-01-24 03:38:29,666] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-84.json
[2022-01-24 03:38:29,667] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-9.json
[2022-01-24 03:38:29,667] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-80.json
[2022-01-24 03:38:29,668] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-68.json
[2022-01-24 03:38:29,676] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-6.json
[2022-01-24 03:38:29,676] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-90.json
[2022-01-24 03:38:29,677] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-45.json
[2022-01-24 03:38:29,677] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-58.json
[2022-01-24 03:38:29,677] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-50.json
[2022-01-24 03:38:29,677] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-3.json
[2022-01-24 03:38:29,678] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-86.json
[2022-01-24 03:38:29,678] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-25.json
[2022-01-24 03:38:29,678] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-78.json
[2022-01-24 03:38:29,678] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-56.json
[2022-01-24 03:38:29,679] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-59.json
[2022-01-24 03:38:29,679] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-53.json
[2022-01-24 03:38:29,679] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-49.json
[2022-01-24 03:38:29,679] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-36.json
[2022-01-24 03:38:29,680] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-69.json
[2022-01-24 03:38:29,680] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-13.json
[2022-01-24 03:38:29,680] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-39.json
[2022-01-24 03:38:29,681] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-40.json
[2022-01-24 03:38:29,684] {logging_mixin.py:109} INFO - 93
[2022-01-24 03:38:29,713] {logging_mixin.py:109} INFO -      invoice_id    invoice_timestamp  customer_id  ...  qty is_discount       price
0    20220101-2  2022-01-01T10:50:31  zeytfvk2553  ...  165           1   8832.9780
1   20220101-51  2022-01-01T06:47:08  afxkwkm4444  ...  283           0  20336.3800
2   20220101-19  2022-01-01T02:05:18  kyeceqk1245  ...   35           0   2602.6000
3   20220101-30  2022-01-01T04:24:46  sexnidd1428  ...  193           0  17395.0900
4   20220101-46  2022-01-01T08:02:25  pejhuht3583  ...   37           1    169.5784
..          ...                  ...          ...  ...  ...         ...         ...
88  20220101-41  2022-01-01T11:56:00  lzoimgb3646  ...  140           1   4513.5860
89  20220101-71  2022-01-01T07:22:52  wziuxfs4826  ...  290           1  10276.2660
90  20220101-20  2022-01-01T06:48:47  ljjexgl5253  ...   31           1    627.0649
91  20220101-44  2022-01-01T15:41:47  kyeceqk1245  ...   56           0   4891.0400
92  20220101-45  2022-01-01T19:53:27  yyymlnv2864  ...   37           1    971.6163

[93 rows x 8 columns]
[2022-01-24 03:38:29,714] {taskinstance.py:1700} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1329, in _run_raw_task
    self._execute_task_with_callbacks(context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1455, in _execute_task_with_callbacks
    result = self._execute_task(context, self.task)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1511, in _execute_task
    result = execute_callable(context=context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 174, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 185, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/datawarehouse_airflow.py", line 52, in load_invoices
    invoice_df['invoice_date'] = datetime.datetime(year, month, day)
NameError: name 'year' is not defined
[2022-01-24 03:38:29,728] {taskinstance.py:1277} INFO - Marking task as FAILED. dag_id=datawarehouse_etl, task_id=load_invoices, execution_date=20220101T000000, start_date=20220124T033829, end_date=20220124T033829
[2022-01-24 03:38:29,745] {standard_task_runner.py:92} ERROR - Failed to execute job 57 for task load_invoices
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/task/task_runner/standard_task_runner.py", line 85, in _start_by_fork
    args.func(args, dag=self.dag)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/cli_parser.py", line 48, in command
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/cli.py", line 92, in wrapper
    return f(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/commands/task_command.py", line 298, in task_run
    _run_task_by_selected_method(args, dag, ti)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/commands/task_command.py", line 107, in _run_task_by_selected_method
    _run_raw_task(args, ti)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/cli/commands/task_command.py", line 184, in _run_raw_task
    error_file=args.error_file,
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/session.py", line 70, in wrapper
    return func(*args, session=session, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1329, in _run_raw_task
    self._execute_task_with_callbacks(context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1455, in _execute_task_with_callbacks
    result = self._execute_task(context, self.task)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1511, in _execute_task
    result = execute_callable(context=context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 174, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 185, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/datawarehouse_airflow.py", line 52, in load_invoices
    invoice_df['invoice_date'] = datetime.datetime(year, month, day)
NameError: name 'year' is not defined
[2022-01-24 03:38:29,756] {local_task_job.py:154} INFO - Task exited with return code 1
[2022-01-24 03:38:29,787] {local_task_job.py:264} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-01-24 03:52:29,257] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-01T00:00:00+00:00 [queued]>
[2022-01-24 03:52:29,268] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-01T00:00:00+00:00 [queued]>
[2022-01-24 03:52:29,268] {taskinstance.py:1238} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 03:52:29,269] {taskinstance.py:1239} INFO - Starting attempt 1 of 1
[2022-01-24 03:52:29,269] {taskinstance.py:1240} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 03:52:29,281] {taskinstance.py:1259} INFO - Executing <Task(PythonOperator): load_invoices> on 2022-01-01 00:00:00+00:00
[2022-01-24 03:52:29,287] {standard_task_runner.py:52} INFO - Started process 6059 to run task
[2022-01-24 03:52:29,290] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'datawarehouse_etl', 'load_invoices', 'scheduled__2022-01-01T00:00:00+00:00', '--job-id', '67', '--raw', '--subdir', 'DAGS_FOLDER/datawarehouse_***.py', '--cfg-path', '/tmp/tmpt08zsstc', '--error-file', '/tmp/tmpyq7z3_gg']
[2022-01-24 03:52:29,291] {standard_task_runner.py:77} INFO - Job 67: Subtask load_invoices
[2022-01-24 03:52:29,343] {logging_mixin.py:109} INFO - Running <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-01T00:00:00+00:00 [running]> on host cd9bb47288d1
[2022-01-24 03:52:29,427] {taskinstance.py:1426} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=datawarehouse_etl
AIRFLOW_CTX_TASK_ID=load_invoices
AIRFLOW_CTX_EXECUTION_DATE=2022-01-01T00:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-01-01T00:00:00+00:00
[2022-01-24 03:52:29,429] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:52:29,429] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:52:29,429] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds_nodash' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds_nodash }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:52:29,429] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_end' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:52:29,429] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:52:29,430] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:52:29,430] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:52:29,430] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date_success' from the template is deprecated and will be removed in a future version. Please use 'prev_data_interval_start_success' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:52:29,430] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:52:29,430] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:52:29,430] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:52:29,430] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 03:52:29,431] {logging_mixin.py:109} INFO - {'conf': <***.configuration.AirflowConfigParser object at 0x7f1e4dfc6a10>, 'dag': <DAG: datawarehouse_etl>, 'dag_run': <DagRun datawarehouse_etl @ 2022-01-01 00:00:00+00:00: scheduled__2022-01-01T00:00:00+00:00, externally triggered: False>, 'data_interval_end': DateTime(2022, 1, 2, 0, 0, 0, tzinfo=Timezone('UTC')), 'data_interval_start': DateTime(2022, 1, 1, 0, 0, 0, tzinfo=Timezone('UTC')), 'ds': '2022-01-01', 'ds_nodash': '20220101', 'execution_date': DateTime(2022, 1, 1, 0, 0, 0, tzinfo=Timezone('UTC')), 'inlets': [], 'logical_date': DateTime(2022, 1, 1, 0, 0, 0, tzinfo=Timezone('UTC')), 'macros': <module '***.macros' from '/home/***/.local/lib/python3.7/site-packages/***/macros/__init__.py'>, 'next_ds': '2022-01-02', 'next_ds_nodash': '20220102', 'next_execution_date': DateTime(2022, 1, 2, 0, 0, 0, tzinfo=Timezone('UTC')), 'outlets': [], 'params': {}, 'prev_data_interval_start_success': None, 'prev_data_interval_end_success': None, 'prev_ds': '2021-12-31', 'prev_ds_nodash': '20211231', 'prev_execution_date': datetime.datetime(2021, 12, 31, 0, 0, tzinfo=Timezone('UTC')), 'prev_execution_date_success': None, 'prev_start_date_success': None, 'run_id': 'scheduled__2022-01-01T00:00:00+00:00', 'task': <Task(PythonOperator): load_invoices>, 'task_instance': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-01T00:00:00+00:00 [running]>, 'task_instance_key_str': 'datawarehouse_etl__load_invoices__20220101', 'test_mode': False, 'ti': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-01T00:00:00+00:00 [running]>, 'tomorrow_ds': '2022-01-02', 'tomorrow_ds_nodash': '20220102', 'ts': '2022-01-01T00:00:00+00:00', 'ts_nodash': '20220101T000000', 'ts_nodash_with_tz': '20220101T000000+0000', 'var': {'json': None, 'value': None}, 'conn': None, 'yesterday_ds': '2021-12-31', 'yesterday_ds_nodash': '20211231', 'key': 'value', 'ts_var': '2022-01-01T00:00:00+00:00', 'tsnodash_var': '20220101T000000', 'templates_dict': None}
[2022-01-24 03:52:29,432] {logging_mixin.py:109} INFO - ts:  2022-01-01 00:00:00+00:00
[2022-01-24 03:52:29,432] {logging_mixin.py:109} INFO - <class 'pandas._libs.tslibs.timestamps.Timestamp'>
[2022-01-24 03:52:29,432] {logging_mixin.py:109} INFO - Object created.
[2022-01-24 03:52:29,432] {logging_mixin.py:109} INFO - 2022 1 1
[2022-01-24 03:52:29,434] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-12.json
[2022-01-24 03:52:29,435] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-47.json
[2022-01-24 03:52:29,435] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-11.json
[2022-01-24 03:52:29,435] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-24.json
[2022-01-24 03:52:29,436] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-41.json
[2022-01-24 03:52:29,436] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-29.json
[2022-01-24 03:52:29,436] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-37.json
[2022-01-24 03:52:29,436] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-14.json
[2022-01-24 03:52:29,436] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-82.json
[2022-01-24 03:52:29,436] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-85.json
[2022-01-24 03:52:29,436] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-72.json
[2022-01-24 03:52:29,436] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-18.json
[2022-01-24 03:52:29,437] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-17.json
[2022-01-24 03:52:29,437] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-66.json
[2022-01-24 03:52:29,437] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-30.json
[2022-01-24 03:52:29,437] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-31.json
[2022-01-24 03:52:29,437] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-70.json
[2022-01-24 03:52:29,437] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-57.json
[2022-01-24 03:52:29,437] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-10.json
[2022-01-24 03:52:29,438] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-54.json
[2022-01-24 03:52:29,438] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-7.json
[2022-01-24 03:52:29,438] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-0.json
[2022-01-24 03:52:29,438] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-74.json
[2022-01-24 03:52:29,438] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-19.json
[2022-01-24 03:52:29,438] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-43.json
[2022-01-24 03:52:29,438] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-27.json
[2022-01-24 03:52:29,438] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-76.json
[2022-01-24 03:52:29,439] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-2.json
[2022-01-24 03:52:29,439] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-73.json
[2022-01-24 03:52:29,439] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-34.json
[2022-01-24 03:52:29,439] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-28.json
[2022-01-24 03:52:29,439] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-20.json
[2022-01-24 03:52:29,439] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-44.json
[2022-01-24 03:52:29,439] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-63.json
[2022-01-24 03:52:29,439] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-1.json
[2022-01-24 03:52:29,440] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-91.json
[2022-01-24 03:52:29,440] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-89.json
[2022-01-24 03:52:29,440] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-75.json
[2022-01-24 03:52:29,440] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-16.json
[2022-01-24 03:52:29,440] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-5.json
[2022-01-24 03:52:29,440] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-65.json
[2022-01-24 03:52:29,440] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-33.json
[2022-01-24 03:52:29,440] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-15.json
[2022-01-24 03:52:29,441] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-42.json
[2022-01-24 03:52:29,441] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-79.json
[2022-01-24 03:52:29,441] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-32.json
[2022-01-24 03:52:29,441] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-62.json
[2022-01-24 03:52:29,441] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-21.json
[2022-01-24 03:52:29,441] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-35.json
[2022-01-24 03:52:29,441] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-4.json
[2022-01-24 03:52:29,441] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-81.json
[2022-01-24 03:52:29,442] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-52.json
[2022-01-24 03:52:29,442] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-60.json
[2022-01-24 03:52:29,442] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-46.json
[2022-01-24 03:52:29,442] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-83.json
[2022-01-24 03:52:29,442] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-92.json
[2022-01-24 03:52:29,442] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-71.json
[2022-01-24 03:52:29,442] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-48.json
[2022-01-24 03:52:29,442] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-22.json
[2022-01-24 03:52:29,443] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-55.json
[2022-01-24 03:52:29,443] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-64.json
[2022-01-24 03:52:29,443] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-23.json
[2022-01-24 03:52:29,443] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-88.json
[2022-01-24 03:52:29,443] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-67.json
[2022-01-24 03:52:29,443] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-8.json
[2022-01-24 03:52:29,443] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-51.json
[2022-01-24 03:52:29,443] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-26.json
[2022-01-24 03:52:29,444] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-77.json
[2022-01-24 03:52:29,444] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-87.json
[2022-01-24 03:52:29,444] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-38.json
[2022-01-24 03:52:29,444] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-61.json
[2022-01-24 03:52:29,444] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-84.json
[2022-01-24 03:52:29,444] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-9.json
[2022-01-24 03:52:29,444] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-80.json
[2022-01-24 03:52:29,444] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-68.json
[2022-01-24 03:52:29,445] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-6.json
[2022-01-24 03:52:29,445] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-90.json
[2022-01-24 03:52:29,445] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-45.json
[2022-01-24 03:52:29,445] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-58.json
[2022-01-24 03:52:29,445] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-50.json
[2022-01-24 03:52:29,445] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-3.json
[2022-01-24 03:52:29,445] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-86.json
[2022-01-24 03:52:29,445] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-25.json
[2022-01-24 03:52:29,446] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-78.json
[2022-01-24 03:52:29,446] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-56.json
[2022-01-24 03:52:29,446] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-59.json
[2022-01-24 03:52:29,446] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-53.json
[2022-01-24 03:52:29,446] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-49.json
[2022-01-24 03:52:29,446] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-36.json
[2022-01-24 03:52:29,446] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-69.json
[2022-01-24 03:52:29,446] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-13.json
[2022-01-24 03:52:29,447] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-39.json
[2022-01-24 03:52:29,447] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-40.json
[2022-01-24 03:52:29,449] {logging_mixin.py:109} INFO - 93
[2022-01-24 03:52:29,479] {logging_mixin.py:109} INFO -      invoice_id    invoice_timestamp  customer_id  ...  qty is_discount       price
0    20220101-2  2022-01-01T10:50:31  zeytfvk2553  ...  165           1   8832.9780
1   20220101-51  2022-01-01T06:47:08  afxkwkm4444  ...  283           0  20336.3800
2   20220101-19  2022-01-01T02:05:18  kyeceqk1245  ...   35           0   2602.6000
3   20220101-30  2022-01-01T04:24:46  sexnidd1428  ...  193           0  17395.0900
4   20220101-46  2022-01-01T08:02:25  pejhuht3583  ...   37           1    169.5784
..          ...                  ...          ...  ...  ...         ...         ...
88  20220101-41  2022-01-01T11:56:00  lzoimgb3646  ...  140           1   4513.5860
89  20220101-71  2022-01-01T07:22:52  wziuxfs4826  ...  290           1  10276.2660
90  20220101-20  2022-01-01T06:48:47  ljjexgl5253  ...   31           1    627.0649
91  20220101-44  2022-01-01T15:41:47  kyeceqk1245  ...   56           0   4891.0400
92  20220101-45  2022-01-01T19:53:27  yyymlnv2864  ...   37           1    971.6163

[93 rows x 8 columns]
[2022-01-24 03:52:29,491] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: sales_dw, Login: awsuser, Password: ***, extra: {}
[2022-01-24 03:52:29,498] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: sales_dw, Login: awsuser, Password: ***, extra: {}
[2022-01-24 03:52:42,931] {python.py:175} INFO - Done. Returned value was: None
[2022-01-24 03:52:42,950] {taskinstance.py:1277} INFO - Marking task as SUCCESS. dag_id=datawarehouse_etl, task_id=load_invoices, execution_date=20220101T000000, start_date=20220124T035229, end_date=20220124T035242
[2022-01-24 03:52:43,023] {local_task_job.py:154} INFO - Task exited with return code 0
[2022-01-24 03:52:43,048] {local_task_job.py:264} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2022-01-24 18:16:57,267] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-01T00:00:00+00:00 [queued]>
[2022-01-24 18:16:57,278] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-01T00:00:00+00:00 [queued]>
[2022-01-24 18:16:57,278] {taskinstance.py:1238} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 18:16:57,278] {taskinstance.py:1239} INFO - Starting attempt 1 of 1
[2022-01-24 18:16:57,278] {taskinstance.py:1240} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 18:16:57,292] {taskinstance.py:1259} INFO - Executing <Task(PythonOperator): load_invoices> on 2022-01-01 00:00:00+00:00
[2022-01-24 18:16:57,297] {standard_task_runner.py:52} INFO - Started process 2389 to run task
[2022-01-24 18:16:57,300] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'datawarehouse_etl', 'load_invoices', 'scheduled__2022-01-01T00:00:00+00:00', '--job-id', '121', '--raw', '--subdir', 'DAGS_FOLDER/datawarehouse_***.py', '--cfg-path', '/tmp/tmpa2legxsl', '--error-file', '/tmp/tmpxa1t_9hx']
[2022-01-24 18:16:57,301] {standard_task_runner.py:77} INFO - Job 121: Subtask load_invoices
[2022-01-24 18:16:57,357] {logging_mixin.py:109} INFO - Running <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-01T00:00:00+00:00 [running]> on host cd9bb47288d1
[2022-01-24 18:16:57,422] {taskinstance.py:1426} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=datawarehouse_etl
AIRFLOW_CTX_TASK_ID=load_invoices
AIRFLOW_CTX_EXECUTION_DATE=2022-01-01T00:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-01-01T00:00:00+00:00
[2022-01-24 18:16:57,425] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:16:57,425] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:16:57,426] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds_nodash' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds_nodash }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:16:57,426] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_end' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:16:57,426] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:16:57,426] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:16:57,426] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:16:57,426] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date_success' from the template is deprecated and will be removed in a future version. Please use 'prev_data_interval_start_success' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:16:57,426] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:16:57,426] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:16:57,426] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:16:57,426] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:16:57,427] {logging_mixin.py:109} INFO - {'conf': <***.configuration.AirflowConfigParser object at 0x7f76fb23ca90>, 'dag': <DAG: datawarehouse_etl>, 'dag_run': <DagRun datawarehouse_etl @ 2022-01-01 00:00:00+00:00: scheduled__2022-01-01T00:00:00+00:00, externally triggered: False>, 'data_interval_end': DateTime(2022, 1, 2, 0, 0, 0, tzinfo=Timezone('UTC')), 'data_interval_start': DateTime(2022, 1, 1, 0, 0, 0, tzinfo=Timezone('UTC')), 'ds': '2022-01-01', 'ds_nodash': '20220101', 'execution_date': DateTime(2022, 1, 1, 0, 0, 0, tzinfo=Timezone('UTC')), 'inlets': [], 'logical_date': DateTime(2022, 1, 1, 0, 0, 0, tzinfo=Timezone('UTC')), 'macros': <module '***.macros' from '/home/***/.local/lib/python3.7/site-packages/***/macros/__init__.py'>, 'next_ds': '2022-01-02', 'next_ds_nodash': '20220102', 'next_execution_date': DateTime(2022, 1, 2, 0, 0, 0, tzinfo=Timezone('UTC')), 'outlets': [], 'params': {}, 'prev_data_interval_start_success': None, 'prev_data_interval_end_success': None, 'prev_ds': '2021-12-31', 'prev_ds_nodash': '20211231', 'prev_execution_date': datetime.datetime(2021, 12, 31, 0, 0, tzinfo=Timezone('UTC')), 'prev_execution_date_success': None, 'prev_start_date_success': None, 'run_id': 'scheduled__2022-01-01T00:00:00+00:00', 'task': <Task(PythonOperator): load_invoices>, 'task_instance': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-01T00:00:00+00:00 [running]>, 'task_instance_key_str': 'datawarehouse_etl__load_invoices__20220101', 'test_mode': False, 'ti': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-01T00:00:00+00:00 [running]>, 'tomorrow_ds': '2022-01-02', 'tomorrow_ds_nodash': '20220102', 'ts': '2022-01-01T00:00:00+00:00', 'ts_nodash': '20220101T000000', 'ts_nodash_with_tz': '20220101T000000+0000', 'var': {'json': None, 'value': None}, 'conn': None, 'yesterday_ds': '2021-12-31', 'yesterday_ds_nodash': '20211231', 'key': 'value', 'ts_var': '2022-01-01T00:00:00+00:00', 'tsnodash_var': '20220101T000000', 'templates_dict': None}
[2022-01-24 18:16:57,428] {logging_mixin.py:109} INFO - ts:  2022-01-01 00:00:00+00:00
[2022-01-24 18:16:57,428] {logging_mixin.py:109} INFO - <class 'pandas._libs.tslibs.timestamps.Timestamp'>
[2022-01-24 18:16:57,428] {logging_mixin.py:109} INFO - Object created.
[2022-01-24 18:16:57,428] {logging_mixin.py:109} INFO - 2022 1 1
[2022-01-24 18:16:57,429] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-12.json
[2022-01-24 18:16:57,429] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-47.json
[2022-01-24 18:16:57,430] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-11.json
[2022-01-24 18:16:57,430] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-24.json
[2022-01-24 18:16:57,430] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-41.json
[2022-01-24 18:16:57,430] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-29.json
[2022-01-24 18:16:57,431] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-37.json
[2022-01-24 18:16:57,431] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-14.json
[2022-01-24 18:16:57,432] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-18.json
[2022-01-24 18:16:57,432] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-17.json
[2022-01-24 18:16:57,432] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-66.json
[2022-01-24 18:16:57,433] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-30.json
[2022-01-24 18:16:57,433] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-31.json
[2022-01-24 18:16:57,434] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-70.json
[2022-01-24 18:16:57,435] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-57.json
[2022-01-24 18:16:57,436] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-10.json
[2022-01-24 18:16:57,437] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-54.json
[2022-01-24 18:16:57,438] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-7.json
[2022-01-24 18:16:57,439] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-0.json
[2022-01-24 18:16:57,440] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-19.json
[2022-01-24 18:16:57,441] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-43.json
[2022-01-24 18:16:57,441] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-27.json
[2022-01-24 18:16:57,441] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-2.json
[2022-01-24 18:16:57,442] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-34.json
[2022-01-24 18:16:57,442] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-28.json
[2022-01-24 18:16:57,443] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-20.json
[2022-01-24 18:16:57,443] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-44.json
[2022-01-24 18:16:57,443] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-63.json
[2022-01-24 18:16:57,443] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-1.json
[2022-01-24 18:16:57,444] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-16.json
[2022-01-24 18:16:57,444] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-5.json
[2022-01-24 18:16:57,444] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-65.json
[2022-01-24 18:16:57,445] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-33.json
[2022-01-24 18:16:57,445] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-15.json
[2022-01-24 18:16:57,445] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-42.json
[2022-01-24 18:16:57,446] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-32.json
[2022-01-24 18:16:57,446] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-62.json
[2022-01-24 18:16:57,446] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-21.json
[2022-01-24 18:16:57,446] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-35.json
[2022-01-24 18:16:57,447] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-4.json
[2022-01-24 18:16:57,447] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-52.json
[2022-01-24 18:16:57,447] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-60.json
[2022-01-24 18:16:57,448] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-46.json
[2022-01-24 18:16:57,448] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-48.json
[2022-01-24 18:16:57,448] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-22.json
[2022-01-24 18:16:57,449] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-55.json
[2022-01-24 18:16:57,449] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-64.json
[2022-01-24 18:16:57,450] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-23.json
[2022-01-24 18:16:57,450] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-67.json
[2022-01-24 18:16:57,450] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-8.json
[2022-01-24 18:16:57,452] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-51.json
[2022-01-24 18:16:57,453] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-26.json
[2022-01-24 18:16:57,454] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-38.json
[2022-01-24 18:16:57,455] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-61.json
[2022-01-24 18:16:57,456] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-9.json
[2022-01-24 18:16:57,456] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-68.json
[2022-01-24 18:16:57,457] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-6.json
[2022-01-24 18:16:57,457] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-45.json
[2022-01-24 18:16:57,457] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-58.json
[2022-01-24 18:16:57,457] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-50.json
[2022-01-24 18:16:57,458] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-3.json
[2022-01-24 18:16:57,458] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-25.json
[2022-01-24 18:16:57,458] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-56.json
[2022-01-24 18:16:57,459] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-59.json
[2022-01-24 18:16:57,459] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-53.json
[2022-01-24 18:16:57,459] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-49.json
[2022-01-24 18:16:57,460] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-36.json
[2022-01-24 18:16:57,460] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-69.json
[2022-01-24 18:16:57,460] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-13.json
[2022-01-24 18:16:57,461] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-39.json
[2022-01-24 18:16:57,461] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-40.json
[2022-01-24 18:16:57,463] {logging_mixin.py:109} INFO - 71
[2022-01-24 18:16:57,491] {logging_mixin.py:109} INFO -      invoice_id    invoice_timestamp  customer_id  ...  qty is_discount       price
0    20220101-2  2022-01-01T21:28:17  swibheb5634  ...  267           1    733.0752
1   20220101-51  2022-01-01T21:53:00  svzgllt5401  ...   29           0   1765.8100
2   20220101-19  2022-01-01T21:50:10  nottbgn4122  ...  282           1   1629.1704
3   20220101-30  2022-01-01T11:07:24  uhbbqdu3616  ...  292           0  15768.0000
4   20220101-46  2022-01-01T22:26:16  nottbgn4122  ...  232           1  12745.1520
..          ...                  ...          ...  ...  ...         ...         ...
66  20220101-41  2022-01-01T03:56:36  hveyiwh2729  ...  208           0  17636.3200
67   20220101-8  2022-01-01T20:25:59  qvzhnwd1344  ...  272           1   4973.5200
68  20220101-20  2022-01-01T13:05:22  raanvkb5566  ...   23           1     61.2352
69  20220101-44  2022-01-01T10:04:56  qfyxyiq3514  ...   96           0   6592.3200
70  20220101-45  2022-01-01T16:44:29  zxzvhxj2519  ...  191           0    794.5600

[71 rows x 8 columns]
[2022-01-24 18:16:57,503] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: sales_dw, Login: awsuser, Password: ***, extra: {}
[2022-01-24 18:16:57,509] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: sales_dw, Login: awsuser, Password: ***, extra: {}
[2022-01-24 18:17:12,796] {python.py:175} INFO - Done. Returned value was: None
[2022-01-24 18:17:12,811] {taskinstance.py:1277} INFO - Marking task as SUCCESS. dag_id=datawarehouse_etl, task_id=load_invoices, execution_date=20220101T000000, start_date=20220124T181657, end_date=20220124T181712
[2022-01-24 18:17:12,834] {local_task_job.py:154} INFO - Task exited with return code 0
[2022-01-24 18:17:12,863] {local_task_job.py:264} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2022-01-24 18:40:50,425] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-01T00:00:00+00:00 [queued]>
[2022-01-24 18:40:50,447] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-01T00:00:00+00:00 [queued]>
[2022-01-24 18:40:50,447] {taskinstance.py:1238} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 18:40:50,448] {taskinstance.py:1239} INFO - Starting attempt 1 of 1
[2022-01-24 18:40:50,448] {taskinstance.py:1240} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 18:40:50,480] {taskinstance.py:1259} INFO - Executing <Task(PythonOperator): load_invoices> on 2022-01-01 00:00:00+00:00
[2022-01-24 18:40:50,497] {standard_task_runner.py:52} INFO - Started process 3497 to run task
[2022-01-24 18:40:50,501] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'datawarehouse_etl', 'load_invoices', 'scheduled__2022-01-01T00:00:00+00:00', '--job-id', '129', '--raw', '--subdir', 'DAGS_FOLDER/datawarehouse_***.py', '--cfg-path', '/tmp/tmpoosqgel3', '--error-file', '/tmp/tmpxegpa3en']
[2022-01-24 18:40:50,502] {standard_task_runner.py:77} INFO - Job 129: Subtask load_invoices
[2022-01-24 18:40:50,584] {logging_mixin.py:109} INFO - Running <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-01T00:00:00+00:00 [running]> on host cd9bb47288d1
[2022-01-24 18:40:50,673] {taskinstance.py:1426} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=datawarehouse_etl
AIRFLOW_CTX_TASK_ID=load_invoices
AIRFLOW_CTX_EXECUTION_DATE=2022-01-01T00:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-01-01T00:00:00+00:00
[2022-01-24 18:40:50,677] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:40:50,677] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:40:50,678] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds_nodash' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds_nodash }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:40:50,678] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_end' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:40:50,678] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:40:50,678] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:40:50,678] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:40:50,678] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date_success' from the template is deprecated and will be removed in a future version. Please use 'prev_data_interval_start_success' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:40:50,678] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:40:50,678] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:40:50,678] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:40:50,678] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:40:50,679] {logging_mixin.py:109} INFO - {'conf': <***.configuration.AirflowConfigParser object at 0x7f76fb23ca90>, 'dag': <DAG: datawarehouse_etl>, 'dag_run': <DagRun datawarehouse_etl @ 2022-01-01 00:00:00+00:00: scheduled__2022-01-01T00:00:00+00:00, externally triggered: False>, 'data_interval_end': DateTime(2022, 1, 2, 0, 0, 0, tzinfo=Timezone('UTC')), 'data_interval_start': DateTime(2022, 1, 1, 0, 0, 0, tzinfo=Timezone('UTC')), 'ds': '2022-01-01', 'ds_nodash': '20220101', 'execution_date': DateTime(2022, 1, 1, 0, 0, 0, tzinfo=Timezone('UTC')), 'inlets': [], 'logical_date': DateTime(2022, 1, 1, 0, 0, 0, tzinfo=Timezone('UTC')), 'macros': <module '***.macros' from '/home/***/.local/lib/python3.7/site-packages/***/macros/__init__.py'>, 'next_ds': '2022-01-02', 'next_ds_nodash': '20220102', 'next_execution_date': DateTime(2022, 1, 2, 0, 0, 0, tzinfo=Timezone('UTC')), 'outlets': [], 'params': {}, 'prev_data_interval_start_success': None, 'prev_data_interval_end_success': None, 'prev_ds': '2021-12-31', 'prev_ds_nodash': '20211231', 'prev_execution_date': datetime.datetime(2021, 12, 31, 0, 0, tzinfo=Timezone('UTC')), 'prev_execution_date_success': None, 'prev_start_date_success': None, 'run_id': 'scheduled__2022-01-01T00:00:00+00:00', 'task': <Task(PythonOperator): load_invoices>, 'task_instance': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-01T00:00:00+00:00 [running]>, 'task_instance_key_str': 'datawarehouse_etl__load_invoices__20220101', 'test_mode': False, 'ti': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-01T00:00:00+00:00 [running]>, 'tomorrow_ds': '2022-01-02', 'tomorrow_ds_nodash': '20220102', 'ts': '2022-01-01T00:00:00+00:00', 'ts_nodash': '20220101T000000', 'ts_nodash_with_tz': '20220101T000000+0000', 'var': {'json': None, 'value': None}, 'conn': None, 'yesterday_ds': '2021-12-31', 'yesterday_ds_nodash': '20211231', 'key': 'value', 'ts_var': '2022-01-01T00:00:00+00:00', 'tsnodash_var': '20220101T000000', 'templates_dict': None}
[2022-01-24 18:40:50,680] {logging_mixin.py:109} INFO - ts:  2022-01-01 00:00:00+00:00
[2022-01-24 18:40:50,680] {logging_mixin.py:109} INFO - <class 'pandas._libs.tslibs.timestamps.Timestamp'>
[2022-01-24 18:40:50,680] {logging_mixin.py:109} INFO - Object created.
[2022-01-24 18:40:50,680] {logging_mixin.py:109} INFO - 2022 1 1
[2022-01-24 18:40:50,681] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-12.json
[2022-01-24 18:40:50,682] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-47.json
[2022-01-24 18:40:50,683] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-11.json
[2022-01-24 18:40:50,683] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-24.json
[2022-01-24 18:40:50,684] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-41.json
[2022-01-24 18:40:50,685] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-29.json
[2022-01-24 18:40:50,685] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-37.json
[2022-01-24 18:40:50,686] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-14.json
[2022-01-24 18:40:50,687] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-18.json
[2022-01-24 18:40:50,688] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-17.json
[2022-01-24 18:40:50,689] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-66.json
[2022-01-24 18:40:50,690] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-30.json
[2022-01-24 18:40:50,691] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-31.json
[2022-01-24 18:40:50,691] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-70.json
[2022-01-24 18:40:50,692] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-57.json
[2022-01-24 18:40:50,692] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-10.json
[2022-01-24 18:40:50,693] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-54.json
[2022-01-24 18:40:50,693] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-7.json
[2022-01-24 18:40:50,694] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-0.json
[2022-01-24 18:40:50,694] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-19.json
[2022-01-24 18:40:50,694] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-43.json
[2022-01-24 18:40:50,695] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-27.json
[2022-01-24 18:40:50,696] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-2.json
[2022-01-24 18:40:50,696] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-34.json
[2022-01-24 18:40:50,697] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-28.json
[2022-01-24 18:40:50,698] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-20.json
[2022-01-24 18:40:50,698] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-44.json
[2022-01-24 18:40:50,699] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-63.json
[2022-01-24 18:40:50,700] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-1.json
[2022-01-24 18:40:50,701] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-16.json
[2022-01-24 18:40:50,701] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-5.json
[2022-01-24 18:40:50,704] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-65.json
[2022-01-24 18:40:50,705] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-33.json
[2022-01-24 18:40:50,707] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-15.json
[2022-01-24 18:40:50,709] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-42.json
[2022-01-24 18:40:50,709] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-32.json
[2022-01-24 18:40:50,710] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-62.json
[2022-01-24 18:40:50,710] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-21.json
[2022-01-24 18:40:50,711] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-35.json
[2022-01-24 18:40:50,711] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-4.json
[2022-01-24 18:40:50,712] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-52.json
[2022-01-24 18:40:50,712] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-60.json
[2022-01-24 18:40:50,712] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-46.json
[2022-01-24 18:40:50,713] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-48.json
[2022-01-24 18:40:50,713] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-22.json
[2022-01-24 18:40:50,713] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-55.json
[2022-01-24 18:40:50,714] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-64.json
[2022-01-24 18:40:50,714] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-23.json
[2022-01-24 18:40:50,714] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-67.json
[2022-01-24 18:40:50,714] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-8.json
[2022-01-24 18:40:50,715] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-51.json
[2022-01-24 18:40:50,716] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-26.json
[2022-01-24 18:40:50,716] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-38.json
[2022-01-24 18:40:50,716] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-61.json
[2022-01-24 18:40:50,717] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-9.json
[2022-01-24 18:40:50,717] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-68.json
[2022-01-24 18:40:50,718] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-6.json
[2022-01-24 18:40:50,718] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-45.json
[2022-01-24 18:40:50,718] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-58.json
[2022-01-24 18:40:50,719] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-50.json
[2022-01-24 18:40:50,719] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-3.json
[2022-01-24 18:40:50,720] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-25.json
[2022-01-24 18:40:50,721] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-56.json
[2022-01-24 18:40:50,722] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-59.json
[2022-01-24 18:40:50,723] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-53.json
[2022-01-24 18:40:50,724] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-49.json
[2022-01-24 18:40:50,725] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-36.json
[2022-01-24 18:40:50,725] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-69.json
[2022-01-24 18:40:50,726] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-13.json
[2022-01-24 18:40:50,726] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-39.json
[2022-01-24 18:40:50,727] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-40.json
[2022-01-24 18:40:50,733] {logging_mixin.py:109} INFO - 71
[2022-01-24 18:40:50,768] {logging_mixin.py:109} INFO -      invoice_id    invoice_timestamp  customer_id  ...  qty is_discount       price
0    20220101-2  2022-01-01T21:28:17  swibheb5634  ...  267           1    733.0752
1   20220101-51  2022-01-01T21:53:00  svzgllt5401  ...   29           0   1765.8100
2   20220101-19  2022-01-01T21:50:10  nottbgn4122  ...  282           1   1629.1704
3   20220101-30  2022-01-01T11:07:24  uhbbqdu3616  ...  292           0  15768.0000
4   20220101-46  2022-01-01T22:26:16  nottbgn4122  ...  232           1  12745.1520
..          ...                  ...          ...  ...  ...         ...         ...
66  20220101-41  2022-01-01T03:56:36  hveyiwh2729  ...  208           0  17636.3200
67   20220101-8  2022-01-01T20:25:59  qvzhnwd1344  ...  272           1   4973.5200
68  20220101-20  2022-01-01T13:05:22  raanvkb5566  ...   23           1     61.2352
69  20220101-44  2022-01-01T10:04:56  qfyxyiq3514  ...   96           0   6592.3200
70  20220101-45  2022-01-01T16:44:29  zxzvhxj2519  ...  191           0    794.5600

[71 rows x 8 columns]
[2022-01-24 18:40:50,787] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: sales_dw, Login: awsuser, Password: ***, extra: {}
[2022-01-24 18:40:50,800] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: sales_dw, Login: awsuser, Password: ***, extra: {}
[2022-01-24 18:41:07,786] {python.py:175} INFO - Done. Returned value was: None
[2022-01-24 18:41:07,796] {taskinstance.py:1277} INFO - Marking task as SUCCESS. dag_id=datawarehouse_etl, task_id=load_invoices, execution_date=20220101T000000, start_date=20220124T184050, end_date=20220124T184107
[2022-01-24 18:41:07,838] {local_task_job.py:154} INFO - Task exited with return code 0
[2022-01-24 18:41:07,868] {local_task_job.py:264} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2022-01-24 18:41:52,523] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-01T00:00:00+00:00 [queued]>
[2022-01-24 18:41:52,535] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-01T00:00:00+00:00 [queued]>
[2022-01-24 18:41:52,535] {taskinstance.py:1238} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 18:41:52,535] {taskinstance.py:1239} INFO - Starting attempt 1 of 1
[2022-01-24 18:41:52,535] {taskinstance.py:1240} INFO - 
--------------------------------------------------------------------------------
[2022-01-24 18:41:52,553] {taskinstance.py:1259} INFO - Executing <Task(PythonOperator): load_invoices> on 2022-01-01 00:00:00+00:00
[2022-01-24 18:41:52,561] {standard_task_runner.py:52} INFO - Started process 3561 to run task
[2022-01-24 18:41:52,565] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'datawarehouse_etl', 'load_invoices', 'scheduled__2022-01-01T00:00:00+00:00', '--job-id', '135', '--raw', '--subdir', 'DAGS_FOLDER/datawarehouse_***.py', '--cfg-path', '/tmp/tmp15_5iuot', '--error-file', '/tmp/tmp69w7uec6']
[2022-01-24 18:41:52,566] {standard_task_runner.py:77} INFO - Job 135: Subtask load_invoices
[2022-01-24 18:41:52,619] {logging_mixin.py:109} INFO - Running <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-01T00:00:00+00:00 [running]> on host cd9bb47288d1
[2022-01-24 18:41:52,678] {taskinstance.py:1426} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=datawarehouse_etl
AIRFLOW_CTX_TASK_ID=load_invoices
AIRFLOW_CTX_EXECUTION_DATE=2022-01-01T00:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-01-01T00:00:00+00:00
[2022-01-24 18:41:52,679] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:41:52,680] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:41:52,680] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_ds_nodash' from the template is deprecated and will be removed in a future version. Please use '{{ data_interval_end | ds_nodash }}' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:41:52,680] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'next_execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_end' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:41:52,680] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:41:52,680] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:41:52,680] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:41:52,680] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'prev_execution_date_success' from the template is deprecated and will be removed in a future version. Please use 'prev_data_interval_start_success' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:41:52,681] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:41:52,681] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'tomorrow_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:41:52,681] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:41:52,681] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'yesterday_ds_nodash' from the template is deprecated and will be removed in a future version.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2022-01-24 18:41:52,681] {logging_mixin.py:109} INFO - {'conf': <***.configuration.AirflowConfigParser object at 0x7f76fb23ca90>, 'dag': <DAG: datawarehouse_etl>, 'dag_run': <DagRun datawarehouse_etl @ 2022-01-01 00:00:00+00:00: scheduled__2022-01-01T00:00:00+00:00, externally triggered: False>, 'data_interval_end': DateTime(2022, 1, 2, 0, 0, 0, tzinfo=Timezone('UTC')), 'data_interval_start': DateTime(2022, 1, 1, 0, 0, 0, tzinfo=Timezone('UTC')), 'ds': '2022-01-01', 'ds_nodash': '20220101', 'execution_date': DateTime(2022, 1, 1, 0, 0, 0, tzinfo=Timezone('UTC')), 'inlets': [], 'logical_date': DateTime(2022, 1, 1, 0, 0, 0, tzinfo=Timezone('UTC')), 'macros': <module '***.macros' from '/home/***/.local/lib/python3.7/site-packages/***/macros/__init__.py'>, 'next_ds': '2022-01-02', 'next_ds_nodash': '20220102', 'next_execution_date': DateTime(2022, 1, 2, 0, 0, 0, tzinfo=Timezone('UTC')), 'outlets': [], 'params': {}, 'prev_data_interval_start_success': None, 'prev_data_interval_end_success': None, 'prev_ds': '2021-12-31', 'prev_ds_nodash': '20211231', 'prev_execution_date': datetime.datetime(2021, 12, 31, 0, 0, tzinfo=Timezone('UTC')), 'prev_execution_date_success': None, 'prev_start_date_success': None, 'run_id': 'scheduled__2022-01-01T00:00:00+00:00', 'task': <Task(PythonOperator): load_invoices>, 'task_instance': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-01T00:00:00+00:00 [running]>, 'task_instance_key_str': 'datawarehouse_etl__load_invoices__20220101', 'test_mode': False, 'ti': <TaskInstance: datawarehouse_etl.load_invoices scheduled__2022-01-01T00:00:00+00:00 [running]>, 'tomorrow_ds': '2022-01-02', 'tomorrow_ds_nodash': '20220102', 'ts': '2022-01-01T00:00:00+00:00', 'ts_nodash': '20220101T000000', 'ts_nodash_with_tz': '20220101T000000+0000', 'var': {'json': None, 'value': None}, 'conn': None, 'yesterday_ds': '2021-12-31', 'yesterday_ds_nodash': '20211231', 'key': 'value', 'ts_var': '2022-01-01T00:00:00+00:00', 'tsnodash_var': '20220101T000000', 'templates_dict': None}
[2022-01-24 18:41:52,683] {logging_mixin.py:109} INFO - ts:  2022-01-01 00:00:00+00:00
[2022-01-24 18:41:52,683] {logging_mixin.py:109} INFO - <class 'pandas._libs.tslibs.timestamps.Timestamp'>
[2022-01-24 18:41:52,683] {logging_mixin.py:109} INFO - Object created.
[2022-01-24 18:41:52,683] {logging_mixin.py:109} INFO - 2022 1 1
[2022-01-24 18:41:52,684] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-12.json
[2022-01-24 18:41:52,685] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-47.json
[2022-01-24 18:41:52,685] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-11.json
[2022-01-24 18:41:52,685] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-24.json
[2022-01-24 18:41:52,685] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-41.json
[2022-01-24 18:41:52,685] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-29.json
[2022-01-24 18:41:52,685] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-37.json
[2022-01-24 18:41:52,686] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-14.json
[2022-01-24 18:41:52,686] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-18.json
[2022-01-24 18:41:52,686] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-17.json
[2022-01-24 18:41:52,686] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-66.json
[2022-01-24 18:41:52,686] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-30.json
[2022-01-24 18:41:52,686] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-31.json
[2022-01-24 18:41:52,687] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-70.json
[2022-01-24 18:41:52,687] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-57.json
[2022-01-24 18:41:52,687] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-10.json
[2022-01-24 18:41:52,687] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-54.json
[2022-01-24 18:41:52,687] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-7.json
[2022-01-24 18:41:52,687] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-0.json
[2022-01-24 18:41:52,687] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-19.json
[2022-01-24 18:41:52,687] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-43.json
[2022-01-24 18:41:52,688] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-27.json
[2022-01-24 18:41:52,688] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-2.json
[2022-01-24 18:41:52,688] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-34.json
[2022-01-24 18:41:52,688] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-28.json
[2022-01-24 18:41:52,688] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-20.json
[2022-01-24 18:41:52,688] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-44.json
[2022-01-24 18:41:52,688] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-63.json
[2022-01-24 18:41:52,689] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-1.json
[2022-01-24 18:41:52,689] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-16.json
[2022-01-24 18:41:52,689] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-5.json
[2022-01-24 18:41:52,689] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-65.json
[2022-01-24 18:41:52,689] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-33.json
[2022-01-24 18:41:52,689] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-15.json
[2022-01-24 18:41:52,689] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-42.json
[2022-01-24 18:41:52,689] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-32.json
[2022-01-24 18:41:52,690] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-62.json
[2022-01-24 18:41:52,690] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-21.json
[2022-01-24 18:41:52,690] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-35.json
[2022-01-24 18:41:52,690] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-4.json
[2022-01-24 18:41:52,690] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-52.json
[2022-01-24 18:41:52,690] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-60.json
[2022-01-24 18:41:52,690] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-46.json
[2022-01-24 18:41:52,691] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-48.json
[2022-01-24 18:41:52,691] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-22.json
[2022-01-24 18:41:52,691] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-55.json
[2022-01-24 18:41:52,691] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-64.json
[2022-01-24 18:41:52,691] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-23.json
[2022-01-24 18:41:52,691] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-67.json
[2022-01-24 18:41:52,691] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-8.json
[2022-01-24 18:41:52,692] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-51.json
[2022-01-24 18:41:52,692] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-26.json
[2022-01-24 18:41:52,692] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-38.json
[2022-01-24 18:41:52,692] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-61.json
[2022-01-24 18:41:52,692] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-9.json
[2022-01-24 18:41:52,692] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-68.json
[2022-01-24 18:41:52,693] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-6.json
[2022-01-24 18:41:52,693] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-45.json
[2022-01-24 18:41:52,693] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-58.json
[2022-01-24 18:41:52,693] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-50.json
[2022-01-24 18:41:52,693] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-3.json
[2022-01-24 18:41:52,693] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-25.json
[2022-01-24 18:41:52,693] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-56.json
[2022-01-24 18:41:52,693] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-59.json
[2022-01-24 18:41:52,694] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-53.json
[2022-01-24 18:41:52,694] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-49.json
[2022-01-24 18:41:52,694] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-36.json
[2022-01-24 18:41:52,694] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-69.json
[2022-01-24 18:41:52,694] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-13.json
[2022-01-24 18:41:52,694] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-39.json
[2022-01-24 18:41:52,694] {logging_mixin.py:109} INFO - plugins/invoices/d2022-1-1/invoice_2022-1-1-40.json
[2022-01-24 18:41:52,697] {logging_mixin.py:109} INFO - 71
[2022-01-24 18:41:52,722] {logging_mixin.py:109} INFO -      invoice_id    invoice_timestamp  customer_id  ...  qty is_discount       price
0    20220101-2  2022-01-01T21:28:17  swibheb5634  ...  267           1    733.0752
1   20220101-51  2022-01-01T21:53:00  svzgllt5401  ...   29           0   1765.8100
2   20220101-19  2022-01-01T21:50:10  nottbgn4122  ...  282           1   1629.1704
3   20220101-30  2022-01-01T11:07:24  uhbbqdu3616  ...  292           0  15768.0000
4   20220101-46  2022-01-01T22:26:16  nottbgn4122  ...  232           1  12745.1520
..          ...                  ...          ...  ...  ...         ...         ...
66  20220101-41  2022-01-01T03:56:36  hveyiwh2729  ...  208           0  17636.3200
67   20220101-8  2022-01-01T20:25:59  qvzhnwd1344  ...  272           1   4973.5200
68  20220101-20  2022-01-01T13:05:22  raanvkb5566  ...   23           1     61.2352
69  20220101-44  2022-01-01T10:04:56  qfyxyiq3514  ...   96           0   6592.3200
70  20220101-45  2022-01-01T16:44:29  zxzvhxj2519  ...  191           0    794.5600

[71 rows x 8 columns]
[2022-01-24 18:41:52,734] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: sales_dw, Login: awsuser, Password: ***, extra: {}
[2022-01-24 18:41:52,746] {base.py:79} INFO - Using connection to: id: redshift. Host: tweet-data.ciyer0z3ifyd.us-east-2.redshift.amazonaws.com, Port: 5439, Schema: sales_dw, Login: awsuser, Password: ***, extra: {}
[2022-01-24 18:42:10,733] {python.py:175} INFO - Done. Returned value was: None
[2022-01-24 18:42:10,742] {taskinstance.py:1277} INFO - Marking task as SUCCESS. dag_id=datawarehouse_etl, task_id=load_invoices, execution_date=20220101T000000, start_date=20220124T184152, end_date=20220124T184210
[2022-01-24 18:42:10,774] {local_task_job.py:154} INFO - Task exited with return code 0
[2022-01-24 18:42:10,815] {local_task_job.py:264} INFO - 1 downstream tasks scheduled from follow-on schedule check
